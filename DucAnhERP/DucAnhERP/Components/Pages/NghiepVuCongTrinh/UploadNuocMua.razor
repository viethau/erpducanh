@page "/NghiepVuCongtrinh/UploadNuocMua"
@using DucAnhERP.SeedWork;
@using Microsoft.AspNetCore.Components.Forms
@using DucAnhERP.Models
@using DucAnhERP.Repository;
@using DucAnhERP.Components.Pages.Common
@using DucAnhERP.Helpers
@inject IDanhMucRepository DanhMucRepository ;
@inject INuocMuaRepository NuocMuaRepository ;
@inject IExcelRepository ExcelRepository;
@inject IDanhMucRepository DanhMucRepository;
@inject IPhanLoaiHoGaRepository PhanLoaiHoGaRepository
@inject IPhanLoaiTDHoGaRepository PhanLoaiTDHoGaRepository
@inject IPhanLoaiCTronHopNhuaRepository PhanLoaiCTronHopNhuaRepository
@inject IPhanLoaiMongCTronRepository PhanLoaiMongCTronRepository
@inject IPhanLoaiDeCongRepository PhanLoaiDeCongRepository
@inject IPhanLoaiThanhChongRepository PhanLoaiThanhChongRepository
@inject IPhanLoaiTDanTDanRepository PhanLoaiTDanTDanRepository
@inject DucAnhERP.Services.ToastService ToastService

<div class="container-fluid p-3">

    <div class="d-inline">
        <InputFile class="my-2" OnChange="HandleFileSelected" title="Upload file excel"> Upload </InputFile>
        <a href="/files/file_mau_nuocmua.xlsx" download="file_mau_nuocmua.xlsx" class="btn btn-link  my-3">Tải về file mẫu</a>
    </div>

    @if (excelDataList != null && excelDataList.Count > 0)
    {
        <NavLink href="/NghiepVuCongtrinh/listNuocMua" class="nav-link">
            <p class="pl-4">Xem danh sách nước mua </p>
        </NavLink>
    }
    <Loading IsLoading="@isLoading" LoadingText="Đang tải dữ liệu..." />
</div>
@code {
    private List<ExcelData> excelDataList;
    private List<NuocMua> listNuocMua ;
    private List<NuocMua> listNuocMuaRight ;
    public List<DanhMuc> listDanhMuc = new();
    private bool isLoading = false;

    protected override async Task OnInitializedAsync()
    {
        listDanhMuc = await DanhMucRepository.GetAll();
    }

    private async Task HandleFileSelected(InputFileChangeEventArgs e)
    {
        isLoading = true;
        var file = e.File;
        if (file != null)
        {
            try
            {
                if (file.Size > 10485760)
                {
                    // Hiển thị thông báo lỗi
                    ToastService.ShowToast("Thông báo", "File quá lớn vui lòng kiếm tra lại file", cssClass: "toast-danger");
                }
                else
                {
                    using (var stream = new MemoryStream())
                    {
                        await file.OpenReadStream(maxAllowedSize: 20 * 1024 * 1024).CopyToAsync(stream);
                        stream.Position = 0;
                        excelDataList = await ExcelRepository.ReadExcelDataAsync(stream);
                        if (excelDataList.Count > 0 && excelDataList[0].RowData.Count >= 979)
                        {
                            listNuocMua = await convertDataLeft(excelDataList);
                            listNuocMuaRight = await convertDataRight(excelDataList);
                            List<NuocMua> listConvertNuocMua = new();
                            DSNuocMuaConversionHelper helper = new();
                            listConvertNuocMua = await helper.ConvertDSNuocMua(listNuocMua,listDanhMuc);
                            listNuocMua = await loadPhanLoai(listConvertNuocMua);
                            var count = await NuocMuaRepository.MultiInsert(listNuocMua);
                            //right
                            List<NuocMua> listConvertNuocMuaRight = new();
                            listConvertNuocMuaRight = await helper.ConvertDSNuocMua(listNuocMuaRight, listDanhMuc);
                            listNuocMuaRight = await loadPhanLoai(listConvertNuocMuaRight);
                            var countRight = await NuocMuaRepository.MultiInsert(listNuocMuaRight);

                            ToastService.ShowToast("Thông báo", "Đã thêm thành công :" + count + " dòng phía trái , "+countRight +" : dòng phía phải ", cssClass: "toast-success");
                        }
                        else
                        {
                            excelDataList = new();
                            ToastService.ShowToast("Thông báo", "Số cột dòng phải đủ như file mẫu. Vui lòng kiểm tra lại", cssClass: "toast-danger");
                        }

                    }
                }

                isLoading = false;
            }
            catch (Exception ex)
            {
                // Ghi lại chi tiết lỗi hoặc xử lý lỗi tại đây
                Console.WriteLine($"Error: {ex.Message}");
                isLoading = false;
            }
        }
    }

    //load phan loai
    public async Task<List<NuocMua>> loadPhanLoai(List<NuocMua> listData)
    {
        try
        {
            List<NuocMua> listNM = new();
            for (int i = 0; i < listData.Count; i++)
            {
                NuocMua nuocMua = listData[i];

                //load phân loại

                var loadTenHoGaSauPhanLoai = await LoadTenHoGaSauPhanLoai(nuocMua);
                if (string.IsNullOrEmpty(loadTenHoGaSauPhanLoai.Id))
                {
                    var id = await ThemTenTheoPL(nuocMua);
                    nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = id;
                }
                else
                {
                    nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = loadTenHoGaSauPhanLoai.Id;
                }
                //load phân loại LoadTenHoGaSauPhanLoaiTDHoGa

                var loadTenHoGaSauPhanLoaiTDHoGa = await LoadTenHoGaSauPhanLoaiTDHoGa(nuocMua);
                if (string.IsNullOrEmpty(loadTenHoGaSauPhanLoaiTDHoGa.Id))
                {
                    var id = await ThemTenTheoPLTDHoGa(nuocMua, listDanhMuc);
                    nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = id;
                }
                else
                {
                    nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = loadTenHoGaSauPhanLoaiTDHoGa.Id;
                }
                //load phân loại  LoadTenPLCTronHopNhua

                var loadTenPLCTronHopNhua = await LoadTenPLCTronHopNhua(nuocMua);
                if (string.IsNullOrEmpty(loadTenPLCTronHopNhua.Id))
                {
                    var id = await ThemTenTheoPLCTronHopNhua(nuocMua, listDanhMuc);
                    nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = id;
                }
                else
                {
                    nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = loadTenPLCTronHopNhua.Id;
                }
                //load phân loại LoadTenPhanLoaiMongCTron

                var loadTenPhanLoaiMongCTron = await LoadTenPhanLoaiMongCTron(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiMongCTron.Id))
                {
                    var id = await ThemTenTheoPLMongCTron(nuocMua, listDanhMuc);
                    nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = id;
                }
                else
                {
                    nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = loadTenPhanLoaiMongCTron.Id;
                }
                //load phân loại loadTenPhanLoaiDeCong

                var loadTenPhanLoaiDeCong = await LoadTenPhanLoaiDeCong(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiDeCong.Id))
                {
                    var id = await ThemTenTheoPLDeCong(nuocMua, listDanhMuc);
                    nuocMua.ThongTinDeCong_TenLoaiDeCong = id;
                }
                else
                {
                    nuocMua.ThongTinDeCong_TenLoaiDeCong = loadTenPhanLoaiDeCong.Id;
                }
                //load phân loại  LoadTenPhanLoaiThanhChong

                var loadTenPhanLoaiThanhChong = await LoadTenPhanLoaiThanhChong(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiThanhChong.Id))
                {
                    var id = await ThemTenTheoPLThanhChong(nuocMua, listDanhMuc);
                    nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = id;
                }
                else
                {
                    nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = loadTenPhanLoaiThanhChong.Id;
                }
                //load phân loại LoadTenPhanLoaiTDanTDan

                var loadTenPhanLoaiTDanTDan = await LoadTenPhanLoaiTDanTDan(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiTDanTDan.Id))
                {
                    var id = await ThemTenTheoPLTDanTDan(nuocMua, listDanhMuc);
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = id;
                }
                else
                {
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = loadTenPhanLoaiTDanTDan.Id;
                }

                //load phân loại TTTDCongHoRanh_TenLoaiTamDanLoai02 loadTenPhanLoaiTDanTDan02

                var loadTenPhanLoaiTDanTDan02 = await LoadTenPhanLoaiTDanTDan02(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiTDanTDan02.Id))
                {
                    var id = await ThemTenTheoPLTDanTDan02(nuocMua, listDanhMuc);
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = id;
                }
                else
                {
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = loadTenPhanLoaiTDanTDan02.Id;
                }


                listNM.Add(nuocMua);
            }


            return listNM;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            throw;
        }
    }

    public async Task<List<NuocMua>> convertDataLeft(List<ExcelData> listData)
    {
        try
        {
            List<NuocMua> listNM = new();
            for (int i = 0; i < listData.Count; i++)
            {

                NuocMua nuocMua = new();

                nuocMua.Id = Guid.NewGuid().ToString();
                nuocMua.ThongTinLyTrinh_TuyenDuong = listData[i].RowData[1].ToString() ?? "";
                nuocMua.ThongTinLyTrinh_LyTrinhTaiTimHoGa = listData[i].RowData[2].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = listData[i].RowData[3].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_TenHoGaTheoBanVe = listData[i].RowData[4].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_HinhThucHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[5].ToString() ?? "", "HG_HTHGa");
                nuocMua.ThongTinChungHoGa_KetCauMuMo = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[6].ToString() ?? "", "HG_LMMHoGa");
                nuocMua.ThongTinChungHoGa_KetCauTuong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[7].ToString() ?? "", "HG_LTHoGa");
                nuocMua.ThongTinChungHoGa_HinhThucMongHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[8].ToString() ?? "", "HG_HTMHoGa");
                nuocMua.ThongTinChungHoGa_KetCauMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[9].ToString() ?? "", "HG_LMHoGa");
                nuocMua.ThongTinChungHoGa_ChatMatTrong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[10].ToString() ?? "");
                nuocMua.ThongTinChungHoGa_ChatMatNgoai = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[11].ToString() ?? "");
                nuocMua.PhuBiHoGa_CDai = ParseDoubleOrDefault(listData[i].RowData[12], 0);
                nuocMua.PhuBiHoGa_CRong = ParseDoubleOrDefault(listData[i].RowData[13], 0);
                nuocMua.BeTongLotMong_D = ParseDoubleOrDefault(listData[i].RowData[14], 0);
                nuocMua.BeTongLotMong_R = ParseDoubleOrDefault(listData[i].RowData[15], 0);
                nuocMua.BeTongLotMong_C = ParseDoubleOrDefault(listData[i].RowData[16], 0);
                nuocMua.BeTongMongHoGa_D = ParseDoubleOrDefault(listData[i].RowData[17], 0);
                nuocMua.BeTongMongHoGa_R = ParseDoubleOrDefault(listData[i].RowData[18], 0);
                nuocMua.BeTongMongHoGa_C = ParseDoubleOrDefault(listData[i].RowData[19], 0);
                nuocMua.DeHoGa_D = ParseDoubleOrDefault(listData[i].RowData[20], 0);
                nuocMua.DeHoGa_R = ParseDoubleOrDefault(listData[i].RowData[21], 0);
                nuocMua.DeHoGa_C = ParseDoubleOrDefault(listData[i].RowData[22], 0);
                nuocMua.TuongHoGa_D = ParseDoubleOrDefault(listData[i].RowData[23], 0);
                nuocMua.TuongHoGa_R = ParseDoubleOrDefault(listData[i].RowData[24], 0);

                nuocMua.TuongHoGa_CdTuong = ParseDoubleOrDefault(listData[i].RowData[26], 0);
                nuocMua.DamGiuaHoGa_D = ParseDoubleOrDefault(listData[i].RowData[27], 0);
                nuocMua.DamGiuaHoGa_R = ParseDoubleOrDefault(listData[i].RowData[28], 0);
                nuocMua.DamGiuaHoGa_C = ParseDoubleOrDefault(listData[i].RowData[29], 0);
                nuocMua.DamGiuaHoGa_CdDam = ParseDoubleOrDefault(listData[i].RowData[30], 0);
                nuocMua.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = ParseDoubleOrDefault(listData[i].RowData[31], 0);
                nuocMua.ChatMatTrong_D = ParseDoubleOrDefault(listData[i].RowData[32], 0);
                nuocMua.ChatMatTrong_R = ParseDoubleOrDefault(listData[i].RowData[33], 0);

                nuocMua.ChatMatNgoaiCanh_D = ParseDoubleOrDefault(listData[i].RowData[35], 0);
                nuocMua.ChatMatNgoaiCanh_R = ParseDoubleOrDefault(listData[i].RowData[36], 0);

                nuocMua.MuMoThotDuoi_D = ParseDoubleOrDefault(listData[i].RowData[38], 0);
                nuocMua.MuMoThotDuoi_R = ParseDoubleOrDefault(listData[i].RowData[39], 0);
                nuocMua.MuMoThotDuoi_C = ParseDoubleOrDefault(listData[i].RowData[40], 0);
                nuocMua.MuMoThotDuoi_CdTuong = ParseDoubleOrDefault(listData[i].RowData[41], 0);
                nuocMua.MuMoThotTren_D = ParseDoubleOrDefault(listData[i].RowData[42], 0);
                nuocMua.MuMoThotTren_R = ParseDoubleOrDefault(listData[i].RowData[43], 0);
                nuocMua.MuMoThotTren_C = ParseDoubleOrDefault(listData[i].RowData[44], 0);
                nuocMua.MuMoThotTren_CdTuong = ParseDoubleOrDefault(listData[i].RowData[45], 0);

                nuocMua.HinhThucDauNoi1_Loai = ParseDoubleOrDefault(listData[i].RowData[46], 0);
                nuocMua.HinhThucDauNoi1_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[47].ToString() ?? "");
                nuocMua.HinhThucDauNoi1_CanhDai = ParseDoubleOrDefault(listData[i].RowData[48], 0);
                nuocMua.HinhThucDauNoi1_CDD = ParseDoubleOrDefault(listData[i].RowData[49], 0);
                nuocMua.HinhThucDauNoi1_CDR = ParseDoubleOrDefault(listData[i].RowData[50], 0);
                nuocMua.HinhThucDauNoi1_CDC = ParseDoubleOrDefault(listData[i].RowData[51], 0);
                nuocMua.HinhThucDauNoi1_CanhRong = ParseDoubleOrDefault(listData[i].RowData[52], 0);
                nuocMua.HinhThucDauNoi1_CRD = ParseDoubleOrDefault(listData[i].RowData[53], 0);
                nuocMua.HinhThucDauNoi1_CRR = ParseDoubleOrDefault(listData[i].RowData[54], 0);
                nuocMua.HinhThucDauNoi1_CRC = ParseDoubleOrDefault(listData[i].RowData[55], 0);
                nuocMua.HinhThucDauNoi1_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[56], 0);
                nuocMua.HinhThucDauNoi1_CCD = ParseDoubleOrDefault(listData[i].RowData[57], 0);
                nuocMua.HinhThucDauNoi1_CCR = ParseDoubleOrDefault(listData[i].RowData[58], 0);
                nuocMua.HinhThucDauNoi1_CCC = ParseDoubleOrDefault(listData[i].RowData[59], 0);
                nuocMua.HinhThucDauNoi2_Loai = ParseDoubleOrDefault(listData[i].RowData[60], 0);
                nuocMua.HinhThucDauNoi2_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[61].ToString() ?? "");
                nuocMua.HinhThucDauNoi2_CanhDai = ParseDoubleOrDefault(listData[i].RowData[62], 0);
                nuocMua.HinhThucDauNoi2_CDD = ParseDoubleOrDefault(listData[i].RowData[63], 0);
                nuocMua.HinhThucDauNoi2_CDR = ParseDoubleOrDefault(listData[i].RowData[64], 0);
                nuocMua.HinhThucDauNoi2_CDC = ParseDoubleOrDefault(listData[i].RowData[65], 0);
                nuocMua.HinhThucDauNoi2_CanhRong = ParseDoubleOrDefault(listData[i].RowData[66], 0);
                nuocMua.HinhThucDauNoi2_CRD = ParseDoubleOrDefault(listData[i].RowData[67], 0);
                nuocMua.HinhThucDauNoi2_CRR = ParseDoubleOrDefault(listData[i].RowData[68], 0);
                nuocMua.HinhThucDauNoi2_CRC = ParseDoubleOrDefault(listData[i].RowData[69], 0);
                nuocMua.HinhThucDauNoi2_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[70], 0);
                nuocMua.HinhThucDauNoi2_CCD = ParseDoubleOrDefault(listData[i].RowData[71], 0);
                nuocMua.HinhThucDauNoi2_CCR = ParseDoubleOrDefault(listData[i].RowData[72], 0);
                nuocMua.HinhThucDauNoi2_CCC = ParseDoubleOrDefault(listData[i].RowData[73], 0);
                nuocMua.HinhThucDauNoi3_Loai = ParseDoubleOrDefault(listData[i].RowData[74], 0);
                nuocMua.HinhThucDauNoi3_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[75].ToString() ?? "");
                nuocMua.HinhThucDauNoi3_CanhDai = ParseDoubleOrDefault(listData[i].RowData[76], 0);
                nuocMua.HinhThucDauNoi3_CDD = ParseDoubleOrDefault(listData[i].RowData[77], 0);
                nuocMua.HinhThucDauNoi3_CDR = ParseDoubleOrDefault(listData[i].RowData[78], 0);
                nuocMua.HinhThucDauNoi3_CDC = ParseDoubleOrDefault(listData[i].RowData[79], 0);
                nuocMua.HinhThucDauNoi3_CanhRong = ParseDoubleOrDefault(listData[i].RowData[80], 0);
                nuocMua.HinhThucDauNoi3_CRD = ParseDoubleOrDefault(listData[i].RowData[81], 0);
                nuocMua.HinhThucDauNoi3_CRR = ParseDoubleOrDefault(listData[i].RowData[82], 0);
                nuocMua.HinhThucDauNoi3_CRC = ParseDoubleOrDefault(listData[i].RowData[83], 0);
                nuocMua.HinhThucDauNoi3_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[84], 0);
                nuocMua.HinhThucDauNoi3_CCD = ParseDoubleOrDefault(listData[i].RowData[85], 0);
                nuocMua.HinhThucDauNoi3_CCR = ParseDoubleOrDefault(listData[i].RowData[86], 0);
                nuocMua.HinhThucDauNoi3_CCC = ParseDoubleOrDefault(listData[i].RowData[87], 0);
                nuocMua.HinhThucDauNoi4_Loai = ParseDoubleOrDefault(listData[i].RowData[88], 0);
                nuocMua.HinhThucDauNoi4_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[89].ToString() ?? "");
                nuocMua.HinhThucDauNoi4_CanhDai = ParseDoubleOrDefault(listData[i].RowData[90], 0);
                nuocMua.HinhThucDauNoi4_CDD = ParseDoubleOrDefault(listData[i].RowData[91], 0);
                nuocMua.HinhThucDauNoi4_CDR = ParseDoubleOrDefault(listData[i].RowData[92], 0);
                nuocMua.HinhThucDauNoi4_CDC = ParseDoubleOrDefault(listData[i].RowData[93], 0);
                nuocMua.HinhThucDauNoi4_CanhRong = ParseDoubleOrDefault(listData[i].RowData[94], 0);
                nuocMua.HinhThucDauNoi4_CRD = ParseDoubleOrDefault(listData[i].RowData[95], 0);
                nuocMua.HinhThucDauNoi4_CRR = ParseDoubleOrDefault(listData[i].RowData[96], 0);
                nuocMua.HinhThucDauNoi4_CRC = ParseDoubleOrDefault(listData[i].RowData[97], 0);
                nuocMua.HinhThucDauNoi4_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[98], 0);
                nuocMua.HinhThucDauNoi4_CCD = ParseDoubleOrDefault(listData[i].RowData[99], 0);
                nuocMua.HinhThucDauNoi4_CCR = ParseDoubleOrDefault(listData[i].RowData[100], 0);
                nuocMua.HinhThucDauNoi4_CCC = ParseDoubleOrDefault(listData[i].RowData[101], 0);
                nuocMua.HinhThucDauNoi5_Loai = ParseDoubleOrDefault(listData[i].RowData[102], 0);
                nuocMua.HinhThucDauNoi5_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[103].ToString() ?? "");
                nuocMua.HinhThucDauNoi5_CanhDai = ParseDoubleOrDefault(listData[i].RowData[104], 0);
                nuocMua.HinhThucDauNoi5_CDD = ParseDoubleOrDefault(listData[i].RowData[105], 0);
                nuocMua.HinhThucDauNoi5_CDR = ParseDoubleOrDefault(listData[i].RowData[106], 0);
                nuocMua.HinhThucDauNoi5_CDC = ParseDoubleOrDefault(listData[i].RowData[107], 0);
                nuocMua.HinhThucDauNoi5_CanhRong = ParseDoubleOrDefault(listData[i].RowData[108], 0);
                nuocMua.HinhThucDauNoi5_CRD = ParseDoubleOrDefault(listData[i].RowData[109], 0);
                nuocMua.HinhThucDauNoi5_CRR = ParseDoubleOrDefault(listData[i].RowData[110], 0);
                nuocMua.HinhThucDauNoi5_CRC = ParseDoubleOrDefault(listData[i].RowData[111], 0);
                nuocMua.HinhThucDauNoi5_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[112], 0);
                nuocMua.HinhThucDauNoi5_CCD = ParseDoubleOrDefault(listData[i].RowData[113], 0);
                nuocMua.HinhThucDauNoi5_CCR = ParseDoubleOrDefault(listData[i].RowData[114], 0);
                nuocMua.HinhThucDauNoi5_CCC = ParseDoubleOrDefault(listData[i].RowData[115], 0);
                nuocMua.HinhThucDauNoi6_Loai = ParseDoubleOrDefault(listData[i].RowData[116], 0);
                nuocMua.HinhThucDauNoi6_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[117].ToString() ?? "");
                nuocMua.HinhThucDauNoi6_CanhDai = ParseDoubleOrDefault(listData[i].RowData[118], 0);
                nuocMua.HinhThucDauNoi6_CDD = ParseDoubleOrDefault(listData[i].RowData[119], 0);
                nuocMua.HinhThucDauNoi6_CDR = ParseDoubleOrDefault(listData[i].RowData[120], 0);
                nuocMua.HinhThucDauNoi6_CDC = ParseDoubleOrDefault(listData[i].RowData[121], 0);
                nuocMua.HinhThucDauNoi6_CanhRong = ParseDoubleOrDefault(listData[i].RowData[122], 0);
                nuocMua.HinhThucDauNoi6_CRD = ParseDoubleOrDefault(listData[i].RowData[123], 0);
                nuocMua.HinhThucDauNoi6_CRR = ParseDoubleOrDefault(listData[i].RowData[124], 0);
                nuocMua.HinhThucDauNoi6_CRC = ParseDoubleOrDefault(listData[i].RowData[125], 0);
                nuocMua.HinhThucDauNoi6_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[126], 0);
                nuocMua.HinhThucDauNoi6_CCD = ParseDoubleOrDefault(listData[i].RowData[127], 0);
                nuocMua.HinhThucDauNoi6_CCR = ParseDoubleOrDefault(listData[i].RowData[128], 0);
                nuocMua.HinhThucDauNoi6_CCC = ParseDoubleOrDefault(listData[i].RowData[129], 0);
                nuocMua.HinhThucDauNoi7_Loai = ParseDoubleOrDefault(listData[i].RowData[130], 0);
                nuocMua.HinhThucDauNoi7_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[131].ToString() ?? "");
                nuocMua.HinhThucDauNoi7_CanhDai = ParseDoubleOrDefault(listData[i].RowData[132], 0);
                nuocMua.HinhThucDauNoi7_CDD = ParseDoubleOrDefault(listData[i].RowData[133], 0);
                nuocMua.HinhThucDauNoi7_CDR = ParseDoubleOrDefault(listData[i].RowData[134], 0);
                nuocMua.HinhThucDauNoi7_CDC = ParseDoubleOrDefault(listData[i].RowData[135], 0);
                nuocMua.HinhThucDauNoi7_CanhRong = ParseDoubleOrDefault(listData[i].RowData[136], 0);
                nuocMua.HinhThucDauNoi7_CRD = ParseDoubleOrDefault(listData[i].RowData[137], 0);
                nuocMua.HinhThucDauNoi7_CRR = ParseDoubleOrDefault(listData[i].RowData[138], 0);
                nuocMua.HinhThucDauNoi7_CRC = ParseDoubleOrDefault(listData[i].RowData[139], 0);
                nuocMua.HinhThucDauNoi7_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[140], 0);
                nuocMua.HinhThucDauNoi7_CCD = ParseDoubleOrDefault(listData[i].RowData[141], 0);
                nuocMua.HinhThucDauNoi7_CCR = ParseDoubleOrDefault(listData[i].RowData[142], 0);
                nuocMua.HinhThucDauNoi7_CCC = ParseDoubleOrDefault(listData[i].RowData[143], 0);
                nuocMua.HinhThucDauNoi8_Loai = ParseDoubleOrDefault(listData[i].RowData[144], 0);
                nuocMua.HinhThucDauNoi8_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[145].ToString() ?? "");
                nuocMua.HinhThucDauNoi8_CanhDai = ParseDoubleOrDefault(listData[i].RowData[146], 0);
                nuocMua.HinhThucDauNoi8_CDD = ParseDoubleOrDefault(listData[i].RowData[147], 0);
                nuocMua.HinhThucDauNoi8_CDR = ParseDoubleOrDefault(listData[i].RowData[148], 0);
                nuocMua.HinhThucDauNoi8_CDC = ParseDoubleOrDefault(listData[i].RowData[149], 0);
                nuocMua.HinhThucDauNoi8_CanhRong = ParseDoubleOrDefault(listData[i].RowData[150], 0);
                nuocMua.HinhThucDauNoi8_CRD = ParseDoubleOrDefault(listData[i].RowData[151], 0);
                nuocMua.HinhThucDauNoi8_CRR = ParseDoubleOrDefault(listData[i].RowData[152], 0);
                nuocMua.HinhThucDauNoi8_CRC = ParseDoubleOrDefault(listData[i].RowData[153], 0);
                nuocMua.HinhThucDauNoi8_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[154], 0);
                nuocMua.HinhThucDauNoi8_CCD = ParseDoubleOrDefault(listData[i].RowData[155], 0);
                nuocMua.HinhThucDauNoi8_CCR = ParseDoubleOrDefault(listData[i].RowData[156], 0);
                nuocMua.HinhThucDauNoi8_CCC = ParseDoubleOrDefault(listData[i].RowData[157], 0);


                nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = listData[i].RowData[158].ToString() ?? "";
                nuocMua.ThongTinTamDanHoGa2_HinhThucDayHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[159].ToString() ?? "", "HG_HTDHoGa");  
                nuocMua.ThongTinTamDanHoGa2_DuongKinh = ParseDoubleOrDefault(listData[i].RowData[160], 0);
                nuocMua.ThongTinTamDanHoGa2_ChieuDay = ParseDoubleOrDefault(listData[i].RowData[160], 0);
                nuocMua.ThongTinTamDanHoGa2_D = ParseDoubleOrDefault(listData[i].RowData[162], 0);
                nuocMua.ThongTinTamDanHoGa2_R = ParseDoubleOrDefault(listData[i].RowData[163], 0);
                nuocMua.ThongTinTamDanHoGa2_C = ParseDoubleOrDefault(listData[i].RowData[164], 0);
                nuocMua.ThongTinTamDanHoGa2_SoLuongNapDay = ParseDoubleOrDefault(listData[i].RowData[165], 0);
                nuocMua.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[166].ToString() ?? "", "HG_LVLDHoGa");
                nuocMua.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[167], 0);

                nuocMua.ThongTinCaoDoHoGa_CaoDoTuNhien = ParseDoubleOrDefault(listData[i].RowData[170], 0);
                nuocMua.ThongTinCaoDoHoGa_CdDinhViaHeHoanThien = ParseDoubleOrDefault(listData[i].RowData[171], 0);
                nuocMua.ThongTinCaoDoHoGa_CaoDoDinhK98 = ParseDoubleOrDefault(listData[i].RowData[172], 0);

                nuocMua.ThongTinCaoDoHoGa_CdDayHoGa = ParseDoubleOrDefault(listData[i].RowData[178], 0);

                nuocMua.ThongTinCaoDoHoGa_CdDinhHoGa = ParseDoubleOrDefault(listData[i].RowData[184], 0);

                nuocMua.ThongTinMaiDao_ChieuRongDayDaoNho = ParseDoubleOrDefault(listData[i].RowData[198], 0);
                nuocMua.ThongTinMaiDao_TyLeMoMai = ParseDoubleOrDefault(listData[i].RowData[199], 0);
                nuocMua.ThongTinMaiDao_SoCanhMaiTrai = ParseDoubleOrDefault(listData[i].RowData[200], 0);
                nuocMua.ThongTinMaiDao_SoCanhMaiPhai = ParseDoubleOrDefault(listData[i].RowData[201], 0);

                nuocMua.ThongTinLyTrinhTruyenDan_TuLyTrinh = ParseDoubleOrDefault(listData[i].RowData[219], 0);
                nuocMua.ThongTinLyTrinhTruyenDan_DenLyTrinh = ParseDoubleOrDefault(listData[i].RowData[220], 0);
                nuocMua.ThongTinLyTrinhTruyenDan_TuHoGa = listData[i].RowData[221].ToString() ?? "";
                nuocMua.ThongTinLyTrinhTruyenDan_DenHoGa = listData[i].RowData[222].ToString() ?? "";
                nuocMua.ThongTinDuongTruyenDan_HinhThucTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[223].ToString() ?? "", "TD_HTTruyenDan");
                nuocMua.ThongTinDuongTruyenDan_LoaiTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[224].ToString() ?? "", "TD_LTruyenDan");
                nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = listData[i].RowData[225].ToString() ?? "";
                nuocMua.TTCDSLCauKienDuongTruyenDan_TongChieuDai = ParseDoubleOrDefault(listData[i].RowData[226], 0);
                nuocMua.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = ParseDoubleOrDefault(listData[i].RowData[227], 0);

                nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = listData[i].RowData[229].ToString() ?? "";
                nuocMua.ThongTinMongDuongTruyenDan_LoaiMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[230].ToString() ?? "", "TD_LMTruyenDan");
                nuocMua.ThongTinMongDuongTruyenDan_HinhThucMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[231].ToString() ?? "", "TD_HTMTruyenDan");
                nuocMua.ThongTinDeCong_TenLoaiDeCong = listData[i].RowData[232].ToString() ?? "";
                nuocMua.ThongTinDeCong_CauTaoDeCong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[233].ToString() ?? "", "TD_CTDCTron");
                nuocMua.ThongTinDeCong_D = ParseDoubleOrDefault(listData[i].RowData[234], 0);
                nuocMua.ThongTinDeCong_R = ParseDoubleOrDefault(listData[i].RowData[235], 0);
                nuocMua.ThongTinDeCong_C = ParseDoubleOrDefault(listData[i].RowData[236], 0);
                nuocMua.ThongTinDeCong_SlDeCong01CauKienTruyenDan = ParseDoubleOrDefault(listData[i].RowData[237], 0);
                nuocMua.ThongTinDeCong_Kl01DeCong = ParseDoubleOrDefault(listData[i].RowData[238], 0);

                nuocMua.ThongTinCauTaoCongTron_CDayPhuBi = ParseDoubleOrDefault(listData[i].RowData[241], 0);
                nuocMua.ThongTinCauTaoCongTron_SoCanh = ParseDoubleOrDefault(listData[i].RowData[242], 0);
                nuocMua.ThongTinCauTaoCongTron_LongSuDung = ParseDoubleOrDefault(listData[i].RowData[243], 0);

                nuocMua.ThongTinCauTaoCongTron_CCaoLotMong = ParseDoubleOrDefault(listData[i].RowData[245], 0);
                nuocMua.ThongTinCauTaoCongTron_CRongLotMong = ParseDoubleOrDefault(listData[i].RowData[246], 0);
                nuocMua.ThongTinCauTaoCongTron_CCaoMong = ParseDoubleOrDefault(listData[i].RowData[247], 0);
                nuocMua.ThongTinCauTaoCongTron_CRongMong = ParseDoubleOrDefault(listData[i].RowData[248], 0);
                nuocMua.ThongTinCauTaoCongTron_CCaoDe = ParseDoubleOrDefault(listData[i].RowData[249], 0);

                nuocMua.TTTKLCKCTCH_CDMoiNoiCKien = ParseDoubleOrDefault(listData[i].RowData[251], 0);
                nuocMua.TTTKLCKCTCH_SLCKDungDeTinhCD = ParseDoubleOrDefault(listData[i].RowData[252], 0);
                nuocMua.TTTKLCKCTCH_SLCKNguyen = ParseDoubleOrDefault(listData[i].RowData[253], 0);

                nuocMua.TTKTHHCongHopRanh_CauTaoTuong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[259].ToString() ?? "", "TD_LDanhTuong");
                nuocMua.TTKTHHCongHopRanh_CauTaoMuMo = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[260].ToString() ?? "", "TD_LMMCongRanh");
                nuocMua.TTKTHHCongHopRanh_ChatMatTrong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[261].ToString() ?? "");
                nuocMua.TTKTHHCongHopRanh_ChatMatNgoai = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[262].ToString() ?? "");
                nuocMua.TTKTHHCongHopRanh_CCaoLotMong = ParseDoubleOrDefault(listData[i].RowData[263], 0);
                nuocMua.TTKTHHCongHopRanh_CRongLotMong = ParseDoubleOrDefault(listData[i].RowData[264], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoMong = ParseDoubleOrDefault(listData[i].RowData[265], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMong = ParseDoubleOrDefault(listData[i].RowData[266], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoDe = ParseDoubleOrDefault(listData[i].RowData[267], 0);
                nuocMua.TTKTHHCongHopRanh_CRongDe = ParseDoubleOrDefault(listData[i].RowData[268], 0);
                nuocMua.TTKTHHCongHopRanh_CDayTuong01Ben = ParseDoubleOrDefault(listData[i].RowData[269], 0);
                nuocMua.TTKTHHCongHopRanh_SoLuongTuong = ParseDoubleOrDefault(listData[i].RowData[270], 0);
                nuocMua.TTKTHHCongHopRanh_CRongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[271], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoTuongCongHop = ParseDoubleOrDefault(listData[i].RowData[272], 0);

                nuocMua.TTKTHHCongHopRanh_CCaoMuMoThotDuoi = ParseDoubleOrDefault(listData[i].RowData[275], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMuMoDuoi = ParseDoubleOrDefault(listData[i].RowData[276], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoMuMoThotTren = ParseDoubleOrDefault(listData[i].RowData[277], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMuMoTren = ParseDoubleOrDefault(listData[i].RowData[278], 0);
                nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = listData[i].RowData[279].ToString() ?? "";
                nuocMua.TTKTHHCongHopRanh_CauTaoThanhChong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[280].ToString() ?? "", "TD_CTTChongRanh");;
                nuocMua.TTKTHHCongHopRanh_CCaoThanhChong = ParseDoubleOrDefault(listData[i].RowData[281], 0);
                nuocMua.TTKTHHCongHopRanh_CRongThanhChong = ParseDoubleOrDefault(listData[i].RowData[282], 0);
                nuocMua.TTKTHHCongHopRanh_CDai = ParseDoubleOrDefault(listData[i].RowData[283], 0);
                nuocMua.TTKTHHCongHopRanh_SoLuongThanhChong = ParseDoubleOrDefault(listData[i].RowData[284], 0);

                nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = listData[i].RowData[288].ToString() ?? "";
                nuocMua.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[289].ToString() ?? "", "TD_CTTDTruyenDan");


                nuocMua.TTTDCongHoRanh_CDai = ParseDoubleOrDefault(listData[i].RowData[291], 0);
                nuocMua.TTTDCongHoRanh_CRong = ParseDoubleOrDefault(listData[i].RowData[292], 0);
                nuocMua.TTTDCongHoRanh_CCao = ParseDoubleOrDefault(listData[i].RowData[293], 0);
                nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = listData[i].RowData[294].ToString() ?? "";
                nuocMua.TTTDCongHoRanh_CauTaoTamDanTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[295].ToString() ?? "", "TD_CTTDTruyenDan");

                nuocMua.TTTDCongHoRanh_CRong1 = ParseDoubleOrDefault(listData[i].RowData[298], 0);
                nuocMua.TTTDCongHoRanh_CCao1 = ParseDoubleOrDefault(listData[i].RowData[299], 0);
                nuocMua.TTTDCongHoRanh_ChieuDaiMoiNoi = ParseDoubleOrDefault(listData[i].RowData[300], 0);
                nuocMua.TTTDCongHoRanh_SoLuongTDanDungDeTinhChieuDaiBoSung = ParseDoubleOrDefault(listData[i].RowData[301], 0);

                nuocMua.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = ParseDoubleOrDefault(listData[i].RowData[307], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_SoCanh = ParseDoubleOrDefault(listData[i].RowData[308], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_LongSuDung = ParseDoubleOrDefault(listData[i].RowData[309], 0);

                nuocMua.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat = ParseDoubleOrDefault(listData[i].RowData[311], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat = ParseDoubleOrDefault(listData[i].RowData[312], 0);
                nuocMua.CDThuongLuu_HienTrangTruocKhiDaoThuongLuu = ParseDoubleOrDefault(listData[i].RowData[313], 0);

                nuocMua.CDThuongLuu_DayDongChay = ParseDoubleOrDefault(listData[i].RowData[330], 0);

                nuocMua.CDThuongLuu_DinhTrongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[335], 0);

                nuocMua.CDHaLu_HienTrangTruocKhiDaoHaLuu = ParseDoubleOrDefault(listData[i].RowData[341], 0);

                nuocMua.CDHaLu_DayDaoOngNhua = ParseDoubleOrDefault(listData[i].RowData[347], 0);

                nuocMua.CDHaLu_DayDongChay = ParseDoubleOrDefault(listData[i].RowData[358], 0);

                nuocMua.CDHaLu_DinhTrongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[363], 0);

                nuocMua.TTVLDCongRanh_LoaiVatLieuDao = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[369].ToString() ?? ""); ;
                nuocMua.TTVLDCongRanh_TLChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[370], 0);

                nuocMua.TTVLDCongRanh_HLChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[373], 0);
                nuocMua.TTVLDCongRanh_HLChieuCaoDaoDat = ParseDoubleOrDefault(listData[i].RowData[374], 0);

                nuocMua.TTMDRanhOngThang_ChieuRongDayDaoNho = ParseDoubleOrDefault(listData[i].RowData[436], 0);
                nuocMua.TTMDRanhOngThang_TyLeMoMai = ParseDoubleOrDefault(listData[i].RowData[437], 0);
                nuocMua.TTMDRanhOngThang_SoCanhMaiTrai = ParseDoubleOrDefault(listData[i].RowData[438], 0);
                nuocMua.TTMDRanhOngThang_SoCanhMaiPhai = ParseDoubleOrDefault(listData[i].RowData[439], 0);

                nuocMua.ToaDoX = ParseDoubleOrDefault(listData[i].RowData[488], 0);
                nuocMua.ToaDoY = ParseDoubleOrDefault(listData[i].RowData[489], 0);
                nuocMua.TraiPhai = 0;

                listNM.Add(nuocMua);
            }


            return listNM;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            throw new Exception("Lỗi khi tải tệp lên ! Vui lòng kiểm tra lại file và thử lại !");
        }
    }

    public async Task<List<NuocMua>> convertDataRight(List<ExcelData> listData)
    {
        try
        {
            int rowstart = 491;
            List<NuocMua> listNM = new();
            for (int i = 0; i < listData.Count; i++)
            {

                NuocMua nuocMua = new();

                nuocMua.Id = Guid.NewGuid().ToString();

                nuocMua.ThongTinLyTrinh_TuyenDuong = listData[i].RowData[rowstart + 1].ToString() ?? "";
                nuocMua.ThongTinLyTrinh_LyTrinhTaiTimHoGa = listData[i].RowData[rowstart + 2].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = listData[i].RowData[rowstart + 3].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_TenHoGaTheoBanVe = listData[i].RowData[rowstart + 4].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_HinhThucHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 5].ToString() ?? "", "HG_HTHGa");
                nuocMua.ThongTinChungHoGa_KetCauMuMo = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 6].ToString() ?? "", "HG_LMMHoGa");
                nuocMua.ThongTinChungHoGa_KetCauTuong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 7].ToString() ?? "", "HG_LTHoGa");
                nuocMua.ThongTinChungHoGa_HinhThucMongHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 8].ToString() ?? "", "HG_HTMHoGa");
                nuocMua.ThongTinChungHoGa_KetCauMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 9].ToString() ?? "", "HG_LMHoGa");
                nuocMua.ThongTinChungHoGa_ChatMatTrong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 10].ToString() ?? "");
                nuocMua.ThongTinChungHoGa_ChatMatNgoai = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 11].ToString() ?? "");
                nuocMua.PhuBiHoGa_CDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 12], 0);
                nuocMua.PhuBiHoGa_CRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 13], 0);
                nuocMua.BeTongLotMong_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 14], 0);
                nuocMua.BeTongLotMong_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 15], 0);
                nuocMua.BeTongLotMong_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 16], 0);
                nuocMua.BeTongMongHoGa_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 17], 0);
                nuocMua.BeTongMongHoGa_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 18], 0);
                nuocMua.BeTongMongHoGa_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 19], 0);
                nuocMua.DeHoGa_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 20], 0);
                nuocMua.DeHoGa_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 21], 0);
                nuocMua.DeHoGa_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 22], 0);
                nuocMua.TuongHoGa_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 23], 0);
                nuocMua.TuongHoGa_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 24], 0);

                nuocMua.TuongHoGa_CdTuong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 26], 0);
                nuocMua.DamGiuaHoGa_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 27], 0);
                nuocMua.DamGiuaHoGa_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 28], 0);
                nuocMua.DamGiuaHoGa_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 29], 0);
                nuocMua.DamGiuaHoGa_CdDam = ParseDoubleOrDefault(listData[i].RowData[rowstart + 30], 0);
                nuocMua.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = ParseDoubleOrDefault(listData[i].RowData[rowstart + 31], 0);
                nuocMua.ChatMatTrong_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 32], 0);
                nuocMua.ChatMatTrong_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 33], 0);

                nuocMua.ChatMatNgoaiCanh_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 35], 0);
                nuocMua.ChatMatNgoaiCanh_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 36], 0);

                nuocMua.MuMoThotDuoi_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 38], 0);
                nuocMua.MuMoThotDuoi_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 39], 0);
                nuocMua.MuMoThotDuoi_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 40], 0);
                nuocMua.MuMoThotDuoi_CdTuong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 41], 0);
                nuocMua.MuMoThotTren_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 42], 0);
                nuocMua.MuMoThotTren_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 43], 0);
                nuocMua.MuMoThotTren_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 44], 0);
                nuocMua.MuMoThotTren_CdTuong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 45], 0);

                nuocMua.HinhThucDauNoi1_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 46], 0);
                nuocMua.HinhThucDauNoi1_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 47].ToString() ?? "");
                nuocMua.HinhThucDauNoi1_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 48], 0);
                nuocMua.HinhThucDauNoi1_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 49], 0);
                nuocMua.HinhThucDauNoi1_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 50], 0);
                nuocMua.HinhThucDauNoi1_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 51], 0);
                nuocMua.HinhThucDauNoi1_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 52], 0);
                nuocMua.HinhThucDauNoi1_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 53], 0);
                nuocMua.HinhThucDauNoi1_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 54], 0);
                nuocMua.HinhThucDauNoi1_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 55], 0);
                nuocMua.HinhThucDauNoi1_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 56], 0);
                nuocMua.HinhThucDauNoi1_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 57], 0);
                nuocMua.HinhThucDauNoi1_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 58], 0);
                nuocMua.HinhThucDauNoi1_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 59], 0);
                nuocMua.HinhThucDauNoi2_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 60], 0);
                nuocMua.HinhThucDauNoi2_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 61].ToString() ?? "");
                nuocMua.HinhThucDauNoi2_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 62], 0);
                nuocMua.HinhThucDauNoi2_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 63], 0);
                nuocMua.HinhThucDauNoi2_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 64], 0);
                nuocMua.HinhThucDauNoi2_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 65], 0);
                nuocMua.HinhThucDauNoi2_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 66], 0);
                nuocMua.HinhThucDauNoi2_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 67], 0);
                nuocMua.HinhThucDauNoi2_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 68], 0);
                nuocMua.HinhThucDauNoi2_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 69], 0);
                nuocMua.HinhThucDauNoi2_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 70], 0);
                nuocMua.HinhThucDauNoi2_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 71], 0);
                nuocMua.HinhThucDauNoi2_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 72], 0);
                nuocMua.HinhThucDauNoi2_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 73], 0);
                nuocMua.HinhThucDauNoi3_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 74], 0);
                nuocMua.HinhThucDauNoi3_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 75].ToString() ?? "");
                nuocMua.HinhThucDauNoi3_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 76], 0);
                nuocMua.HinhThucDauNoi3_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 77], 0);
                nuocMua.HinhThucDauNoi3_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 78], 0);
                nuocMua.HinhThucDauNoi3_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 79], 0);
                nuocMua.HinhThucDauNoi3_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 80], 0);
                nuocMua.HinhThucDauNoi3_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 81], 0);
                nuocMua.HinhThucDauNoi3_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 82], 0);
                nuocMua.HinhThucDauNoi3_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 83], 0);
                nuocMua.HinhThucDauNoi3_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 84], 0);
                nuocMua.HinhThucDauNoi3_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 85], 0);
                nuocMua.HinhThucDauNoi3_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 86], 0);
                nuocMua.HinhThucDauNoi3_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 87], 0);
                nuocMua.HinhThucDauNoi4_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 88], 0);
                nuocMua.HinhThucDauNoi4_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 89].ToString() ?? "");
                nuocMua.HinhThucDauNoi4_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 90], 0);
                nuocMua.HinhThucDauNoi4_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 91], 0);
                nuocMua.HinhThucDauNoi4_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 92], 0);
                nuocMua.HinhThucDauNoi4_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 93], 0);
                nuocMua.HinhThucDauNoi4_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 94], 0);
                nuocMua.HinhThucDauNoi4_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 95], 0);
                nuocMua.HinhThucDauNoi4_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 96], 0);
                nuocMua.HinhThucDauNoi4_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 97], 0);
                nuocMua.HinhThucDauNoi4_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 98], 0);
                nuocMua.HinhThucDauNoi4_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 99], 0);
                nuocMua.HinhThucDauNoi4_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 100], 0);
                nuocMua.HinhThucDauNoi4_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 101], 0);
                nuocMua.HinhThucDauNoi5_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 102], 0);
                nuocMua.HinhThucDauNoi5_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 103].ToString() ?? "");
                nuocMua.HinhThucDauNoi5_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 104], 0);
                nuocMua.HinhThucDauNoi5_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 105], 0);
                nuocMua.HinhThucDauNoi5_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 106], 0);
                nuocMua.HinhThucDauNoi5_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 107], 0);
                nuocMua.HinhThucDauNoi5_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 108], 0);
                nuocMua.HinhThucDauNoi5_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 109], 0);
                nuocMua.HinhThucDauNoi5_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 110], 0);
                nuocMua.HinhThucDauNoi5_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 111], 0);
                nuocMua.HinhThucDauNoi5_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 112], 0);
                nuocMua.HinhThucDauNoi5_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 113], 0);
                nuocMua.HinhThucDauNoi5_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 114], 0);
                nuocMua.HinhThucDauNoi5_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 115], 0);
                nuocMua.HinhThucDauNoi6_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 116], 0);
                nuocMua.HinhThucDauNoi6_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 117].ToString() ?? "");
                nuocMua.HinhThucDauNoi6_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 118], 0);
                nuocMua.HinhThucDauNoi6_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 119], 0);
                nuocMua.HinhThucDauNoi6_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 120], 0);
                nuocMua.HinhThucDauNoi6_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 121], 0);
                nuocMua.HinhThucDauNoi6_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 122], 0);
                nuocMua.HinhThucDauNoi6_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 123], 0);
                nuocMua.HinhThucDauNoi6_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 124], 0);
                nuocMua.HinhThucDauNoi6_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 125], 0);
                nuocMua.HinhThucDauNoi6_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 126], 0);
                nuocMua.HinhThucDauNoi6_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 127], 0);
                nuocMua.HinhThucDauNoi6_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 128], 0);
                nuocMua.HinhThucDauNoi6_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 129], 0);
                nuocMua.HinhThucDauNoi7_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 130], 0);
                nuocMua.HinhThucDauNoi7_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 131].ToString() ?? "");
                nuocMua.HinhThucDauNoi7_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 132], 0);
                nuocMua.HinhThucDauNoi7_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 133], 0);
                nuocMua.HinhThucDauNoi7_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 134], 0);
                nuocMua.HinhThucDauNoi7_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 135], 0);
                nuocMua.HinhThucDauNoi7_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 136], 0);
                nuocMua.HinhThucDauNoi7_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 137], 0);
                nuocMua.HinhThucDauNoi7_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 138], 0);
                nuocMua.HinhThucDauNoi7_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 139], 0);
                nuocMua.HinhThucDauNoi7_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 140], 0);
                nuocMua.HinhThucDauNoi7_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 141], 0);
                nuocMua.HinhThucDauNoi7_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 142], 0);
                nuocMua.HinhThucDauNoi7_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 143], 0);
                nuocMua.HinhThucDauNoi8_Loai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 144], 0);
                nuocMua.HinhThucDauNoi8_KLBoSung = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 145].ToString() ?? "");
                nuocMua.HinhThucDauNoi8_CanhDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 146], 0);
                nuocMua.HinhThucDauNoi8_CDD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 147], 0);
                nuocMua.HinhThucDauNoi8_CDR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 148], 0);
                nuocMua.HinhThucDauNoi8_CDC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 149], 0);
                nuocMua.HinhThucDauNoi8_CanhRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 150], 0);
                nuocMua.HinhThucDauNoi8_CRD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 151], 0);
                nuocMua.HinhThucDauNoi8_CRR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 152], 0);
                nuocMua.HinhThucDauNoi8_CRC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 153], 0);
                nuocMua.HinhThucDauNoi8_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[rowstart + 154], 0);
                nuocMua.HinhThucDauNoi8_CCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 155], 0);
                nuocMua.HinhThucDauNoi8_CCR = ParseDoubleOrDefault(listData[i].RowData[rowstart + 156], 0);
                nuocMua.HinhThucDauNoi8_CCC = ParseDoubleOrDefault(listData[i].RowData[rowstart + 157], 0);

                nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = listData[i].RowData[rowstart + 158].ToString() ?? "";
                nuocMua.ThongTinTamDanHoGa2_HinhThucDayHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 159].ToString() ?? "", "HG_HTDHoGa");
                nuocMua.ThongTinTamDanHoGa2_DuongKinh = ParseDoubleOrDefault(listData[i].RowData[rowstart + 160], 0);
                nuocMua.ThongTinTamDanHoGa2_ChieuDay = ParseDoubleOrDefault(listData[i].RowData[rowstart + 160], 0);
                nuocMua.ThongTinTamDanHoGa2_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 162], 0);
                nuocMua.ThongTinTamDanHoGa2_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 163], 0);
                nuocMua.ThongTinTamDanHoGa2_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 164], 0);
                nuocMua.ThongTinTamDanHoGa2_SoLuongNapDay = ParseDoubleOrDefault(listData[i].RowData[rowstart + 165], 0);
                nuocMua.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 166].ToString() ?? "", "HG_LVLDHoGa");
                nuocMua.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[rowstart + 167], 0);

                nuocMua.ThongTinCaoDoHoGa_CaoDoTuNhien = ParseDoubleOrDefault(listData[i].RowData[rowstart + 170], 0);
                nuocMua.ThongTinCaoDoHoGa_CdDinhViaHeHoanThien = ParseDoubleOrDefault(listData[i].RowData[rowstart + 171], 0);
                nuocMua.ThongTinCaoDoHoGa_CaoDoDinhK98 = ParseDoubleOrDefault(listData[i].RowData[rowstart + 172], 0);

                nuocMua.ThongTinCaoDoHoGa_CdDayHoGa = ParseDoubleOrDefault(listData[i].RowData[rowstart + 178], 0);

                nuocMua.ThongTinCaoDoHoGa_CdDinhHoGa = ParseDoubleOrDefault(listData[i].RowData[rowstart + 184], 0);

                nuocMua.ThongTinMaiDao_ChieuRongDayDaoNho = ParseDoubleOrDefault(listData[i].RowData[rowstart + 198], 0);
                nuocMua.ThongTinMaiDao_TyLeMoMai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 199], 0);
                nuocMua.ThongTinMaiDao_SoCanhMaiTrai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 200], 0);
                nuocMua.ThongTinMaiDao_SoCanhMaiPhai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 201], 0);

                nuocMua.ThongTinLyTrinhTruyenDan_TuLyTrinh = ParseDoubleOrDefault(listData[i].RowData[rowstart + 219], 0);
                nuocMua.ThongTinLyTrinhTruyenDan_DenLyTrinh = ParseDoubleOrDefault(listData[i].RowData[rowstart + 220], 0);
                nuocMua.ThongTinLyTrinhTruyenDan_TuHoGa = listData[i].RowData[rowstart + 221].ToString() ?? "";
                nuocMua.ThongTinLyTrinhTruyenDan_DenHoGa = listData[i].RowData[rowstart + 222].ToString() ?? "";
                nuocMua.ThongTinDuongTruyenDan_HinhThucTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 223].ToString() ?? "", "TD_HTTruyenDan");
                nuocMua.ThongTinDuongTruyenDan_LoaiTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 224].ToString() ?? "", "TD_LTruyenDan");
                nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = listData[i].RowData[rowstart + 225].ToString() ?? "";
                nuocMua.TTCDSLCauKienDuongTruyenDan_TongChieuDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 226], 0);
                nuocMua.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = ParseDoubleOrDefault(listData[i].RowData[rowstart + 227], 0);

                nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = listData[i].RowData[rowstart + 229].ToString() ?? "";
                nuocMua.ThongTinMongDuongTruyenDan_LoaiMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 230].ToString() ?? "", "TD_LMTruyenDan");
                nuocMua.ThongTinMongDuongTruyenDan_HinhThucMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 231].ToString() ?? "", "TD_HTMTruyenDan");
                nuocMua.ThongTinDeCong_TenLoaiDeCong = listData[i].RowData[rowstart + 232].ToString() ?? "";
                nuocMua.ThongTinDeCong_CauTaoDeCong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 233].ToString() ?? "", "TD_CTDCTron");
                nuocMua.ThongTinDeCong_D = ParseDoubleOrDefault(listData[i].RowData[rowstart + 234], 0);
                nuocMua.ThongTinDeCong_R = ParseDoubleOrDefault(listData[i].RowData[rowstart + 235], 0);
                nuocMua.ThongTinDeCong_C = ParseDoubleOrDefault(listData[i].RowData[rowstart + 236], 0);
                nuocMua.ThongTinDeCong_SlDeCong01CauKienTruyenDan = ParseDoubleOrDefault(listData[i].RowData[rowstart + 237], 0);
                nuocMua.ThongTinDeCong_Kl01DeCong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 238], 0);

                nuocMua.ThongTinCauTaoCongTron_CDayPhuBi = ParseDoubleOrDefault(listData[i].RowData[rowstart + 241], 0);
                nuocMua.ThongTinCauTaoCongTron_SoCanh = ParseDoubleOrDefault(listData[i].RowData[rowstart + 242], 0);
                nuocMua.ThongTinCauTaoCongTron_LongSuDung = ParseDoubleOrDefault(listData[i].RowData[rowstart + 243], 0);

                nuocMua.ThongTinCauTaoCongTron_CCaoLotMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 245], 0);
                nuocMua.ThongTinCauTaoCongTron_CRongLotMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 246], 0);
                nuocMua.ThongTinCauTaoCongTron_CCaoMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 247], 0);
                nuocMua.ThongTinCauTaoCongTron_CRongMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 248], 0);
                nuocMua.ThongTinCauTaoCongTron_CCaoDe = ParseDoubleOrDefault(listData[i].RowData[rowstart + 249], 0);

                nuocMua.TTTKLCKCTCH_CDMoiNoiCKien = ParseDoubleOrDefault(listData[i].RowData[rowstart + 251], 0);
                nuocMua.TTTKLCKCTCH_SLCKDungDeTinhCD = ParseDoubleOrDefault(listData[i].RowData[rowstart + 252], 0);
                nuocMua.TTTKLCKCTCH_SLCKNguyen = ParseDoubleOrDefault(listData[i].RowData[rowstart + 253], 0);

                nuocMua.TTKTHHCongHopRanh_CauTaoTuong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 259].ToString() ?? "", "TD_LDanhTuong");
                nuocMua.TTKTHHCongHopRanh_CauTaoMuMo = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 260].ToString() ?? "", "TD_LMMCongRanh");
                nuocMua.TTKTHHCongHopRanh_ChatMatTrong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 261].ToString() ?? "");
                nuocMua.TTKTHHCongHopRanh_ChatMatNgoai = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 262].ToString() ?? "");
                nuocMua.TTKTHHCongHopRanh_CCaoLotMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 263], 0);
                nuocMua.TTKTHHCongHopRanh_CRongLotMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 264], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 265], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 266], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoDe = ParseDoubleOrDefault(listData[i].RowData[rowstart + 267], 0);
                nuocMua.TTKTHHCongHopRanh_CRongDe = ParseDoubleOrDefault(listData[i].RowData[rowstart + 268], 0);
                nuocMua.TTKTHHCongHopRanh_CDayTuong01Ben = ParseDoubleOrDefault(listData[i].RowData[rowstart + 269], 0);
                nuocMua.TTKTHHCongHopRanh_SoLuongTuong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 270], 0);
                nuocMua.TTKTHHCongHopRanh_CRongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[rowstart + 271], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoTuongCongHop = ParseDoubleOrDefault(listData[i].RowData[rowstart + 272], 0);

                nuocMua.TTKTHHCongHopRanh_CCaoMuMoThotDuoi = ParseDoubleOrDefault(listData[i].RowData[rowstart + 275], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMuMoDuoi = ParseDoubleOrDefault(listData[i].RowData[rowstart + 276], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoMuMoThotTren = ParseDoubleOrDefault(listData[i].RowData[rowstart + 277], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMuMoTren = ParseDoubleOrDefault(listData[i].RowData[rowstart + 278], 0);
                nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = listData[i].RowData[rowstart + 279].ToString() ?? "";
                nuocMua.TTKTHHCongHopRanh_CauTaoThanhChong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 280].ToString() ?? "", "TD_CTTChongRanh"); ;
                nuocMua.TTKTHHCongHopRanh_CCaoThanhChong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 281], 0);
                nuocMua.TTKTHHCongHopRanh_CRongThanhChong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 282], 0);
                nuocMua.TTKTHHCongHopRanh_CDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 283], 0);
                nuocMua.TTKTHHCongHopRanh_SoLuongThanhChong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 284], 0);

                nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = listData[i].RowData[rowstart + 288].ToString() ?? "";
                nuocMua.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 289].ToString() ?? "", "TD_CTTDTruyenDan");


                nuocMua.TTTDCongHoRanh_CDai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 291], 0);
                nuocMua.TTTDCongHoRanh_CRong = ParseDoubleOrDefault(listData[i].RowData[rowstart + 292], 0);
                nuocMua.TTTDCongHoRanh_CCao = ParseDoubleOrDefault(listData[i].RowData[rowstart + 293], 0);
                nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = listData[i].RowData[rowstart + 294].ToString() ?? "";
                nuocMua.TTTDCongHoRanh_CauTaoTamDanTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 295].ToString() ?? "", "TD_CTTDTruyenDan");

                nuocMua.TTTDCongHoRanh_CRong1 = ParseDoubleOrDefault(listData[i].RowData[rowstart + 298], 0);
                nuocMua.TTTDCongHoRanh_CCao1 = ParseDoubleOrDefault(listData[i].RowData[rowstart + 299], 0);
                nuocMua.TTTDCongHoRanh_ChieuDaiMoiNoi = ParseDoubleOrDefault(listData[i].RowData[rowstart + 300], 0);
                nuocMua.TTTDCongHoRanh_SoLuongTDanDungDeTinhChieuDaiBoSung = ParseDoubleOrDefault(listData[i].RowData[rowstart + 301], 0);

                nuocMua.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = ParseDoubleOrDefault(listData[i].RowData[rowstart + 307], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_SoCanh = ParseDoubleOrDefault(listData[i].RowData[rowstart + 308], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_LongSuDung = ParseDoubleOrDefault(listData[i].RowData[rowstart + 309], 0);

                nuocMua.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat = ParseDoubleOrDefault(listData[i].RowData[rowstart + 311], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat = ParseDoubleOrDefault(listData[i].RowData[rowstart + 312], 0);
                nuocMua.CDThuongLuu_HienTrangTruocKhiDaoThuongLuu = ParseDoubleOrDefault(listData[i].RowData[rowstart + 313], 0);

                nuocMua.CDThuongLuu_DayDongChay = ParseDoubleOrDefault(listData[i].RowData[rowstart + 330], 0);

                nuocMua.CDThuongLuu_DinhTrongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[rowstart + 335], 0);

                nuocMua.CDHaLu_HienTrangTruocKhiDaoHaLuu = ParseDoubleOrDefault(listData[i].RowData[rowstart + 341], 0);

                nuocMua.CDHaLu_DayDaoOngNhua = ParseDoubleOrDefault(listData[i].RowData[rowstart + 347], 0);

                nuocMua.CDHaLu_DayDongChay = ParseDoubleOrDefault(listData[i].RowData[rowstart + 358], 0);

                nuocMua.CDHaLu_DinhTrongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[rowstart + 363], 0);

                nuocMua.TTVLDCongRanh_LoaiVatLieuDao = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[rowstart + 369].ToString() ?? ""); ;
                nuocMua.TTVLDCongRanh_TLChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[rowstart + 370], 0);

                nuocMua.TTVLDCongRanh_HLChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[rowstart + 373], 0);
                nuocMua.TTVLDCongRanh_HLChieuCaoDaoDat = ParseDoubleOrDefault(listData[i].RowData[rowstart + 374], 0);

                nuocMua.TTMDRanhOngThang_ChieuRongDayDaoNho = ParseDoubleOrDefault(listData[i].RowData[rowstart + 436], 0);
                nuocMua.TTMDRanhOngThang_TyLeMoMai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 437], 0);
                nuocMua.TTMDRanhOngThang_SoCanhMaiTrai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 438], 0);
                nuocMua.TTMDRanhOngThang_SoCanhMaiPhai = ParseDoubleOrDefault(listData[i].RowData[rowstart + 439], 0);

                nuocMua.ToaDoX = ParseDoubleOrDefault(listData[i].RowData[rowstart + 488], 0);
                nuocMua.ToaDoY = ParseDoubleOrDefault(listData[i].RowData[rowstart + 489], 0);
                nuocMua.TraiPhai = 1;

                listNM.Add(nuocMua);
            }


            return listNM;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            throw new Exception("Lỗi khi tải tệp lên ! Vui lòng kiểm tra lại file và thử lại !");
        }
    }

    public static double ParseDoubleOrDefault(object input, double defaultValue = 0)
    {
        string value = input?.ToString() ?? "";
        if (string.IsNullOrWhiteSpace(value))
        {
            return defaultValue;
        }
        if (double.TryParse(value, out double result))
        {
            return result;
        }
        return defaultValue;
    }

    public static int ParseIntOrDefault(object input, int defaultValue = 0)
    {
        string value = input?.ToString() ?? "";
        if (string.IsNullOrWhiteSpace(value))
        {
            return defaultValue;
        }

        if (int.TryParse(value.Trim(), out int result))
        {
            return result;
        }

        return defaultValue;
    }

    public string GetTenDanhMucById(string id)
    {
        var danhMuc = listDanhMuc.FirstOrDefault(dm => dm.Id == id);
        return danhMuc != null ? danhMuc.Ten : null;
    }

    PhanLoai phanloai=new();

    //Thêm tên theo bảng phân loại hố ga
    public async Task<string> ThemTenTheoPL(NuocMua Input)
    {
        var id = "";
        PhanLoaiHoGa searchData = new PhanLoaiHoGa
            {
                ThongTinChungHoGa_TenHoGaSauPhanLoai = Input.ThongTinChungHoGa_TenHoGaSauPhanLoai,
                ThongTinChungHoGa_HinhThucHoGa = Input.ThongTinChungHoGa_HinhThucHoGa,
                ThongTinChungHoGa_KetCauMuMo = Input.ThongTinChungHoGa_KetCauMuMo,
                ThongTinChungHoGa_KetCauTuong = Input.ThongTinChungHoGa_KetCauTuong,
                ThongTinChungHoGa_HinhThucMongHoGa = Input.ThongTinChungHoGa_HinhThucMongHoGa,
                ThongTinChungHoGa_KetCauMong = Input.ThongTinChungHoGa_KetCauMong,
                ThongTinChungHoGa_ChatMatTrong = Input.ThongTinChungHoGa_ChatMatTrong,
                ThongTinChungHoGa_ChatMatNgoai = Input.ThongTinChungHoGa_ChatMatNgoai,
                PhuBiHoGa_CDai = Input.PhuBiHoGa_CDai,
                PhuBiHoGa_CRong = Input.PhuBiHoGa_CRong,
                BeTongLotMong_D = Input.BeTongLotMong_D,
                BeTongLotMong_R = Input.BeTongLotMong_R,
                BeTongLotMong_C = Input.BeTongLotMong_C,
                BeTongMongHoGa_D = Input.BeTongMongHoGa_D,
                BeTongMongHoGa_R = Input.BeTongMongHoGa_R,
                BeTongMongHoGa_C = Input.BeTongMongHoGa_C,
                DeHoGa_D = Input.DeHoGa_D,
                DeHoGa_R = Input.DeHoGa_R,
                DeHoGa_C = Input.DeHoGa_C,
                TuongHoGa_D = Input.TuongHoGa_D,
                TuongHoGa_R = Input.TuongHoGa_R,
                TuongHoGa_C = Input.TuongHoGa_C,
                TuongHoGa_CdTuong = Input.TuongHoGa_CdTuong,
                DamGiuaHoGa_D = Input.DamGiuaHoGa_D,
                DamGiuaHoGa_R = Input.DamGiuaHoGa_R,
                DamGiuaHoGa_C = Input.DamGiuaHoGa_C,
                DamGiuaHoGa_CdDam = Input.DamGiuaHoGa_CdDam,
                DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = Input.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa,
                ChatMatTrong_D = Input.ChatMatTrong_D,
                ChatMatTrong_R = Input.ChatMatTrong_R,
                ChatMatTrong_C = Input.ChatMatTrong_C,
                ChatMatNgoaiCanh_D = Input.ChatMatNgoaiCanh_D,
                ChatMatNgoaiCanh_R = Input.ChatMatNgoaiCanh_R,
                ChatMatNgoaiCanh_C = Input.ChatMatNgoaiCanh_C,
                MuMoThotDuoi_D = Input.MuMoThotDuoi_D,
                MuMoThotDuoi_R = Input.MuMoThotDuoi_R,
                MuMoThotDuoi_C = Input.MuMoThotDuoi_C,
                MuMoThotDuoi_CdTuong = Input.MuMoThotDuoi_CdTuong,
                MuMoThotTren_D = Input.MuMoThotTren_D,
                MuMoThotTren_R = Input.MuMoThotTren_R,
                MuMoThotTren_C = Input.MuMoThotTren_C,
                MuMoThotTren_CdTuong = Input.MuMoThotTren_CdTuong,
                HinhThucDauNoi1_Loai = Input.HinhThucDauNoi1_Loai,
                HinhThucDauNoi1_CanhDai = Input.HinhThucDauNoi1_CanhDai,
                HinhThucDauNoi1_CanhRong = Input.HinhThucDauNoi1_CanhRong,
                HinhThucDauNoi1_CanhCheo = Input.HinhThucDauNoi1_CanhCheo,
                HinhThucDauNoi2_Loai = Input.HinhThucDauNoi2_Loai,
                HinhThucDauNoi2_CanhDai = Input.HinhThucDauNoi2_CanhDai,
                HinhThucDauNoi2_CanhRong = Input.HinhThucDauNoi2_CanhRong,
                HinhThucDauNoi2_CanhCheo = Input.HinhThucDauNoi2_CanhCheo,
                HinhThucDauNoi3_Loai = Input.HinhThucDauNoi3_Loai,
                HinhThucDauNoi3_CanhDai = Input.HinhThucDauNoi3_CanhDai,
                HinhThucDauNoi3_CanhRong = Input.HinhThucDauNoi3_CanhRong,
                HinhThucDauNoi3_CanhCheo = Input.HinhThucDauNoi3_CanhCheo,
                HinhThucDauNoi4_Loai = Input.HinhThucDauNoi4_Loai,
                HinhThucDauNoi4_CanhDai = Input.HinhThucDauNoi4_CanhDai,
                HinhThucDauNoi4_CanhRong = Input.HinhThucDauNoi4_CanhRong,
                HinhThucDauNoi4_CanhCheo = Input.HinhThucDauNoi4_CanhCheo,
                HinhThucDauNoi5_Loai = Input.HinhThucDauNoi5_Loai,
                HinhThucDauNoi5_CanhDai = Input.HinhThucDauNoi5_CanhDai,
                HinhThucDauNoi5_CanhRong = Input.HinhThucDauNoi5_CanhRong,
                HinhThucDauNoi5_CanhCheo = Input.HinhThucDauNoi5_CanhCheo,
                HinhThucDauNoi6_Loai = Input.HinhThucDauNoi6_Loai,
                HinhThucDauNoi6_CanhDai = Input.HinhThucDauNoi6_CanhDai,
                HinhThucDauNoi6_CanhRong = Input.HinhThucDauNoi6_CanhRong,
                HinhThucDauNoi6_CanhCheo = Input.HinhThucDauNoi6_CanhCheo,
                HinhThucDauNoi7_Loai = Input.HinhThucDauNoi7_Loai,
                HinhThucDauNoi7_CanhDai = Input.HinhThucDauNoi7_CanhDai,
                HinhThucDauNoi7_CanhRong = Input.HinhThucDauNoi7_CanhRong,
                HinhThucDauNoi7_CanhCheo = Input.HinhThucDauNoi7_CanhCheo,
                HinhThucDauNoi8_Loai = Input.HinhThucDauNoi8_Loai,
                HinhThucDauNoi8_CanhDai = Input.HinhThucDauNoi8_CanhDai,
                HinhThucDauNoi8_CanhRong = Input.HinhThucDauNoi8_CanhRong,
                HinhThucDauNoi8_CanhCheo = Input.HinhThucDauNoi8_CanhCheo
            };
        if (Input.ThongTinChungHoGa_TenHoGaTheoBanVe.ToUpper().EndsWith("=G"))
        {
            searchData.G = "=G";
        }
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            string HoGa_KetCauTuong = GetTenDanhMucById(searchData.ThongTinChungHoGa_KetCauTuong);
            id = await PhanLoaiHoGaRepository.InsertId(searchData, HoGa_KetCauTuong);
            Input.ThongTinChungHoGa_TenHoGaSauPhanLoai = id;
        }
        return id;
    }

    //Load tên theo phân loại hố ga
    public async Task<PhanLoai> LoadTenHoGaSauPhanLoai(NuocMua Input)
    {
        PhanLoaiHoGa searchData = new PhanLoaiHoGa
            {
                // ThongTinChungHoGa_TenHoGaSauPhanLoai = Input.ThongTinChungHoGa_TenHoGaSauPhanLoai,

                ThongTinChungHoGa_HinhThucHoGa = Input.ThongTinChungHoGa_HinhThucHoGa,
                ThongTinChungHoGa_KetCauMuMo = Input.ThongTinChungHoGa_KetCauMuMo,
                ThongTinChungHoGa_KetCauTuong = Input.ThongTinChungHoGa_KetCauTuong,
                ThongTinChungHoGa_HinhThucMongHoGa = Input.ThongTinChungHoGa_HinhThucMongHoGa,
                ThongTinChungHoGa_KetCauMong = Input.ThongTinChungHoGa_KetCauMong,
                ThongTinChungHoGa_ChatMatTrong = Input.ThongTinChungHoGa_ChatMatTrong,
                ThongTinChungHoGa_ChatMatNgoai = Input.ThongTinChungHoGa_ChatMatNgoai,
                PhuBiHoGa_CDai = Input.PhuBiHoGa_CDai,
                PhuBiHoGa_CRong = Input.PhuBiHoGa_CRong,
                BeTongLotMong_D = Input.BeTongLotMong_D,
                BeTongLotMong_R = Input.BeTongLotMong_R,
                BeTongLotMong_C = Input.BeTongLotMong_C,
                BeTongMongHoGa_D = Input.BeTongMongHoGa_D,
                BeTongMongHoGa_R = Input.BeTongMongHoGa_R,
                BeTongMongHoGa_C = Input.BeTongMongHoGa_C,
                DeHoGa_D = Input.DeHoGa_D,
                DeHoGa_R = Input.DeHoGa_R,
                DeHoGa_C = Input.DeHoGa_C,
                TuongHoGa_D = Input.TuongHoGa_D,
                TuongHoGa_R = Input.TuongHoGa_R,
                TuongHoGa_C = Input.TuongHoGa_C,
                TuongHoGa_CdTuong = Input.TuongHoGa_CdTuong,
                DamGiuaHoGa_D = Input.DamGiuaHoGa_D,
                DamGiuaHoGa_R = Input.DamGiuaHoGa_R,
                DamGiuaHoGa_C = Input.DamGiuaHoGa_C,
                DamGiuaHoGa_CdDam = Input.DamGiuaHoGa_CdDam,
                DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = Input.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa,
                ChatMatTrong_D = Input.ChatMatTrong_D,
                ChatMatTrong_R = Input.ChatMatTrong_R,
                ChatMatTrong_C = Input.ChatMatTrong_C,
                ChatMatNgoaiCanh_D = Input.ChatMatNgoaiCanh_D,
                ChatMatNgoaiCanh_R = Input.ChatMatNgoaiCanh_R,
                ChatMatNgoaiCanh_C = Input.ChatMatNgoaiCanh_C,
                MuMoThotDuoi_D = Input.MuMoThotDuoi_D,
                MuMoThotDuoi_R = Input.MuMoThotDuoi_R,
                MuMoThotDuoi_C = Input.MuMoThotDuoi_C,
                MuMoThotDuoi_CdTuong = Input.MuMoThotDuoi_CdTuong,
                MuMoThotTren_D = Input.MuMoThotTren_D,
                MuMoThotTren_R = Input.MuMoThotTren_R,
                MuMoThotTren_C = Input.MuMoThotTren_C,
                MuMoThotTren_CdTuong = Input.MuMoThotTren_CdTuong,
                HinhThucDauNoi1_Loai = Input.HinhThucDauNoi1_Loai,
                HinhThucDauNoi1_CanhDai = Input.HinhThucDauNoi1_CanhDai,
                HinhThucDauNoi1_CanhRong = Input.HinhThucDauNoi1_CanhRong,
                HinhThucDauNoi1_CanhCheo = Input.HinhThucDauNoi1_CanhCheo,
                HinhThucDauNoi2_Loai = Input.HinhThucDauNoi2_Loai,
                HinhThucDauNoi2_CanhDai = Input.HinhThucDauNoi2_CanhDai,
                HinhThucDauNoi2_CanhRong = Input.HinhThucDauNoi2_CanhRong,
                HinhThucDauNoi2_CanhCheo = Input.HinhThucDauNoi2_CanhCheo,
                HinhThucDauNoi3_Loai = Input.HinhThucDauNoi3_Loai,
                HinhThucDauNoi3_CanhDai = Input.HinhThucDauNoi3_CanhDai,
                HinhThucDauNoi3_CanhRong = Input.HinhThucDauNoi3_CanhRong,
                HinhThucDauNoi3_CanhCheo = Input.HinhThucDauNoi3_CanhCheo,
                HinhThucDauNoi4_Loai = Input.HinhThucDauNoi4_Loai,
                HinhThucDauNoi4_CanhDai = Input.HinhThucDauNoi4_CanhDai,
                HinhThucDauNoi4_CanhRong = Input.HinhThucDauNoi4_CanhRong,
                HinhThucDauNoi4_CanhCheo = Input.HinhThucDauNoi4_CanhCheo,
                HinhThucDauNoi5_Loai = Input.HinhThucDauNoi5_Loai,
                HinhThucDauNoi5_CanhDai = Input.HinhThucDauNoi5_CanhDai,
                HinhThucDauNoi5_CanhRong = Input.HinhThucDauNoi5_CanhRong,
                HinhThucDauNoi5_CanhCheo = Input.HinhThucDauNoi5_CanhCheo,
                HinhThucDauNoi6_Loai = Input.HinhThucDauNoi6_Loai,
                HinhThucDauNoi6_CanhDai = Input.HinhThucDauNoi6_CanhDai,
                HinhThucDauNoi6_CanhRong = Input.HinhThucDauNoi6_CanhRong,
                HinhThucDauNoi6_CanhCheo = Input.HinhThucDauNoi6_CanhCheo,
                HinhThucDauNoi7_Loai = Input.HinhThucDauNoi7_Loai,
                HinhThucDauNoi7_CanhDai = Input.HinhThucDauNoi7_CanhDai,
                HinhThucDauNoi7_CanhRong = Input.HinhThucDauNoi7_CanhRong,
                HinhThucDauNoi7_CanhCheo = Input.HinhThucDauNoi7_CanhCheo,
                HinhThucDauNoi8_Loai = Input.HinhThucDauNoi8_Loai,
                HinhThucDauNoi8_CanhDai = Input.HinhThucDauNoi8_CanhDai,
                HinhThucDauNoi8_CanhRong = Input.HinhThucDauNoi8_CanhRong,
                HinhThucDauNoi8_CanhCheo = Input.HinhThucDauNoi8_CanhCheo
            };

        PhanLoaiHoGa plHoGa = new();
        phanloai = new();
        if (Input.ThongTinChungHoGa_TenHoGaTheoBanVe.ToUpper().EndsWith("=G"))
        {
            searchData.G = "=G";
        }
        plHoGa = await PhanLoaiHoGaRepository.GetPhanLoaiHoGaByDetail(searchData);
      
        if (plHoGa != null)
        {
            phanloai.Name = plHoGa.ThongTinChungHoGa_TenHoGaSauPhanLoai;
            phanloai.Id = plHoGa.Id;
        }


        return phanloai;
    }

    //Thêm tên theo bảng phân loại tấm đan hố ga
    public async Task<string> ThemTenTheoPLTDHoGa(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        var id = "";
        PhanLoaiTDHoGa searchData = new PhanLoaiTDHoGa
            {
                ThongTinTamDanHoGa2_HinhThucDayHoGa = Input.ThongTinTamDanHoGa2_HinhThucDayHoGa,
                ThongTinTamDanHoGa2_DuongKinh = Input.ThongTinTamDanHoGa2_DuongKinh,
                ThongTinTamDanHoGa2_ChieuDay = Input.ThongTinTamDanHoGa2_ChieuDay,
                ThongTinTamDanHoGa2_D = Input.ThongTinTamDanHoGa2_D,
                ThongTinTamDanHoGa2_R = Input.ThongTinTamDanHoGa2_R,
                ThongTinTamDanHoGa2_C = Input.ThongTinTamDanHoGa2_C

            };
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiTDHoGaRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinTamDanHoGa2_HinhThucDayHoGa));

        }
        return id;

    }

    //Load tên theo phân loại tấm đan hố ga
    public async Task<PhanLoai> LoadTenHoGaSauPhanLoaiTDHoGa(NuocMua Input)
    {
        PhanLoaiTDHoGa searchData = new PhanLoaiTDHoGa
            {

                ThongTinTamDanHoGa2_HinhThucDayHoGa = Input.ThongTinTamDanHoGa2_HinhThucDayHoGa,
                ThongTinTamDanHoGa2_DuongKinh = Input.ThongTinTamDanHoGa2_DuongKinh,
                ThongTinTamDanHoGa2_ChieuDay = Input.ThongTinTamDanHoGa2_ChieuDay,
                ThongTinTamDanHoGa2_D = Input.ThongTinTamDanHoGa2_D,
                ThongTinTamDanHoGa2_R = Input.ThongTinTamDanHoGa2_R,
                ThongTinTamDanHoGa2_C = Input.ThongTinTamDanHoGa2_C
            };

        PhanLoaiTDHoGa plTDHoGa = new();
        phanloai = new();
        plTDHoGa = await PhanLoaiTDHoGaRepository.GetPhanLoaiTDHoGaByDetail(searchData);
        if (plTDHoGa != null)
        {
            phanloai.Id = plTDHoGa.Id;
            phanloai.Name = plTDHoGa.ThongTinTamDanHoGa2_PhanLoaiDayHoGa;
        }
        return phanloai;

    }

    //Thêm tên theo bảng phân loại cống hộp cống tròn nhựa
    public async Task<string> ThemTenTheoPLCTronHopNhua(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiCTronHopNhua searchData = new PhanLoaiCTronHopNhua
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = Input.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien,
                ThongTinCauTaoCongTron_CDayPhuBi = Input.ThongTinCauTaoCongTron_CDayPhuBi,
                TTKTHHCongHopRanh_CauTaoTuong = Input.TTKTHHCongHopRanh_CauTaoTuong,
                TTKTHHCongHopRanh_ChatMatTrong = Input.TTKTHHCongHopRanh_ChatMatTrong,
                TTKTHHCongHopRanh_ChatMatNgoai = Input.TTKTHHCongHopRanh_ChatMatNgoai,
                TTKTHHCongHopRanh_CCaoDe = Input.TTKTHHCongHopRanh_CCaoDe,
                TTKTHHCongHopRanh_CRongDe = Input.TTKTHHCongHopRanh_CRongDe,
                TTKTHHCongHopRanh_CDayTuong01Ben = Input.TTKTHHCongHopRanh_CDayTuong01Ben,
                TTKTHHCongHopRanh_SoLuongTuong = Input.TTKTHHCongHopRanh_SoLuongTuong,
                TTKTHHCongHopRanh_CRongLongSuDung = Input.TTKTHHCongHopRanh_CRongLongSuDung,
                TTKTHHCongHopRanh_CCaoTuongGop = Input.TTKTHHCongHopRanh_CCaoTuongGop,
                TTKTHHCongHopRanh_CCaoMuMoThotDuoi = Input.TTKTHHCongHopRanh_CCaoMuMoThotDuoi,
                TTKTHHCongHopRanh_CRongMuMoDuoi = Input.TTKTHHCongHopRanh_CRongMuMoDuoi,
                TTKTHHCongHopRanh_CCaoMuMoThotTren = Input.TTKTHHCongHopRanh_CCaoMuMoThotTren,
                TTKTHHCongHopRanh_CRongMuMoTren = Input.TTKTHHCongHopRanh_CRongMuMoTren,
                TTKTHHCongHopRanh_CCaoChatMatTrong = Input.TTKTHHCongHopRanh_CCaoChatMatTrong,
                ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = Input.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi,

            };
        var id = "";
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiCTronHopNhuaRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_HinhThucTruyenDan), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan));

        }
        return id;
    }

    //Load tên theo phân loại móng cống tròn
    public async Task<PhanLoai> LoadTenPLCTronHopNhua(NuocMua Input)
    {
        PhanLoaiCTronHopNhua searchData = new PhanLoaiCTronHopNhua
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = Input.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien,
                ThongTinCauTaoCongTron_CDayPhuBi = Input.ThongTinCauTaoCongTron_CDayPhuBi,
                TTKTHHCongHopRanh_CauTaoTuong = Input.TTKTHHCongHopRanh_CauTaoTuong,
                TTKTHHCongHopRanh_ChatMatTrong = Input.TTKTHHCongHopRanh_ChatMatTrong,
                TTKTHHCongHopRanh_ChatMatNgoai = Input.TTKTHHCongHopRanh_ChatMatNgoai,
                TTKTHHCongHopRanh_CCaoDe = Input.TTKTHHCongHopRanh_CCaoDe,
                TTKTHHCongHopRanh_CRongDe = Input.TTKTHHCongHopRanh_CRongDe,
                TTKTHHCongHopRanh_CDayTuong01Ben = Input.TTKTHHCongHopRanh_CDayTuong01Ben,
                TTKTHHCongHopRanh_SoLuongTuong = Input.TTKTHHCongHopRanh_SoLuongTuong,
                TTKTHHCongHopRanh_CRongLongSuDung = Input.TTKTHHCongHopRanh_CRongLongSuDung,
                TTKTHHCongHopRanh_CCaoTuongGop = Input.TTKTHHCongHopRanh_CCaoTuongGop,
                TTKTHHCongHopRanh_CCaoMuMoThotDuoi = Input.TTKTHHCongHopRanh_CCaoMuMoThotDuoi,
                TTKTHHCongHopRanh_CRongMuMoDuoi = Input.TTKTHHCongHopRanh_CRongMuMoDuoi,
                TTKTHHCongHopRanh_CCaoMuMoThotTren = Input.TTKTHHCongHopRanh_CCaoMuMoThotTren,
                TTKTHHCongHopRanh_CRongMuMoTren = Input.TTKTHHCongHopRanh_CRongMuMoTren,
                TTKTHHCongHopRanh_CCaoChatMatTrong = Input.TTKTHHCongHopRanh_CCaoChatMatTrong,
                ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = Input.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi,

            };

        PhanLoaiCTronHopNhua plCTHNHoGa = new();
        phanloai = new();
        plCTHNHoGa = await PhanLoaiCTronHopNhuaRepository.GetPhanLoaiCTronHopNhuaByDetail(searchData);
        if (plCTHNHoGa != null)
        {
            phanloai.Name = plCTHNHoGa.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai;
            phanloai.Id = plCTHNHoGa.Id;
        }

        return phanloai;
    }

    //Thêm tên theo bảng phân loại cống hộp cống tròn nhựa
    public async Task<string> ThemTenTheoPLMongCTron(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiMongCTron searchData = new PhanLoaiMongCTron
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinMongDuongTruyenDan_LoaiMong = Input.ThongTinMongDuongTruyenDan_LoaiMong,
                ThongTinMongDuongTruyenDan_HinhThucMong = Input.ThongTinMongDuongTruyenDan_HinhThucMong,
                ThongTinCauTaoCongTron_CCaoLotMong = Input.ThongTinCauTaoCongTron_CCaoLotMong,
                ThongTinCauTaoCongTron_CRongLotMong = Input.ThongTinCauTaoCongTron_CRongLotMong,
                ThongTinCauTaoCongTron_CCaoMong = Input.ThongTinCauTaoCongTron_CCaoMong,
                ThongTinCauTaoCongTron_CRongMong = Input.ThongTinCauTaoCongTron_CRongMong,

            };
        var id = "";
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiMongCTronRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinMongDuongTruyenDan_LoaiMong), GetTenDanhMucById(searchData.ThongTinMongDuongTruyenDan_HinhThucMong), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan));

        }
        return id;
    }

    //Load tên theo phân loại móng cống tròn
    public async Task<PhanLoai> LoadTenPhanLoaiMongCTron(NuocMua Input)
    {
        PhanLoaiMongCTron searchData = new PhanLoaiMongCTron
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinMongDuongTruyenDan_LoaiMong = Input.ThongTinMongDuongTruyenDan_LoaiMong,
                ThongTinMongDuongTruyenDan_HinhThucMong = Input.ThongTinMongDuongTruyenDan_HinhThucMong,
                ThongTinCauTaoCongTron_CCaoLotMong = Input.ThongTinCauTaoCongTron_CCaoLotMong,
                ThongTinCauTaoCongTron_CRongLotMong = Input.ThongTinCauTaoCongTron_CRongLotMong,
                ThongTinCauTaoCongTron_CCaoMong = Input.ThongTinCauTaoCongTron_CCaoMong,
                ThongTinCauTaoCongTron_CRongMong = Input.ThongTinCauTaoCongTron_CRongMong,
            };

        PhanLoaiMongCTron plMCT = new();
        phanloai = new();
        plMCT = await PhanLoaiMongCTronRepository.GetPhanLoaiMongCTronByDetail(searchData);
        if (plMCT != null)
        {
            phanloai.Name = plMCT.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop;
            phanloai.Id = plMCT.Id;
        }
        return phanloai;

    }

    //Thêm tên theo bảng phân loại đế cống
    public async Task<string> ThemTenTheoPLDeCong(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiDeCong searchData = new PhanLoaiDeCong
            {
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinDeCong_CauTaoDeCong = Input.ThongTinDeCong_CauTaoDeCong,
                ThongTinDeCong_D = Input.ThongTinDeCong_D,
                ThongTinDeCong_R = Input.ThongTinDeCong_R,
                ThongTinDeCong_C = Input.ThongTinDeCong_C,
            };
        CheckObjHelper checkObjhelper = new();
        var id = "";
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiDeCongRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDeCong_CauTaoDeCong ?? ""), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan??""));

        }
        return id;
    }

    //Load tên theo phân loại đế cống
    public async Task<PhanLoai> LoadTenPhanLoaiDeCong(NuocMua Input)
    {
        PhanLoaiDeCong searchData = new PhanLoaiDeCong
            {
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinDeCong_CauTaoDeCong = Input.ThongTinDeCong_CauTaoDeCong,
                ThongTinDeCong_D = Input.ThongTinDeCong_D,
                ThongTinDeCong_R = Input.ThongTinDeCong_R,
                ThongTinDeCong_C = Input.ThongTinDeCong_C,
            };

        PhanLoaiDeCong plDC = new();
        phanloai = new();
        plDC = await PhanLoaiDeCongRepository.GetPhanLoaiDeCongByDetail(searchData);
        if (plDC != null)
        {
            phanloai.Name = plDC.ThongTinDeCong_TenLoaiDeCong;
            phanloai.Id = plDC.Id;
        }
        return phanloai;
    }

    //Thêm tên theo bảng phân loại thanh chống
    public async Task<string> ThemTenTheoPLThanhChong(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiThanhChong searchData = new PhanLoaiThanhChong
            {
                TTKTHHCongHopRanh_CauTaoThanhChong = Input.TTKTHHCongHopRanh_CauTaoThanhChong,
                TTKTHHCongHopRanh_CCaoThanhChong = Input.TTKTHHCongHopRanh_CCaoThanhChong,
                TTKTHHCongHopRanh_CRongThanhChong = Input.TTKTHHCongHopRanh_CRongThanhChong,
                TTKTHHCongHopRanh_CDai = Input.TTKTHHCongHopRanh_CDai,
            };
        var id = "";
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiThanhChongRepository.InsertId(searchData, GetTenDanhMucById(searchData.TTKTHHCongHopRanh_CauTaoThanhChong));

        }
        return id;
    }

    //Load tên theo phân loại thanh chống
    public async Task<PhanLoai> LoadTenPhanLoaiThanhChong(NuocMua Input)
    {
        PhanLoaiThanhChong searchData = new PhanLoaiThanhChong
            {
                TTKTHHCongHopRanh_CauTaoThanhChong = Input.TTKTHHCongHopRanh_CauTaoThanhChong,
                TTKTHHCongHopRanh_CCaoThanhChong = Input.TTKTHHCongHopRanh_CCaoThanhChong,
                TTKTHHCongHopRanh_CRongThanhChong = Input.TTKTHHCongHopRanh_CRongThanhChong,
                TTKTHHCongHopRanh_CDai = Input.TTKTHHCongHopRanh_CDai,
            };

        PhanLoaiThanhChong plTC = new();
        phanloai = new();
        plTC = await PhanLoaiThanhChongRepository.GetPhanLoaiThanhChongByDetail(searchData);
        if (plTC != null)
        {

            phanloai.Name = plTC.TTKTHHCongHopRanh_LoaiThanhChong;
            phanloai.Id = plTC.Id;

        }
        return phanloai;
    }

    //Thêm tên theo bảng phân loại tấm đan tryền dẫn
    public async Task<string> ThemTenTheoPLTDanTDan(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao,
            };
        CheckObjHelper checkObjhelper = new();
        var id = "";
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            if (searchData.TTTDCongHoRanh_CDai > 0 || searchData.TTTDCongHoRanh_CRong > 0 || searchData.TTTDCongHoRanh_CCao > 0)
            {
                id = await PhanLoaiTDanTDanRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_HinhThucTruyenDan), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan), GetTenDanhMucById(searchData.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan));
            }
        }
        return id;
    }

    public async Task<string> ThemTenTheoPLTDanTDan02(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai1,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong1,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao1,
            };
        CheckObjHelper checkObjhelper = new();
        var id = "";
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            if (searchData.TTTDCongHoRanh_CDai > 0 || searchData.TTTDCongHoRanh_CRong > 0 || searchData.TTTDCongHoRanh_CCao > 0)
            {
                id = await PhanLoaiTDanTDanRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_HinhThucTruyenDan), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan), GetTenDanhMucById(searchData.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan));
            }
        }
        return id;
    }

    //Load tên theo phân loại tấm đan truyền dẫn
    public async Task<PhanLoai> LoadTenPhanLoaiTDanTDan(NuocMua Input)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao,
            };


        PhanLoaiTDanTDan plTDTD = new();
        phanloai = new();
        plTDTD = await PhanLoaiTDanTDanRepository.GetPhanLoaiTDanTDanByDetail(searchData);
        if (plTDTD != null)
        {
            phanloai.Name = plTDTD.TTTDCongHoRanh_TenLoaiTamDanTieuChuan;
            phanloai.Id = plTDTD.Id;
        }
        return phanloai;

    }
    //Load tên theo phân loại tấm đan truyền dẫn 02
    public async Task<PhanLoai> LoadTenPhanLoaiTDanTDan02(NuocMua Input)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai1,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong1,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao1,
            };


        PhanLoaiTDanTDan plTDTD = new();
        phanloai = new();
        plTDTD = await PhanLoaiTDanTDanRepository.GetPhanLoaiTDanTDanByDetail(searchData);
        if (plTDTD != null)
        {
            phanloai.Name = plTDTD.TTTDCongHoRanh_TenLoaiTamDanTieuChuan;
            phanloai.Id = plTDTD.Id;
        }
        return phanloai;

    }
}
