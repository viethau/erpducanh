@page "/NghiepVuCongtrinh/UploadNuocMua"
@using DucAnhERP.SeedWork;
@using Microsoft.AspNetCore.Components.Forms
@using DucAnhERP.Models
@using DucAnhERP.Repository;
@using DucAnhERP.Helpers
@inject IDanhMucRepository DanhMucRepository ;
@inject INuocMuaRepository NuocMuaRepository ;
@inject IExcelRepository ExcelRepository;
@inject IDanhMucRepository DanhMucRepository;
@inject IPhanLoaiHoGaRepository PhanLoaiHoGaRepository
@inject IPhanLoaiTDHoGaRepository PhanLoaiTDHoGaRepository
@inject IPhanLoaiCTronHopNhuaRepository PhanLoaiCTronHopNhuaRepository
@inject IPhanLoaiMongCTronRepository PhanLoaiMongCTronRepository
@inject IPhanLoaiDeCongRepository PhanLoaiDeCongRepository
@inject IPhanLoaiThanhChongRepository PhanLoaiThanhChongRepository
@inject IPhanLoaiTDanTDanRepository PhanLoaiTDanTDanRepository
@inject DucAnhERP.Services.ToastService ToastService

<div class="container-fluid p-3">

    <div class="d-inline">
        <InputFile class="my-2" OnChange="HandleFileSelected" title="Upload file excel"> Upload </InputFile>
        <a href="/files/file_NuocMua.xlsx" download="file_NuocMua.xlsx" class="btn btn-link  my-3">Tải về file mẫu</a>
    </div>

    @if (excelDataList != null && excelDataList.Count > 0)
    {
        <table class="table table-bordered ">
            <thead>
                <tr>
                    <th class="text-center" rowspan="3"></th>
                    <th class="text-center" rowspan="3">STT</th>
                    <th class="text-center" colspan="2" rowspan="2">Thông tin lý trình</th>
                    <th class="text-center" colspan="9" rowspan="2">Thông tin chung hố ga</th>
                    <th class="text-center" colspan="34">Thông tin kích thước hình học hố ga</th>
                    <th class="text-center" colspan="32">Hạng mục chiếm chỗ hố ga</th>
                    <th class="text-center" colspan="8">Thông tin tấm đan hố ga</th>
                    <th class="text-center" colspan="4" rowspan="2">Thông tin vật liệu đào hố ga</th>
                    <th class="text-center" colspan="18" rowspan="2">Thông tin cao độ hố ga</th>
                    <th class="text-center" colspan="10" rowspan="2"> Thông tin chiều cao C.Chỗ đắp trả hố thu</th>
                    <th class="text-center" colspan="4" rowspan="2">Thông tin mái đào</th>
                    <th class="text-center" colspan="17">Thông tin khối lượng đào</th>
                    <th class="text-center" colspan="4" rowspan="2">Thông tin lý trình truyền dẫn</th>
                    <th class="text-center" colspan="3" rowspan="2">Thông tin đường truyền dẫn</th>
                    <th class="text-center" colspan="3" rowspan="2">Thông tin chiều dài </th>
                    <th class="text-center" colspan="3" rowspan="2">Thông tin móng đường truyền dẫn</th>
                    <th class="text-center" colspan="9">Thông tin đế cống</th>
                    <th class="text-center" colspan="10" rowspan="2">Thông tin cấu tạo cống tròn</th>
                    <th class="text-center" colspan="8" rowspan="2">Thông tính tính KL cấu kiện cống tròn, cống hộp (các loại phải lắp đặt)</th>
                    <th class="text-center" colspan="29">Thông tin kích thước hình học cống hộp, rãnh</th>
                    <th class="text-center" colspan="19">Thông tin tấm đan cống hộp, rãnh</th>
                    <th class="text-center" colspan="6" rowspan="2">Thông tin kích thước hình học ống nhựa</th>
                    <th class="text-center" colspan="28">Cao độ thượng lưu</th>
                    <th class="text-center" colspan="28">Cao độ hạ lưu</th>
                    <th class="text-center" colspan="7">Thông tin vật liệu đào cống, rãnh</th>
                    <th class="text-center" colspan="24">Thông tin C.Cao C.Chỗ cống tròn</th>
                    <th class="text-center" colspan="18">Thông tin C.Cao C.Chỗ cống hộp, rãnh</th>
                    <th class="text-center" colspan="18">Thông tin C.Cao C.Chỗ ống nhựa</th>
                    <th class="text-center" colspan="4">Thông tin mái đào</th>
                    <th class="text-center" colspan="4">D.Tích đào thượng lưu cống, rãnh, ống nhựa, rãnh thang</th>
                    <th class="text-center" colspan="4">D.Tích đào hạ lưu cống, rãnh, ống nhựa, rãnh thang</th>
                    <th class="text-center" colspan="4">Diện tích đào trung bình</th>
                    <th class="text-center" colspan="24">Thông tin khối lượng đào</th>

                    <th class="text-center" colspan="6"> D.Tích đắp cát</th>
                    <th class="text-center" colspan="3" rowspan="2">Diện tích trung bình</th>
                    <th class="text-center" colspan="3" rowspan="2"> Thông tin KL đắp cát</th>
                    <th class="text-center" colspan="2" rowspan="2">Tọa độ</th>
                </tr>
                <tr>
                    <th class="text-center" colspan="2">Thông tin phủ bì hố ga (m)</th>
                    <th class="text-center" colspan="3">Kích thước hình học bê tông lót móng hố ga (m)</th>
                    <th class="text-center" colspan="3">Kích thước hình học bê tông móng hố ga (m)</th>
                    <th class="text-center" colspan="3">KTHH đế hố ga</th>
                    <th class="text-center" colspan="4">Kích thước hình học tường hố ga (m)</th>
                    <th class="text-center" colspan="5">KTHH dầm giữa hố ga</th>
                    <th class="text-center" colspan="3">Chất hố ga mặt trong</th>
                    <th class="text-center" colspan="3">Chất hố ga mặt ngoài, cạnh 01 +02 (m)</th>
                    <th class="text-center" colspan="4">Kích thước hình học tường mũ mố thớt dưới (m)</th>
                    <th class="text-center" colspan="4">Kích thước hình học tường mũ mố thớt trên (m)</th>

                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>

                    <th class="text-center" rowspan="2">Phân loại đậy hố ga</th>
                    <th class="text-center" rowspan="2">Hình thức đậy hố ga</th>
                    <th class="text-center" colspan="2">Loại tròn</th>
                    <th class="text-center" colspan="4">Loại vuông hoặc chữ nhật</th>

                    <th class="text-center" colspan="5">Diện tích đào hố ga</th>
                    <th class="text-center" colspan="12">Thông tin KL đào hố ga</th>

                    <th class="text-center" rowspan="2">Tên loại đế cống</th>
                    <th class="text-center" rowspan="2">Cấu tạo đế cống</th>
                    <th class="text-center" colspan="3">KTHH đế cống</th>
                    <th class="text-center" colspan="4">Khối lượng đế cống</th>

                    <th class="text-center" colspan="4">Thông tin chung</th>
                    <th class="text-center" colspan="2">Lót móng</th>
                    <th class="text-center" colspan="2">Móng</th>
                    <th class="text-center" colspan="2">Đế</th>
                    <th class="text-center" colspan="6">Thân</th>
                    <th class="text-center" colspan="4">Mũ mố</th>
                    <th class="text-center" colspan="6">Thanh chống</th>
                    <th class="text-center" colspan="3">Chát</th>

                    @* Thông tin tấm đan cống hộp, rãnh *@
                    <th class="text-center" colspan="6">Thông tin tấm đan tiêu chuẩn</th>
                    <th class="text-center" colspan="6">Thông tin tấm đan loại 02</th>
                    <th class="text-center" colspan="7">Thông tin tính tấm đan bổ sung</th>

                    @* Cao độ thượng lưu *@
                    <th class="text-center" colspan="7">Đáy đào thượng lưu</th>
                    <th class="text-center" colspan="5">Đỉnh lót thượng lưu</th>
                    <th class="text-center" colspan="6">Đỉnh móng thượng lưu</th>
                    <th class="text-center" colspan="3">Mũ tường, tường thượng lưu</th>
                    <th class="text-center" colspan="7">Đỉnh hoàn thiện thượng lưu</th>

                    @* Cao độ hạ lưu *@
                    <th class="text-center" colspan="7">Đáy đào hạ lưu</th>
                    <th class="text-center" colspan="5">Đỉnh lót hạ lưu</th>
                    <th class="text-center" colspan="6">Đỉnh móng hạ lưu</th>
                    <th class="text-center" colspan="3">Mũ tường, tường hạ lưu</th>
                    <th class="text-center" colspan="7">Đỉnh hoàn thiện hạ lưu</th>

                    @*  Thông tin vật liệu đào cống, rãnh *@
                    <th class="text-center" rowspan="2">Loại vật liệu đào</th>
                    <th class="text-center" colspan="3">Thượng lưu</th>
                    <th class="text-center" colspan="3">Hạ lưu</th>

                    <th class="text-center" colspan="3">Lót C.Chỗ đất</th>
                    <th class="text-center" colspan="3">Lót C.Chỗ đá</th>
                    <th class="text-center" colspan="3">móng C.Chỗ đất</th>
                    <th class="text-center" colspan="3">móng C.Chỗ đá</th>
                    <th class="text-center" colspan="3">Đế C.Chỗ đất</th>
                    <th class="text-center" colspan="3">Đế C.Chỗ đá</th>
                    <th class="text-center" colspan="3">Đỉnh cống C.Chỗ đất</th>
                    <th class="text-center" colspan="3">Đỉnh cống C.Chỗ đá</th>

                    @*  Thông tin C.Cao C.Chỗ ống nhựa *@
                    <th class="text-center" colspan="3">C.Cao lót C.Chỗ đất	</th>
                    <th class="text-center" colspan="3">C.Cao lót C.Chỗ đá</th>
                    <th class="text-center" colspan="3">C.Cao móng C.Chỗ đất</th>
                    <th class="text-center" colspan="3">C.Cao móng C.Chỗ đá	</th>
                    <th class="text-center" colspan="3">C.Cao tường C.Chỗ đất</th>
                    <th class="text-center" colspan="3">C.Cao tường C.Chỗ đá</th>

                    <th class="text-center" colspan="3">C.Cao đệm cát C.Chỗ đất	</th>
                    <th class="text-center" colspan="3">C.Cao đệm cát C.Chỗ đá</th>
                    <th class="text-center" colspan="3">C.Cao ống C.Chỗ đất</th>
                    <th class="text-center" colspan="3">C.Cao ống C.Chỗ đá	</th>
                    <th class="text-center" colspan="3">C.Cao đắp cát C.Chỗ đất</th>
                    <th class="text-center" colspan="3">C.Cao đắp cát C.Chỗ đá</th>

                    @* Thông tin mái đào *@
                    <th class="text-center" colspan="4"> Thông tin mái đào cống, rãnh, ống nhựa, rãnh thang</th>

                    @* D.Tích đào thượng lưu cống, rãnh, ống nhựa, rãnh thang *@
                    <th class="text-center" colspan="2">Đào đất</th>
                    <th class="text-center" colspan="2">Đào đá</th>
                    @* D.Tích đào hạ lưu cống, rãnh, ống nhựa, rãnh thang *@
                    <th class="text-center" colspan="2">Đào đất</th>
                    <th class="text-center" colspan="2">Đào đá</th>
                    @* Diện tích đào trung bình *@
                    <th class="text-center" colspan="2">Đào đất</th>
                    <th class="text-center" colspan="2">Đào đá</th>

                    @* Thông tin khối lượng đào *@
                    <th class="text-center" colspan="3">KL đào cống, rãnh, ống nhựa, rãnh thang</th>
                    <th class="text-center" colspan="3">KL C.Chỗ C.Tròn</th>
                    <th class="text-center" colspan="3">KL C.Chỗ C.hộp</th>
                    <th class="text-center" colspan="3">KL C.Chỗ rãnh xây + bê tông</th>
                    <th class="text-center" colspan="3">KL C.Chỗ ống nhựa</th>
                    <th class="text-center" colspan="3">Tổng KL chiếm chỗ</th>
                    <th class="text-center" colspan="3">Kl đắp trả	</th>
                    <th class="text-center" colspan="3">KL thừa</th>

                    <th class="text-center" colspan="3">Thượng lưu</th>
                    <th class="text-center" colspan="3">Hạ lưu</th>
                </tr>
                <tr>
                    <th>Tuyến đường</th>
                    <th>Lộ trình tại tim hố ga</th>

                    <th>Tên hố ga sau phân loại</th>
                    <th>Tên hố ga theo bản vẽ</th>
                    <th>Hình thức hố ga</th>
                    <th>Kết cấu mũ mố</th>
                    <th>Kết cấu tường</th>
                    <th>Hình thức móng hố ga</th>
                    <th>Kết cấu móng</th>
                    <th>Chất mặt trong</th>
                    <th>Chất mặt ngoài</th>

                    @* Thông tin kích thước hình học hố ga *@
                    <th>C.D dài (m)</th>
                    <th>C.rộng (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th class="text-danger">C (m)</th>
                    <th>CD tường (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD dầm (m)</th>
                    <th>C.Cao dầm giữa tường so với đáy hố ga (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th class="text-danger">C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th class="text-danger">C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD tường (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD tường (m)</th>

                    @* Hạng mục chiếm chỗ hố ga *@
                    <th>Máng thu</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>D1500</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>D1000</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Rãnh B1000</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>B1000CL </th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>D600</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Rãnh B800</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>B2000</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    @* Thông tin tấm đan hố ga *@
                    <th>Đường kính (m) </th>
                    <th>Chiều dầy (m)</th>

                    <th>D (m) </th>
                    <th>R (m) </th>
                    <th>C (m)</th>
                    <th>Số lượng nắp đậy (C.Kiện)</th>

                    @* Thông tin vật liệu đào hố ga *@

                    <th> Loại vật liệu đào</th>
                    <th>Chiều cao đào đá (m) </th>
                    <th class="text-danger">Chiều cao đào đất (m)</th>
                    <th class="text-danger">Tổng chiều cao đào</th>

                    @*Thông tin cao độ hố ga *@
                    <th>Cao độ tự nhiên (m)</th>
                    <th>CĐ đỉnh vỉa hè hoàn thiện (m)</th>
                    <th>Cao độ đỉnh K98 (m)</th>
                    <th class="text-danger">Cao độ hiện trạng trước khi đào (m)</th>
                    <th class="text-danger">Đáy đào (m)</th>
                    <th class="text-danger">C.Sâu đào (m)</th>
                    <th class="text-danger">Đỉnh lót móng (m)</th>
                    <th class="text-danger">CĐ đỉnh móng</th>
                    <th>CĐ đáy hố ga (m)</th>
                    <th class="text-danger">C.Cao tường (m)</th>
                    <th class="text-danger">Đỉnh tường dưới dầm giữa tường (m)</th>
                    <th class="text-danger">Đỉnh dầm giữa tường (m)</th>
                    <th class="text-danger">Đỉnh tường (m)</th>
                    <th class="text-danger">Đỉnh mũ mố thớt dưới (m)</th>
                    <th>CĐ đỉnh hố ga (m)</th>
                    <th class="text-danger">Tổng chiều cao hố ga</th>
                    <th class="text-danger">Chênh cao đỉnh hố ga và hiện trạng đào (m)</th>
                    <th class="text-danger">Tổng chiều cao chiếm chỗ đắp trả</th>

                    @* Thông tin chiều cao C.Chỗ đắp trả hố thu *@
                    <th class="text-danger">Chiều cao lót C.Chỗ đất (m)</th>
                    <th class="text-danger">Chiều cao móng C.Chỗ đất (m)</th>
                    <th class="text-danger">Chiều cao tường C.Chỗ đất (m)</th>
                    <th class="text-danger">Chiều cao lót C.Chỗ đá (m)</th>
                    <th class="text-danger">Chiều cao móng C.Chỗ đá (m)</th>
                    <th class="text-danger">Chiều cao tường C.Chỗ đá (m)</th>
                    <th class="text-danger">Tổng C.Cao C.Chỗ đất</th>
                    <th class="text-danger">Tổng C.Cao C.Chỗ đá</th>
                    <th class="text-danger">Chênh đất so với thiết kế</th>
                    <th class="text-danger">Chênh đá so với thiết kế</th>

                    @* Thông tin mái đào *@
                    <th>Chiều rộng đáy đào nhỏ (m)</th>
                    <th>Tỷ lệ mở mái (m)</th>
                    <th>Số cạnh mái trái</th>
                    <th>Số cạnh mái phải</th>

                    @* Thông tin khối lượng đào *@
                    <th class="text-danger">C.Rộng đào đáy lớn đất (m)</th>
                    <th class="text-danger">C.Rộng đào đáy lớn đá (m)</th>
                    <th class="text-danger">Diện tích đào đất (m2)</th>
                    <th class="text-danger">Diện tích đào đá (m2)</th>
                    <th class="text-danger">Tổng DT đào (m2)</th>
                    <th class="text-danger">KL đào đất (m3)</th>
                    <th class="text-danger">KL đào đá (m3)</th>
                    <th class="text-danger">Tổng KL đào (m3)</th>
                    <th class="text-danger">KL chiếm chỗ đất (m3)</th>
                    <th class="text-danger">KL chiếm chỗ đá (m3)</th>
                    <th class="text-danger">Tổng chiếm chỗ (m3)</th>
                    <th class="text-danger">KL đắp trả đất (m3)</th>
                    <th class="text-danger">KL đắp trả đá (m3)</th>
                    <th class="text-danger">Tổng đắp trả (m3)</th>
                    <th class="text-danger">KL thừa đất (m3)</th>
                    <th class="text-danger">KL thừa đá (m3)</th>
                    <th class="text-danger">Tổng thừa (m3)</th>

                    @* Thông tin lý trình truyền dẫn *@
                    <th>Từ lý trình</th>
                    <th>Đến lý trình</th>
                    <th>Từ hố ga</th>
                    <th>Đến hố ga</th>
                    @* Thông tin đường truyền dẫn *@
                    <th>Hình thức truyền dẫn</th>
                    <th>Loại truyền dẫn</th>
                    <th>Tên loại truyền dẫn sau phân loại</th>

                    @* Thông tin chiều dài *@
                    <th>Tổng chiều dài (m)          </th>
                    <th>Chiều dài 01 cấu kiện (m)   </th>
                    <th class="text-danger">SL cấu kiện tính KL         </th>

                    @* Thông tin móng đường truyền dẫn *@
                    <th>Phân loại móng cống tròn, cống hộp</th>
                    <th>Loại móng</th>
                    <th>Hình thức móng</th>

                    @* Thông tin đế cống *@
                    <th>D</th>
                    <th>R</th>
                    <th>C</th>
                    <th>SL đế cống/01 cấu kiện truyền dẫn (C.Kiện)</th>
                    <th>KL 01 đế cống</th>
                    <th class="text-danger">Tổng số lượng đế cống</th>
                    <th class="text-danger">Tổng KL đế cống</th>

                    @* Thông tin cấu tạo cống tròn *@
                    <th>C.Dầy phủ bì (m)</th>
                    <th>Số cạnh</th>
                    <th>Lòng sử dụng (m)</th>
                    <th class="text-danger">C.Cao cấu kiện</th>
                    <th>C.Cao lót móng (m)</th>
                    <th>C.Rộng lót móng</th>
                    <th>C.Cao móng (m)</th>
                    <th>C.Rộng móng (m)</th>
                    <th>C.Cao đế (tại vị trí đặt C.Kiện) (m)</th>
                    <th class="text-danger">Tổng C.Cao cống (m)</th>

                    @* Thông tính tính KL cấu kiện cống tròn, cống hộp (các loại phải lắp đặt) *@
                    <th>Chiều dài mối nối C.Kiện (m) </th>
                    <th>Số lượng C.Kiện dùng để tính chiều dài bổ sung (C.Kiện) </th>
                    <th class="text-danger">SL cấu kiện nguyên </th>
                    <th class="text-danger">C.Dài cần để lắp đặt được theo số CK nguyên (m) </th>
                    <th class="text-danger">Tổng C.Dài lắp đặt theo số CK nguyên (m) </th>
                    <th class="text-danger">C.Dài thực tế còn thừa (+)/thiếu (-) so với C.Rộng lòng mũ mố hố ga (m) </th>
                    <th class="text-danger">Xác định ống cống cần thêm </th>
                    <th class="text-danger">C.Dài còn thừa (+)/thiếu (-) sau tính theo CK tính KL (m)  </th>


                    @* Thông tin kích thước hình học cống hộp, rãnh *@
                    <th>Cấu tạo tường</th>
                    <th>Cấu tạo mũ mố</th>
                    <th>Chát mặt trong</th>
                    <th>Chát mặt ngoài</th>
                    <th>C.Cao lót móng (m)</th>
                    <th>C.Rộng lót móng (m)</th>
                    <th>C.Cao móng (m)</th>
                    <th>C.Rộng móng (m)</th>
                    <th>C.Cao đế (m)</th>
                    <th>C.Rộng đế (m)</th>
                    <th>C.Dầy tường 01 bên (m)</th>
                    <th>Số lượng tường (m)</th>
                    <th>C.Rộng lòng sử dụng (m)</th>
                    <th>C.Cao tường cống hộp (m)</th>
                    <th class="text-danger">C.Cao tường rãnh</th>
                    <th class="text-danger">C.Cao tường gộp</th>
                    <th>C.Cao mũ mố thớt dưới (m)</th>
                    <th>C.Rộng mũ mố dưới</th>
                    <th>C.Cao mũ mố thớt trên (m)</th>
                    <th>C.Rộng mũ mố trên</th>
                    <th>Loại thanh chống</th>
                    <th>Cấu tạo thanh chống</th>
                    <th>C.Cao thanh chống (m)</th>
                    <th>C.Rộng thanh chống (m)</th>
                    <th>C.Dài (m)</th>
                    <th>Số lượng thanh chống (cái)</th>
                    <th class="text-danger">C.Cao chát mặt trong (m)</th>
                    <th class="text-danger">C.Cao chát mặt ngoài (m)</th>
                    <th class="text-danger">Tổng chiều cao (m)</th>

                    @* Thông tin tấm đan cống hộp, rãnh *@
                    <th>Tên loại tấm đan tiêu chuẩn</th>
                    <th>Cấu tạo tấm đan truyền dẫn tấm đan tiêu chuẩn</th>
                    <th class="text-danger">Số lượng</th>
                    <th>C.Dài</th>
                    <th>C.Rộng</th>
                    <th>C.Cao</th>
                    <th>Tên loại tấm đan loại 02</th>
                    <th>Cấu tạo tấm đan truyền dẫn</th>
                    <th class="text-danger">Số lượng</th>
                    <th class="text-danger">C.Dài</th>
                    <th>C.Rộng</th>
                    <th>C.Cao</th>
                    <th>Chiều dài mối nối (m)</th>
                    <th>Số lượng T.Đan dùng để tính chiều dài bổ sung (C.Kiện)</th>
                    <th class="text-danger">SL cấu kiện nguyên</th>
                    <th class="text-danger">Chiều dài cần để lắp đặt được theo số CK nguyên (m)</th>
                    <th class="text-danger">Tổng chiều dài lắp đặt theo số CK nguyên (m)</th>
                    <th class="text-danger">Chiều dài thực tế còn thừa (+)/thiếu (-) so với C.Rộng lòng mũ mố hố ga (m)</th>
                    <th class="text-danger">Xác định ống cống cần thêm</th>


                    @* Thông tin kích thước hình học ống nhựa *@
                    <th>C.Dầy phủ bì (m)</th>
                    <th>Số cạnh</th>
                    <th>Lòng sử dụng (m)</th>
                    <th class="text-danger">Tổng C.Cao ống (m)</th>
                    <th>C.Cao đệm cát (m)</th>
                    <th>C.Cao đắp cát (m)</th>

                    @* Cao độ thượng lưu *@
                    <th> Hiện trạng trước khi đào thượng lưu (m)</th>
                    <th class="text-danger"> Đáy đào gộp (C.Tròn, C.Hộp, Rãnh, Ô.Nhựa, rãnh thang)</th>
                    <th class="text-danger"> Chiều sâu đào</th>
                    <th class="text-danger"> Đáy đào cống tròn (m)</th>
                    <th class="text-danger"> Đáy đào cống hộp (m)</th>
                    <th class="text-danger"> Đáy đào rãnh (m)</th>
                    <th class="text-danger"> Đáy đào ống nhựa (m)</th>
                    <th class="text-danger"> Đỉnh lót gộp (C.Tròn, C.Hộp, Rãnh, ống nhựa, rãnh thang)</th>
                    <th class="text-danger"> Đỉnh lót ống nhựa</th>
                    <th class="text-danger"> Đỉnh lót cống tròn (m)</th>
                    <th class="text-danger"> Đỉnh lót cống hộp (m)</th>
                    <th class="text-danger"> Đỉnh lót rãnh (m)</th>
                    <th class="text-danger"> Đỉnh móng gộp (C.Tròn, C.Hộp, Rãnh, rãnh thang)</th>
                    <th class="text-danger"> Đỉnh móng cống tròn (m)</th>
                    <th class="text-danger"> Đỉnh móng cống hộp (m)</th>
                    <th class="text-danger"> Đỉnh móng rãnh (m)</th>
                    <th class="text-danger"> Đỉnh đế cống (m)</th>
                    <th> Đáy dòng chảy (m)</th>
                    <th class="text-danger"> C.Cao tường cống, rãnh (m)</th>
                    <th class="text-danger"> Đỉnh tường C.Hộp, rãnh (m)</th>
                    <th class="text-danger"> Đỉnh mũ mố thớt dưới cống hộp rãnh (m)</th>
                    <th class="text-danger"> Đỉnh gộp (C.Tròn, C.Hộp, rãnh, Ô.Nhựa, Rãnh thang (m)</th>
                    <th> Đỉnh trong lòng sử dụng (m)</th>
                    <th class="text-danger"> Đỉnh cống tròn (m)</th>
                    <th class="text-danger"> Đỉnh cống hộp (m)</th>
                    <th class="text-danger"> Đỉnh rãnh (m)</th>
                    <th class="text-danger"> Đỉnh ống nhựa (m)</th>
                    <th class="text-danger"> Đỉnh đắp cát (m) </th>

                    @* Cao độ hạ lưu *@
                    <th> Hiện trạng trước khi đào hạ lưu (m)</th>
                    <th class="text-danger">Đáy đào gộp (C.Tròn, C.Hộp, Rãnh, Ô.Nhựa, rãnh thang)</th>
                    <th class="text-danger">Chiều sâu đào</th>
                    <th class="text-danger">Đáy đào cống tròn (m)</th>
                    <th class="text-danger">Đáy đào cống hộp (m)</th>
                    <th class="text-danger">Đáy đào rãnh (m)</th>
                    <th class="text-danger">Đáy đào ống nhựa (m)</th>
                    <th class="text-danger">Đỉnh lót gộp (C.Tròn, C.Hộp, Rãnh, ống nhựa, rãnh thang)</th>
                    <th class="text-danger">Đỉnh lót ống nhựa</th>
                    <th class="text-danger">Đỉnh lót cống tròn (m)</th>
                    <th class="text-danger">Đỉnh lót cống hộp (m)</th>
                    <th class="text-danger">Đỉnh lót rãnh (m)</th>
                    <th class="text-danger">Đỉnh móng gộp (C.Tròn, C.Hộp, Rãnh, rãnh thang)</th>
                    <th class="text-danger">Đỉnh móng cống tròn (m)</th>
                    <th class="text-danger">Đỉnh móng cống hộp (m)</th>
                    <th class="text-danger">Đỉnh móng rãnh (m)</th>
                    <th class="text-danger">Đỉnh đế cống (m)</th>
                    <th>Đáy dòng chảy (m)</th>
                    <th class="text-danger">C.Cao tường cống, rãnh (m)</th>
                    <th class="text-danger">Đỉnh tường C.Hộp, rãnh (m)</th>
                    <th class="text-danger">Đỉnh mũ mố thớt dưới cống hộp rãnh (m)</th>
                    <th class="text-danger">Đỉnh gộp (C.Tròn, C.Hộp, rãnh, Ô.Nhựa, Rãnh thang (m)</th>
                    <th>Đỉnh trong lòng sử dụng (m)</th>
                    <th class="text-danger">Đỉnh cống tròn (m)</th>
                    <th class="text-danger">Đỉnh cống hộp (m)</th>
                    <th class="text-danger">Đỉnh rãnh (m)</th>
                    <th class="text-danger">Đỉnh ống nhựa (m)</th>
                    <th class="text-danger">Đỉnh đắp cát (m) </th>

                    @* Thông tin vật liệu đào cống, rãnh *@
                    <th>Chiều cao đào đá (m)</th>
                    <th>Chiều cao đào đất (m)</th>
                    <th class="text-danger">Tổng chiều sâu đào</th>
                    <th>Chiều cao đào đá (m)</th>
                    <th class="text-danger">Chiều cao đào đất (m)</th>
                    <th class="text-danger">Tổng chiều sâu đào</th>

                    @* Thông tin C.Cao C.Chỗ cống tròn *@
                    <th class="text-danger">C.Cao lót T.Lưu</th>
                    <th class="text-danger">C.Cao lót H.lưu</th>
                    <th class="text-danger">C.Cao lót móng T.Bình</th>
                    <th class="text-danger">C.Cao lót T.Lưu</th>
                    <th class="text-danger">C.Cao lót H.lưu</th>
                    <th class="text-danger">C.Cao lót móng T.Bình</th>
                    <th class="text-danger">C.Cao móng T.Lưu</th>
                    <th class="text-danger">C.Cao móng H.Lưu</th>
                    <th class="text-danger">C.Cao móng T.Bình</th>
                    <th class="text-danger">C.Cao móng T.Lưu</th>
                    <th class="text-danger">C.Cao móng H.Lưu</th>
                    <th class="text-danger">C.Cao móng T.Bình</th>
                    <th class="text-danger">C.Cao đế T.Lưu</th>
                    <th class="text-danger">C.Cao đế H.Lưu</th>
                    <th class="text-danger">C.Cao đế T.Bình</th>
                    <th class="text-danger">C.Cao đế T.Lưu</th>
                    <th class="text-danger">C.Cao đế H.Lưu</th>
                    <th class="text-danger">C.Cao đế T.Bình</th>
                    <th class="text-danger">C.Cao cống T.Lưu</th>
                    <th class="text-danger">C.Cao cống H.Lưu</th>
                    <th class="text-danger">C.Cao cống T.Bình</th>
                    <th class="text-danger">C.Cao cống T.Lưu</th>
                    <th class="text-danger">C.Cao cống H.Lưu</th>
                    <th class="text-danger">C.Cao cống T.Bình</th>

                    @* Thông tin C.Cao C.Chỗ cống hộp, rãnh *@

                    <th class="text-danger">C.Cao lót T.Lưu</th>
                    <th class="text-danger">C.Cao lót H.Lưu</th>
                    <th class="text-danger">C.Cao lót T.Bình</th>
                    <th class="text-danger">C.Cao lót T.Lưu</th>
                    <th class="text-danger">C.Cao lót H.Lưu</th>
                    <th class="text-danger">C.Cao lót T.Bình</th>
                    <th class="text-danger">C.Cao móng T.Lưu</th>
                    <th class="text-danger">C.Cao móng H.Lưu</th>
                    <th class="text-danger">C.Cao móng T.Bình</th>
                    <th class="text-danger">C.Cao móng T.Lưu</th>
                    <th class="text-danger">C.Cao móng H.Lưu</th>
                    <th class="text-danger">C.Cao móng T.Bình</th>
                    <th class="text-danger">C.Cao tường T.Lưu</th>
                    <th class="text-danger">C.Cao tường H.Lưu</th>
                    <th class="text-danger">C.Cao tường T.Bình</th>
                    <th class="text-danger">C.Cao tường T.Lưu</th>
                    <th class="text-danger">C.Cao tường H.Lưu</th>
                    <th class="text-danger">C.Cao tường T.Bình</th>

                    @* Thông tin C.Cao C.Chỗ ống nhựa *@
                    <th class="text-danger">C.Cao đệm cát T.Lưu</th>
                    <th class="text-danger">C.Cao đệm cát H.Lưu</th>
                    <th class="text-danger">C.Cao đệm cát T.Bình</th>
                    <th class="text-danger">C.Cao đệm cát T.Lưu</th>
                    <th class="text-danger">C.Cao đệm cát H.Lưu</th>
                    <th class="text-danger">C.Cao đệm cát T.Bình</th>
                    <th class="text-danger">C.Cao ống T.Lưu</th>
                    <th class="text-danger">C.Cao ống H.Lưu</th>
                    <th class="text-danger">C.Cao T.Bình</th>
                    <th class="text-danger">C.Cao ống T.Lưu</th>
                    <th class="text-danger">C.Cao ống H.Lưu</th>
                    <th class="text-danger">C.Cao T.Bình</th>
                    <th class="text-danger">C.Cao đắp cát T.Lưu</th>
                    <th class="text-danger">C.Cao Đắp cát H.Lưu</th>
                    <th class="text-danger">C.Cao đắp cát T.Bình</th>
                    <th class="text-danger">C.Cao đắp cát T.Lưu</th>
                    <th class="text-danger">C.Cao Đắp cát H.Lưu</th>
                    <th class="text-danger">C.Cao đắp cát T.Bình</th>

                    @* Thông tin mái đào *@
                    <th>Chiều rộng đáy đào nhỏ (m)</th>
                    <th>Tỷ lệ mở mái</th>
                    <th>Số cạnh mái trái</th>
                    <th>Số cạnh mái phải</th>


                    @* D.Tích đào thượng lưu cống, rãnh, ống nhựa, rãnh thang *@
                    <th class="text-danger">C.Rộng đào đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đào (m2)</th>
                    <th class="text-danger">C.Rộng đào đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đào (m2)</th>
                    @* D.Tích đào hạ lưu cống, rãnh, ống nhựa, rãnh thang *@
                    <th class="text-danger">C.Rộng đào đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đào (m2)</th>
                    <th class="text-danger">C.Rộng đào đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đào (m2)</th>
                    @* Diện tích đào trung bình *@
                    <th class="text-danger">C.Rộng đào đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đào (m2)</th>
                    <th class="text-danger">C.Rộng đào đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đào (m2)</th>

                    @* Thông tin khối lượng đào *@
                    <th class="text-danger">KL đào đất (m3)</th>
                    <th class="text-danger">KL đào đá (m3)</th>
                    <th class="text-danger">Tổng KL đào cống, rãnh, ống nhựa, rãnh thang (m3)</th>
                    <th class="text-danger">KL C.Chỗ đất cống tròn (m3)</th>
                    <th class="text-danger">KL C.Chỗ đá cống tròn (m3)</th>
                    <th class="text-danger">Tổng KL chiếm chỗ C.Tròn (m3)</th>
                    <th class="text-danger">KL C.chỗ đất cống hộp (m3)</th>
                    <th class="text-danger">KL C.chỗ đá cống hộp (m3)</th>
                    <th class="text-danger">Tổng KL C.chỗ cống hộp (m3)</th>
                    <th class="text-danger">KL C.chỗ đất rãnh (m3)</th>
                    <th class="text-danger">KL C.chỗ đá rãnh (m3)</th>
                    <th class="text-danger">Tổng KL C.chỗ rãnh (m3)</th>
                    <th class="text-danger">KL C.Chỗ đất ống nhựa (m)</th>
                    <th class="text-danger">KL C.Chỗ đá ống nhựa (m3)</th>
                    <th class="text-danger">Tổng KL C.Chỗ ống nhựa (m3)</th>
                    <th class="text-danger">KL C.chỗ đất (m3)</th>
                    <th class="text-danger">KL C.Chỗ đá (m3)</th>
                    <th class="text-danger">Tổng chiếm chỗ (m3)</th>
                    <th class="text-danger">KL đắp trả đất (m3)</th>
                    <th class="text-danger">KL đắp trả đá (m3)</th>
                    <th class="text-danger">Tổng KL đắp trả (m3)</th>
                    <th class="text-danger">KL thừa đất (m3)</th>
                    <th class="text-danger">KL thừa đá (m3)</th>
                    <th class="text-danger">Tổng KL thừa (m3) </th>

                    @*D.Tích đắp cát *@
                    <th class="text-danger">C.Sâu đắp (m)</th>
                    <th class="text-danger">C.Rộng đắp đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đắp (m2)</th>
                    <th class="text-danger">C.Sâu đắp (m)</th>
                    <th class="text-danger">C.Rộng đắp đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đắp (m2)</th>
                    @*Diện tích trung bình *@
                    <th class="text-danger">C.Sâu đắp (m) </th>
                    <th class="text-danger">C.Rộng đắp đáy lớn (m)</th>
                    <th class="text-danger">D.Tích đắp (m2)  </th>
                    @*Thông tin KL đắp cát *@
                    <th class="text-danger">KL đắp cát trước chiếm chỗ (m3)</th>
                    <th class="text-danger">KL chiếm chỗ (m3)</th>
                    <th class="text-danger">KL đắp cát sau chiếm chỗ (m3) </th>
                    @* Tọa độ *@
                    <th>X</th>
                    <th>Y</th>

                </tr>
            </thead>
            <tbody>
                @foreach (var excelData in excelDataList)
                {
                    <tr>
                        @foreach (var value in excelData.RowData)
                        {
                            <td>@value</td>
                        }
                    </tr>
                }
            </tbody>
        </table>
    }
</div>
@code {
    private List<ExcelData> excelDataList;
    private List<NuocMua> listNuocMua ;
    public List<DanhMuc> listDanhMuc = new();

    protected override async Task OnInitializedAsync()
    {
        listDanhMuc = await DanhMucRepository.GetAll();
    }

    private async Task HandleFileSelected(InputFileChangeEventArgs e)
    {
        var file = e.File;
        if (file != null)
        {
            try
            {
                if (file.Size > 10485760)
                {
                    // Hiển thị thông báo lỗi
                    ToastService.ShowToast("Thông báo", "File quá lớn vui lòng kiếm tra lại file", cssClass: "toast-danger");
                }
                else
                {
                    using (var stream = new MemoryStream())
                    {
                        await file.OpenReadStream(maxAllowedSize: 10 * 1024 * 1024).CopyToAsync(stream);
                        stream.Position = 0;
                        excelDataList = await ExcelRepository.ReadExcelDataAsync(stream);
                        if (excelDataList.Count > 0 && excelDataList[0].RowData.Count >= 409)
                        {
                            listNuocMua = await convertData(excelDataList);
                            List<NuocMua> listConvertNuocMua = new();
                            DSNuocMuaConversionHelper helper = new();
                            listConvertNuocMua = await helper.ConvertDSNuocMua(listNuocMua,listDanhMuc);
                            listNuocMua = await loadPhanLoai(listConvertNuocMua);
                            var count = await NuocMuaRepository.MultiInsert(listNuocMua);
                            Console.WriteLine(listNuocMua);
                            ToastService.ShowToast("Thông báo", "Đã thêm thành công :" + count + " dòng.", cssClass: "toast-success");
                        }
                        else
                        {
                            excelDataList = new();
                            ToastService.ShowToast("Thông báo", "Số cột dòng phải đủ như file mẫu. Vui lòng kiểm tra lại", cssClass: "toast-danger");
                        }

                    }
                }

            }
            catch (Exception ex)
            {
                // Ghi lại chi tiết lỗi hoặc xử lý lỗi tại đây
                Console.WriteLine($"Error: {ex.Message}");
            }
        }
    }

    //load phan loai
    public async Task<List<NuocMua>> loadPhanLoai(List<NuocMua> listData)
    {
        try
        {
            List<NuocMua> listNM = new();
            for (int i = 0; i < listData.Count; i++)
            {
                NuocMua nuocMua = listData[i];

                //load phân loại

                var loadTenHoGaSauPhanLoai = await LoadTenHoGaSauPhanLoai(nuocMua);
                if (string.IsNullOrEmpty(loadTenHoGaSauPhanLoai.Id))
                {
                    var id = await ThemTenTheoPL(nuocMua);
                    nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = id;
                }
                else
                {
                    nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = loadTenHoGaSauPhanLoai.Id;
                }
                //load phân loại LoadTenHoGaSauPhanLoaiTDHoGa

                var loadTenHoGaSauPhanLoaiTDHoGa = await LoadTenHoGaSauPhanLoaiTDHoGa(nuocMua);
                if (string.IsNullOrEmpty(loadTenHoGaSauPhanLoaiTDHoGa.Id))
                {
                    var id = await ThemTenTheoPLTDHoGa(nuocMua, listDanhMuc);
                    nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = id;
                }
                else
                {
                    nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = loadTenHoGaSauPhanLoaiTDHoGa.Id;
                }
                //load phân loại  LoadTenPLCTronHopNhua

                var loadTenPLCTronHopNhua = await LoadTenPLCTronHopNhua(nuocMua);
                if (string.IsNullOrEmpty(loadTenPLCTronHopNhua.Id))
                {
                    var id = await ThemTenTheoPLCTronHopNhua(nuocMua, listDanhMuc);
                    nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = id;
                }
                else
                {
                    nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = loadTenPLCTronHopNhua.Id;
                }
                //load phân loại LoadTenPhanLoaiMongCTron

                var loadTenPhanLoaiMongCTron = await LoadTenPhanLoaiMongCTron(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiMongCTron.Id))
                {
                    var id = await ThemTenTheoPLMongCTron(nuocMua, listDanhMuc);
                    nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = id;
                }
                else
                {
                    nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = loadTenPhanLoaiMongCTron.Id;
                }
                //load phân loại loadTenPhanLoaiDeCong

                var loadTenPhanLoaiDeCong = await LoadTenPhanLoaiDeCong(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiDeCong.Id))
                {
                    var id = await ThemTenTheoPLDeCong(nuocMua, listDanhMuc);
                    nuocMua.ThongTinDeCong_TenLoaiDeCong = id;
                }
                else
                {
                    nuocMua.ThongTinDeCong_TenLoaiDeCong = loadTenPhanLoaiDeCong.Id;
                }
                //load phân loại  LoadTenPhanLoaiThanhChong

                var loadTenPhanLoaiThanhChong = await LoadTenPhanLoaiThanhChong(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiThanhChong.Id))
                {
                    var id = await ThemTenTheoPLThanhChong(nuocMua, listDanhMuc);
                    nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = id;
                }
                else
                {
                    nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = loadTenPhanLoaiThanhChong.Id;
                }
                //load phân loại LoadTenPhanLoaiTDanTDan

                var loadTenPhanLoaiTDanTDan = await LoadTenPhanLoaiTDanTDan(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiTDanTDan.Id))
                {
                    var id = await ThemTenTheoPLTDanTDan(nuocMua, listDanhMuc);
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = id;
                }
                else
                {
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = loadTenPhanLoaiTDanTDan.Id;
                }

                //load phân loại TTTDCongHoRanh_TenLoaiTamDanLoai02 loadTenPhanLoaiTDanTDan02

                var loadTenPhanLoaiTDanTDan02 = await LoadTenPhanLoaiTDanTDan02(nuocMua);
                if (string.IsNullOrEmpty(loadTenPhanLoaiTDanTDan02.Id))
                {
                    var id = await ThemTenTheoPLTDanTDan02(nuocMua, listDanhMuc);
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = id;
                }
                else
                {
                    nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = loadTenPhanLoaiTDanTDan02.Id;
                }


                listNM.Add(nuocMua);
            }


            return listNM;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            throw;
        }
    }

    public async Task<List<NuocMua>> convertData(List<ExcelData> listData)
    {
        try
        {
            List<NuocMua> listNM = new();
            for (int i = 0; i < listData.Count; i++)
            {
                NuocMua nuocMua = new();

                nuocMua.Id = Guid.NewGuid().ToString();
                nuocMua.ThongTinLyTrinh_TuyenDuong = listData[i].RowData[1].ToString() ?? "";
                nuocMua.ThongTinLyTrinh_LyTrinhTaiTimHoGa = listData[i].RowData[2].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_TenHoGaSauPhanLoai = listData[i].RowData[3].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_TenHoGaTheoBanVe = listData[i].RowData[4].ToString() ?? "";
                nuocMua.ThongTinChungHoGa_HinhThucHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[5].ToString() ?? "", "HG_HTHGa");
                nuocMua.ThongTinChungHoGa_KetCauMuMo = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[6].ToString() ?? "", "HG_LMMHoGa");
                nuocMua.ThongTinChungHoGa_KetCauTuong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[7].ToString() ?? "", "HG_LTHoGa");
                nuocMua.ThongTinChungHoGa_HinhThucMongHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[8].ToString() ?? "", "HG_HTMHoGa");
                nuocMua.ThongTinChungHoGa_KetCauMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[9].ToString() ?? "", "HG_LMHoGa");
                nuocMua.ThongTinChungHoGa_ChatMatTrong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[10].ToString() ?? "");
                nuocMua.ThongTinChungHoGa_ChatMatNgoai = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[11].ToString() ?? "");
                nuocMua.PhuBiHoGa_CDai = ParseDoubleOrDefault(listData[i].RowData[12], 0);
                nuocMua.PhuBiHoGa_CRong = ParseDoubleOrDefault(listData[i].RowData[13], 0);
                nuocMua.BeTongLotMong_D = ParseDoubleOrDefault(listData[i].RowData[14], 0);
                nuocMua.BeTongLotMong_R = ParseDoubleOrDefault(listData[i].RowData[15], 0);
                nuocMua.BeTongLotMong_C = ParseDoubleOrDefault(listData[i].RowData[16], 0);
                nuocMua.BeTongMongHoGa_D = ParseDoubleOrDefault(listData[i].RowData[17], 0);
                nuocMua.BeTongMongHoGa_R = ParseDoubleOrDefault(listData[i].RowData[18], 0);
                nuocMua.BeTongMongHoGa_C = ParseDoubleOrDefault(listData[i].RowData[19], 0);
                nuocMua.DeHoGa_D = ParseDoubleOrDefault(listData[i].RowData[20], 0);
                nuocMua.DeHoGa_R = ParseDoubleOrDefault(listData[i].RowData[21], 0);
                nuocMua.DeHoGa_C = ParseDoubleOrDefault(listData[i].RowData[22], 0);
                nuocMua.TuongHoGa_D = ParseDoubleOrDefault(listData[i].RowData[23], 0);
                nuocMua.TuongHoGa_R = ParseDoubleOrDefault(listData[i].RowData[24], 0);

                nuocMua.TuongHoGa_CdTuong = ParseDoubleOrDefault(listData[i].RowData[26], 0);
                nuocMua.DamGiuaHoGa_D = ParseDoubleOrDefault(listData[i].RowData[27], 0);
                nuocMua.DamGiuaHoGa_R = ParseDoubleOrDefault(listData[i].RowData[28], 0);
                nuocMua.DamGiuaHoGa_C = ParseDoubleOrDefault(listData[i].RowData[29], 0);
                nuocMua.DamGiuaHoGa_CdDam = ParseDoubleOrDefault(listData[i].RowData[30], 0);
                nuocMua.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = ParseDoubleOrDefault(listData[i].RowData[31], 0);
                nuocMua.ChatMatTrong_D = ParseDoubleOrDefault(listData[i].RowData[32], 0);
                nuocMua.ChatMatTrong_R = ParseDoubleOrDefault(listData[i].RowData[33], 0);

                nuocMua.ChatMatNgoaiCanh_D = ParseDoubleOrDefault(listData[i].RowData[35], 0);
                nuocMua.ChatMatNgoaiCanh_R = ParseDoubleOrDefault(listData[i].RowData[36], 0);

                nuocMua.MuMoThotDuoi_D = ParseDoubleOrDefault(listData[i].RowData[38], 0);
                nuocMua.MuMoThotDuoi_R = ParseDoubleOrDefault(listData[i].RowData[39], 0);
                nuocMua.MuMoThotDuoi_C = ParseDoubleOrDefault(listData[i].RowData[40], 0);
                nuocMua.MuMoThotDuoi_CdTuong = ParseDoubleOrDefault(listData[i].RowData[41], 0);
                nuocMua.MuMoThotTren_D = ParseDoubleOrDefault(listData[i].RowData[42], 0);
                nuocMua.MuMoThotTren_R = ParseDoubleOrDefault(listData[i].RowData[43], 0);
                nuocMua.MuMoThotTren_C = ParseDoubleOrDefault(listData[i].RowData[44], 0);
                nuocMua.MuMoThotTren_CdTuong = ParseDoubleOrDefault(listData[i].RowData[45], 0);
                nuocMua.HinhThucDauNoi1_Loai = ParseDoubleOrDefault(listData[i].RowData[46], 0);
                nuocMua.HinhThucDauNoi1_CanhDai = ParseDoubleOrDefault(listData[i].RowData[47], 0);
                nuocMua.HinhThucDauNoi1_CanhRong = ParseDoubleOrDefault(listData[i].RowData[48], 0);
                nuocMua.HinhThucDauNoi1_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[49], 0);
                nuocMua.HinhThucDauNoi2_Loai = ParseDoubleOrDefault(listData[i].RowData[50], 0);
                nuocMua.HinhThucDauNoi2_CanhDai = ParseDoubleOrDefault(listData[i].RowData[51], 0);
                nuocMua.HinhThucDauNoi2_CanhRong = ParseDoubleOrDefault(listData[i].RowData[52], 0);
                nuocMua.HinhThucDauNoi2_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[53], 0);
                nuocMua.HinhThucDauNoi3_Loai = ParseDoubleOrDefault(listData[i].RowData[54], 0);
                nuocMua.HinhThucDauNoi3_CanhDai = ParseDoubleOrDefault(listData[i].RowData[55], 0);
                nuocMua.HinhThucDauNoi3_CanhRong = ParseDoubleOrDefault(listData[i].RowData[56], 0);
                nuocMua.HinhThucDauNoi3_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[57], 0);
                nuocMua.HinhThucDauNoi4_Loai = ParseDoubleOrDefault(listData[i].RowData[58], 0);
                nuocMua.HinhThucDauNoi4_CanhDai = ParseDoubleOrDefault(listData[i].RowData[59], 0);
                nuocMua.HinhThucDauNoi4_CanhRong = ParseDoubleOrDefault(listData[i].RowData[60], 0);
                nuocMua.HinhThucDauNoi4_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[61], 0);
                nuocMua.HinhThucDauNoi5_Loai = ParseDoubleOrDefault(listData[i].RowData[62], 0);
                nuocMua.HinhThucDauNoi5_CanhDai = ParseDoubleOrDefault(listData[i].RowData[63], 0);
                nuocMua.HinhThucDauNoi5_CanhRong = ParseDoubleOrDefault(listData[i].RowData[64], 0);
                nuocMua.HinhThucDauNoi5_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[65], 0);
                nuocMua.HinhThucDauNoi6_Loai = ParseDoubleOrDefault(listData[i].RowData[66], 0);
                nuocMua.HinhThucDauNoi6_CanhDai = ParseDoubleOrDefault(listData[i].RowData[67], 0);
                nuocMua.HinhThucDauNoi6_CanhRong = ParseDoubleOrDefault(listData[i].RowData[68], 0);
                nuocMua.HinhThucDauNoi6_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[69], 0);
                nuocMua.HinhThucDauNoi7_Loai = ParseDoubleOrDefault(listData[i].RowData[70], 0);
                nuocMua.HinhThucDauNoi7_CanhDai = ParseDoubleOrDefault(listData[i].RowData[71], 0);
                nuocMua.HinhThucDauNoi7_CanhRong = ParseDoubleOrDefault(listData[i].RowData[72], 0);
                nuocMua.HinhThucDauNoi7_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[73], 0);
                nuocMua.HinhThucDauNoi8_Loai = ParseDoubleOrDefault(listData[i].RowData[74], 0);
                nuocMua.HinhThucDauNoi8_CanhDai = ParseDoubleOrDefault(listData[i].RowData[75], 0);
                nuocMua.HinhThucDauNoi8_CanhRong = ParseDoubleOrDefault(listData[i].RowData[76], 0);
                nuocMua.HinhThucDauNoi8_CanhCheo = ParseDoubleOrDefault(listData[i].RowData[77], 0);
                nuocMua.ThongTinTamDanHoGa2_PhanLoaiDayHoGa = listData[i].RowData[78].ToString() ?? "";
                nuocMua.ThongTinTamDanHoGa2_HinhThucDayHoGa = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[79].ToString() ?? "", "HG_HTDHoGa");  
                nuocMua.ThongTinTamDanHoGa2_DuongKinh = ParseDoubleOrDefault(listData[i].RowData[80], 0);
                nuocMua.ThongTinTamDanHoGa2_ChieuDay = ParseDoubleOrDefault(listData[i].RowData[81], 0);
                nuocMua.ThongTinTamDanHoGa2_D = ParseDoubleOrDefault(listData[i].RowData[82], 0);
                nuocMua.ThongTinTamDanHoGa2_R = ParseDoubleOrDefault(listData[i].RowData[83], 0);
                nuocMua.ThongTinTamDanHoGa2_C = ParseDoubleOrDefault(listData[i].RowData[84], 0);
                nuocMua.ThongTinTamDanHoGa2_SoLuongNapDay = ParseDoubleOrDefault(listData[i].RowData[85], 0);
                nuocMua.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[86].ToString() ?? "", "HG_LVLDHoGa");
                nuocMua.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[87], 0);

                nuocMua.ThongTinCaoDoHoGa_CaoDoTuNhien = ParseDoubleOrDefault(listData[i].RowData[90], 0);
                nuocMua.ThongTinCaoDoHoGa_CdDinhViaHeHoanThien = ParseDoubleOrDefault(listData[i].RowData[91], 0);
                nuocMua.ThongTinCaoDoHoGa_CaoDoDinhK98 = ParseDoubleOrDefault(listData[i].RowData[92], 0);

                nuocMua.ThongTinCaoDoHoGa_CdDayHoGa = ParseDoubleOrDefault(listData[i].RowData[98], 0);

                nuocMua.ThongTinCaoDoHoGa_CdDinhHoGa = ParseDoubleOrDefault(listData[i].RowData[104], 0);

                nuocMua.ThongTinMaiDao_ChieuRongDayDaoNho = ParseDoubleOrDefault(listData[i].RowData[118], 0);
                nuocMua.ThongTinMaiDao_TyLeMoMai = ParseDoubleOrDefault(listData[i].RowData[119], 0);
                nuocMua.ThongTinMaiDao_SoCanhMaiTrai = ParseDoubleOrDefault(listData[i].RowData[120], 0);
                nuocMua.ThongTinMaiDao_SoCanhMaiPhai = ParseDoubleOrDefault(listData[i].RowData[121], 0);

                nuocMua.ThongTinLyTrinhTruyenDan_TuLyTrinh = ParseDoubleOrDefault(listData[i].RowData[139], 0);
                nuocMua.ThongTinLyTrinhTruyenDan_DenLyTrinh = ParseDoubleOrDefault(listData[i].RowData[140], 0);
                nuocMua.ThongTinLyTrinhTruyenDan_TuHoGa = listData[i].RowData[141].ToString() ?? "";
                nuocMua.ThongTinLyTrinhTruyenDan_DenHoGa = listData[i].RowData[142].ToString() ?? "";
                nuocMua.ThongTinDuongTruyenDan_HinhThucTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[143].ToString() ?? "", "TD_HTTruyenDan");
                nuocMua.ThongTinDuongTruyenDan_LoaiTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[144].ToString() ?? "", "TD_LTruyenDan");
                nuocMua.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai = listData[i].RowData[145].ToString() ?? "";
                nuocMua.TTCDSLCauKienDuongTruyenDan_TongChieuDai = ParseDoubleOrDefault(listData[i].RowData[146], 0);
                nuocMua.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = ParseDoubleOrDefault(listData[i].RowData[147], 0);

                nuocMua.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop = listData[i].RowData[149].ToString() ?? "";
                nuocMua.ThongTinMongDuongTruyenDan_LoaiMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[150].ToString() ?? "", "TD_LMTruyenDan");
                nuocMua.ThongTinMongDuongTruyenDan_HinhThucMong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[151].ToString() ?? "", "TD_HTMTruyenDan");
                nuocMua.ThongTinDeCong_TenLoaiDeCong = listData[i].RowData[152].ToString() ?? "";
                nuocMua.ThongTinDeCong_CauTaoDeCong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[153].ToString() ?? "", "TD_CTDCTron");
                nuocMua.ThongTinDeCong_D = ParseDoubleOrDefault(listData[i].RowData[154], 0);
                nuocMua.ThongTinDeCong_R = ParseDoubleOrDefault(listData[i].RowData[155], 0);
                nuocMua.ThongTinDeCong_C = ParseDoubleOrDefault(listData[i].RowData[156], 0);
                nuocMua.ThongTinDeCong_SlDeCong01CauKienTruyenDan = ParseDoubleOrDefault(listData[i].RowData[157], 0);
                nuocMua.ThongTinDeCong_Kl01DeCong = ParseDoubleOrDefault(listData[i].RowData[158], 0);

                nuocMua.ThongTinCauTaoCongTron_CDayPhuBi = ParseDoubleOrDefault(listData[i].RowData[161], 0);
                nuocMua.ThongTinCauTaoCongTron_SoCanh = ParseDoubleOrDefault(listData[i].RowData[162], 0);
                nuocMua.ThongTinCauTaoCongTron_LongSuDung = ParseDoubleOrDefault(listData[i].RowData[163], 0);

                nuocMua.ThongTinCauTaoCongTron_CCaoLotMong = ParseDoubleOrDefault(listData[i].RowData[165], 0);
                nuocMua.ThongTinCauTaoCongTron_CRongLotMong = ParseDoubleOrDefault(listData[i].RowData[166], 0);
                nuocMua.ThongTinCauTaoCongTron_CCaoMong = ParseDoubleOrDefault(listData[i].RowData[167], 0);
                nuocMua.ThongTinCauTaoCongTron_CRongMong = ParseDoubleOrDefault(listData[i].RowData[168], 0);
                nuocMua.ThongTinCauTaoCongTron_CCaoDe = ParseDoubleOrDefault(listData[i].RowData[169], 0);

                nuocMua.TTTKLCKCTCH_CDMoiNoiCKien = ParseDoubleOrDefault(listData[i].RowData[171], 0);
                nuocMua.TTTKLCKCTCH_SLCKDungDeTinhCD = ParseDoubleOrDefault(listData[i].RowData[172], 0);
                nuocMua.TTTKLCKCTCH_SLCKNguyen = ParseDoubleOrDefault(listData[i].RowData[173], 0);

                nuocMua.TTKTHHCongHopRanh_CauTaoTuong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[179].ToString() ?? "", "TD_LDanhTuong");
                nuocMua.TTKTHHCongHopRanh_CauTaoMuMo = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[180].ToString() ?? "", "TD_LMMCongRanh");
                nuocMua.TTKTHHCongHopRanh_ChatMatTrong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[181].ToString() ?? "");
                nuocMua.TTKTHHCongHopRanh_ChatMatNgoai = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[182].ToString() ?? "");
                nuocMua.TTKTHHCongHopRanh_CCaoLotMong = ParseDoubleOrDefault(listData[i].RowData[183], 0);
                nuocMua.TTKTHHCongHopRanh_CRongLotMong = ParseDoubleOrDefault(listData[i].RowData[184], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoMong = ParseDoubleOrDefault(listData[i].RowData[185], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMong = ParseDoubleOrDefault(listData[i].RowData[186], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoDe = ParseDoubleOrDefault(listData[i].RowData[187], 0);
                nuocMua.TTKTHHCongHopRanh_CRongDe = ParseDoubleOrDefault(listData[i].RowData[188], 0);
                nuocMua.TTKTHHCongHopRanh_CDayTuong01Ben = ParseDoubleOrDefault(listData[i].RowData[189], 0);
                nuocMua.TTKTHHCongHopRanh_SoLuongTuong = ParseDoubleOrDefault(listData[i].RowData[190], 0);
                nuocMua.TTKTHHCongHopRanh_CRongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[191], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoTuongCongHop = ParseDoubleOrDefault(listData[i].RowData[192], 0);

                nuocMua.TTKTHHCongHopRanh_CCaoMuMoThotDuoi = ParseDoubleOrDefault(listData[i].RowData[195], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMuMoDuoi = ParseDoubleOrDefault(listData[i].RowData[196], 0);
                nuocMua.TTKTHHCongHopRanh_CCaoMuMoThotTren = ParseDoubleOrDefault(listData[i].RowData[197], 0);
                nuocMua.TTKTHHCongHopRanh_CRongMuMoTren = ParseDoubleOrDefault(listData[i].RowData[198], 0);
                nuocMua.TTKTHHCongHopRanh_LoaiThanhChong = listData[i].RowData[199].ToString() ??"";
                nuocMua.TTKTHHCongHopRanh_CauTaoThanhChong = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[200].ToString() ?? "", "TD_CTTChongRanh");;
                nuocMua.TTKTHHCongHopRanh_CCaoThanhChong = ParseDoubleOrDefault(listData[i].RowData[201], 0);
                nuocMua.TTKTHHCongHopRanh_CRongThanhChong = ParseDoubleOrDefault(listData[i].RowData[202], 0);
                nuocMua.TTKTHHCongHopRanh_CDai = ParseDoubleOrDefault(listData[i].RowData[203], 0);
                nuocMua.TTKTHHCongHopRanh_SoLuongThanhChong = ParseDoubleOrDefault(listData[i].RowData[204], 0);

                nuocMua.TTTDCongHoRanh_TenLoaiTamDanTieuChuan = listData[i].RowData[208].ToString() ?? "";
                nuocMua.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[209].ToString() ?? "", "TD_CTTDTruyenDan");


                nuocMua.TTTDCongHoRanh_CDai = ParseDoubleOrDefault(listData[i].RowData[211], 0);
                nuocMua.TTTDCongHoRanh_CRong = ParseDoubleOrDefault(listData[i].RowData[212], 0);
                nuocMua.TTTDCongHoRanh_CCao = ParseDoubleOrDefault(listData[i].RowData[213], 0);
                nuocMua.TTTDCongHoRanh_TenLoaiTamDanLoai02 = listData[i].RowData[214].ToString() ?? "";
                nuocMua.TTTDCongHoRanh_CauTaoTamDanTruyenDan = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[215].ToString() ?? "", "TD_CTTDTruyenDan");

                nuocMua.TTTDCongHoRanh_CRong1 = ParseDoubleOrDefault(listData[i].RowData[218], 0);
                nuocMua.TTTDCongHoRanh_CCao1 = ParseDoubleOrDefault(listData[i].RowData[219], 0);
                nuocMua.TTTDCongHoRanh_ChieuDaiMoiNoi = ParseDoubleOrDefault(listData[i].RowData[220], 0);
                nuocMua.TTTDCongHoRanh_SoLuongTDanDungDeTinhChieuDaiBoSung = ParseDoubleOrDefault(listData[i].RowData[221], 0);

                nuocMua.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = ParseDoubleOrDefault(listData[i].RowData[227], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_SoCanh = ParseDoubleOrDefault(listData[i].RowData[228], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_LongSuDung = ParseDoubleOrDefault(listData[i].RowData[229], 0);

                nuocMua.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat = ParseDoubleOrDefault(listData[i].RowData[231], 0);
                nuocMua.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat = ParseDoubleOrDefault(listData[i].RowData[232], 0);
                nuocMua.CDThuongLuu_HienTrangTruocKhiDaoThuongLuu = ParseDoubleOrDefault(listData[i].RowData[233], 0);

                nuocMua.CDThuongLuu_DayDongChay = ParseDoubleOrDefault(listData[i].RowData[250], 0);

                nuocMua.CDThuongLuu_DinhTrongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[255], 0);

                nuocMua.CDHaLu_HienTrangTruocKhiDaoHaLuu = ParseDoubleOrDefault(listData[i].RowData[261], 0);

                nuocMua.CDHaLu_DayDaoOngNhua = ParseDoubleOrDefault(listData[i].RowData[267], 0);

                nuocMua.CDHaLu_DayDongChay = ParseDoubleOrDefault(listData[i].RowData[278], 0);

                nuocMua.CDHaLu_DinhTrongLongSuDung = ParseDoubleOrDefault(listData[i].RowData[283], 0);

                nuocMua.TTVLDCongRanh_LoaiVatLieuDao = await DanhMucRepository.GetIdDMByTen(listData[i].RowData[289].ToString() ?? ""); ;
                nuocMua.TTVLDCongRanh_TLChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[290], 0);

                nuocMua.TTVLDCongRanh_HLChieuCaoDaoDa = ParseDoubleOrDefault(listData[i].RowData[293], 0);
                nuocMua.TTVLDCongRanh_HLChieuCaoDaoDat = ParseDoubleOrDefault(listData[i].RowData[294], 0);

                nuocMua.TTMDRanhOngThang_ChieuRongDayDaoNho = ParseDoubleOrDefault(listData[i].RowData[356], 0);
                nuocMua.TTMDRanhOngThang_TyLeMoMai = ParseDoubleOrDefault(listData[i].RowData[357], 0);
                nuocMua.TTMDRanhOngThang_SoCanhMaiTrai = ParseDoubleOrDefault(listData[i].RowData[358], 0);
                nuocMua.TTMDRanhOngThang_SoCanhMaiPhai = ParseDoubleOrDefault(listData[i].RowData[359], 0);

                nuocMua.ToaDoX = ParseDoubleOrDefault(listData[i].RowData[408], 0);
                nuocMua.ToaDoY = ParseDoubleOrDefault(listData[i].RowData[409], 0);

                listNM.Add(nuocMua);
            }


            return listNM;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            throw;
        }
    }

    public static double ParseDoubleOrDefault(object input, double defaultValue = 0)
    {
        string value = input?.ToString() ?? "";
        if (string.IsNullOrWhiteSpace(value))
        {
            return defaultValue;
        }
        if (double.TryParse(value, out double result))
        {
            return result;
        }
        return defaultValue;
    }

    public static int ParseIntOrDefault(object input, int defaultValue = 0)
    {
        string value = input?.ToString() ?? "";
        if (string.IsNullOrWhiteSpace(value))
        {
            return defaultValue;
        }

        if (int.TryParse(value.Trim(), out int result))
        {
            return result;
        }

        return defaultValue;
    }

    public string GetTenDanhMucById(string id)
    {
        var danhMuc = listDanhMuc.FirstOrDefault(dm => dm.Id == id);
        return danhMuc != null ? danhMuc.Ten : null;
    }

    PhanLoai phanloai=new();

    //Thêm tên theo bảng phân loại hố ga
    public async Task<string> ThemTenTheoPL(NuocMua Input)
    {
        var id = "";
        PhanLoaiHoGa searchData = new PhanLoaiHoGa
            {
                ThongTinChungHoGa_TenHoGaSauPhanLoai = Input.ThongTinChungHoGa_TenHoGaSauPhanLoai,
                ThongTinChungHoGa_HinhThucHoGa = Input.ThongTinChungHoGa_HinhThucHoGa,
                ThongTinChungHoGa_KetCauMuMo = Input.ThongTinChungHoGa_KetCauMuMo,
                ThongTinChungHoGa_KetCauTuong = Input.ThongTinChungHoGa_KetCauTuong,
                ThongTinChungHoGa_HinhThucMongHoGa = Input.ThongTinChungHoGa_HinhThucMongHoGa,
                ThongTinChungHoGa_KetCauMong = Input.ThongTinChungHoGa_KetCauMong,
                ThongTinChungHoGa_ChatMatTrong = Input.ThongTinChungHoGa_ChatMatTrong,
                ThongTinChungHoGa_ChatMatNgoai = Input.ThongTinChungHoGa_ChatMatNgoai,
                PhuBiHoGa_CDai = Input.PhuBiHoGa_CDai,
                PhuBiHoGa_CRong = Input.PhuBiHoGa_CRong,
                BeTongLotMong_D = Input.BeTongLotMong_D,
                BeTongLotMong_R = Input.BeTongLotMong_R,
                BeTongLotMong_C = Input.BeTongLotMong_C,
                BeTongMongHoGa_D = Input.BeTongMongHoGa_D,
                BeTongMongHoGa_R = Input.BeTongMongHoGa_R,
                BeTongMongHoGa_C = Input.BeTongMongHoGa_C,
                DeHoGa_D = Input.DeHoGa_D,
                DeHoGa_R = Input.DeHoGa_R,
                DeHoGa_C = Input.DeHoGa_C,
                TuongHoGa_D = Input.TuongHoGa_D,
                TuongHoGa_R = Input.TuongHoGa_R,
                TuongHoGa_C = Input.TuongHoGa_C,
                TuongHoGa_CdTuong = Input.TuongHoGa_CdTuong,
                DamGiuaHoGa_D = Input.DamGiuaHoGa_D,
                DamGiuaHoGa_R = Input.DamGiuaHoGa_R,
                DamGiuaHoGa_C = Input.DamGiuaHoGa_C,
                DamGiuaHoGa_CdDam = Input.DamGiuaHoGa_CdDam,
                DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = Input.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa,
                ChatMatTrong_D = Input.ChatMatTrong_D,
                ChatMatTrong_R = Input.ChatMatTrong_R,
                ChatMatTrong_C = Input.ChatMatTrong_C,
                ChatMatNgoaiCanh_D = Input.ChatMatNgoaiCanh_D,
                ChatMatNgoaiCanh_R = Input.ChatMatNgoaiCanh_R,
                ChatMatNgoaiCanh_C = Input.ChatMatNgoaiCanh_C,
                MuMoThotDuoi_D = Input.MuMoThotDuoi_D,
                MuMoThotDuoi_R = Input.MuMoThotDuoi_R,
                MuMoThotDuoi_C = Input.MuMoThotDuoi_C,
                MuMoThotDuoi_CdTuong = Input.MuMoThotDuoi_CdTuong,
                MuMoThotTren_D = Input.MuMoThotTren_D,
                MuMoThotTren_R = Input.MuMoThotTren_R,
                MuMoThotTren_C = Input.MuMoThotTren_C,
                MuMoThotTren_CdTuong = Input.MuMoThotTren_CdTuong,
                HinhThucDauNoi1_Loai = Input.HinhThucDauNoi1_Loai,
                HinhThucDauNoi1_CanhDai = Input.HinhThucDauNoi1_CanhDai,
                HinhThucDauNoi1_CanhRong = Input.HinhThucDauNoi1_CanhRong,
                HinhThucDauNoi1_CanhCheo = Input.HinhThucDauNoi1_CanhCheo,
                HinhThucDauNoi2_Loai = Input.HinhThucDauNoi2_Loai,
                HinhThucDauNoi2_CanhDai = Input.HinhThucDauNoi2_CanhDai,
                HinhThucDauNoi2_CanhRong = Input.HinhThucDauNoi2_CanhRong,
                HinhThucDauNoi2_CanhCheo = Input.HinhThucDauNoi2_CanhCheo,
                HinhThucDauNoi3_Loai = Input.HinhThucDauNoi3_Loai,
                HinhThucDauNoi3_CanhDai = Input.HinhThucDauNoi3_CanhDai,
                HinhThucDauNoi3_CanhRong = Input.HinhThucDauNoi3_CanhRong,
                HinhThucDauNoi3_CanhCheo = Input.HinhThucDauNoi3_CanhCheo,
                HinhThucDauNoi4_Loai = Input.HinhThucDauNoi4_Loai,
                HinhThucDauNoi4_CanhDai = Input.HinhThucDauNoi4_CanhDai,
                HinhThucDauNoi4_CanhRong = Input.HinhThucDauNoi4_CanhRong,
                HinhThucDauNoi4_CanhCheo = Input.HinhThucDauNoi4_CanhCheo,
                HinhThucDauNoi5_Loai = Input.HinhThucDauNoi5_Loai,
                HinhThucDauNoi5_CanhDai = Input.HinhThucDauNoi5_CanhDai,
                HinhThucDauNoi5_CanhRong = Input.HinhThucDauNoi5_CanhRong,
                HinhThucDauNoi5_CanhCheo = Input.HinhThucDauNoi5_CanhCheo,
                HinhThucDauNoi6_Loai = Input.HinhThucDauNoi6_Loai,
                HinhThucDauNoi6_CanhDai = Input.HinhThucDauNoi6_CanhDai,
                HinhThucDauNoi6_CanhRong = Input.HinhThucDauNoi6_CanhRong,
                HinhThucDauNoi6_CanhCheo = Input.HinhThucDauNoi6_CanhCheo,
                HinhThucDauNoi7_Loai = Input.HinhThucDauNoi7_Loai,
                HinhThucDauNoi7_CanhDai = Input.HinhThucDauNoi7_CanhDai,
                HinhThucDauNoi7_CanhRong = Input.HinhThucDauNoi7_CanhRong,
                HinhThucDauNoi7_CanhCheo = Input.HinhThucDauNoi7_CanhCheo,
                HinhThucDauNoi8_Loai = Input.HinhThucDauNoi8_Loai,
                HinhThucDauNoi8_CanhDai = Input.HinhThucDauNoi8_CanhDai,
                HinhThucDauNoi8_CanhRong = Input.HinhThucDauNoi8_CanhRong,
                HinhThucDauNoi8_CanhCheo = Input.HinhThucDauNoi8_CanhCheo
            };

        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiHoGaRepository.InsertId(searchData, Input.ThongTinChungHoGa_TenHoGaTheoBanVe);
            Input.ThongTinChungHoGa_TenHoGaSauPhanLoai = id;
        }
        return id;
    }

    //Load tên theo phân loại hố ga
    public async Task<PhanLoai> LoadTenHoGaSauPhanLoai(NuocMua Input)
    {
        PhanLoaiHoGa searchData = new PhanLoaiHoGa
            {
                ThongTinChungHoGa_TenHoGaSauPhanLoai = Input.ThongTinChungHoGa_TenHoGaSauPhanLoai,

                ThongTinChungHoGa_HinhThucHoGa = Input.ThongTinChungHoGa_HinhThucHoGa,
                ThongTinChungHoGa_KetCauMuMo = Input.ThongTinChungHoGa_KetCauMuMo,
                ThongTinChungHoGa_KetCauTuong = Input.ThongTinChungHoGa_KetCauTuong,
                ThongTinChungHoGa_HinhThucMongHoGa = Input.ThongTinChungHoGa_HinhThucMongHoGa,
                ThongTinChungHoGa_KetCauMong = Input.ThongTinChungHoGa_KetCauMong,
                ThongTinChungHoGa_ChatMatTrong = Input.ThongTinChungHoGa_ChatMatTrong,
                ThongTinChungHoGa_ChatMatNgoai = Input.ThongTinChungHoGa_ChatMatNgoai,
                PhuBiHoGa_CDai = Input.PhuBiHoGa_CDai,
                PhuBiHoGa_CRong = Input.PhuBiHoGa_CRong,
                BeTongLotMong_D = Input.BeTongLotMong_D,
                BeTongLotMong_R = Input.BeTongLotMong_R,
                BeTongLotMong_C = Input.BeTongLotMong_C,
                BeTongMongHoGa_D = Input.BeTongMongHoGa_D,
                BeTongMongHoGa_R = Input.BeTongMongHoGa_R,
                BeTongMongHoGa_C = Input.BeTongMongHoGa_C,
                DeHoGa_D = Input.DeHoGa_D,
                DeHoGa_R = Input.DeHoGa_R,
                DeHoGa_C = Input.DeHoGa_C,
                TuongHoGa_D = Input.TuongHoGa_D,
                TuongHoGa_R = Input.TuongHoGa_R,
                TuongHoGa_C = Input.TuongHoGa_C,
                TuongHoGa_CdTuong = Input.TuongHoGa_CdTuong,
                DamGiuaHoGa_D = Input.DamGiuaHoGa_D,
                DamGiuaHoGa_R = Input.DamGiuaHoGa_R,
                DamGiuaHoGa_C = Input.DamGiuaHoGa_C,
                DamGiuaHoGa_CdDam = Input.DamGiuaHoGa_CdDam,
                DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa = Input.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa,
                ChatMatTrong_D = Input.ChatMatTrong_D,
                ChatMatTrong_R = Input.ChatMatTrong_R,
                ChatMatTrong_C = Input.ChatMatTrong_C,
                ChatMatNgoaiCanh_D = Input.ChatMatNgoaiCanh_D,
                ChatMatNgoaiCanh_R = Input.ChatMatNgoaiCanh_R,
                ChatMatNgoaiCanh_C = Input.ChatMatNgoaiCanh_C,
                MuMoThotDuoi_D = Input.MuMoThotDuoi_D,
                MuMoThotDuoi_R = Input.MuMoThotDuoi_R,
                MuMoThotDuoi_C = Input.MuMoThotDuoi_C,
                MuMoThotDuoi_CdTuong = Input.MuMoThotDuoi_CdTuong,
                MuMoThotTren_D = Input.MuMoThotTren_D,
                MuMoThotTren_R = Input.MuMoThotTren_R,
                MuMoThotTren_C = Input.MuMoThotTren_C,
                MuMoThotTren_CdTuong = Input.MuMoThotTren_CdTuong,
                HinhThucDauNoi1_Loai = Input.HinhThucDauNoi1_Loai,
                HinhThucDauNoi1_CanhDai = Input.HinhThucDauNoi1_CanhDai,
                HinhThucDauNoi1_CanhRong = Input.HinhThucDauNoi1_CanhRong,
                HinhThucDauNoi1_CanhCheo = Input.HinhThucDauNoi1_CanhCheo,
                HinhThucDauNoi2_Loai = Input.HinhThucDauNoi2_Loai,
                HinhThucDauNoi2_CanhDai = Input.HinhThucDauNoi2_CanhDai,
                HinhThucDauNoi2_CanhRong = Input.HinhThucDauNoi2_CanhRong,
                HinhThucDauNoi2_CanhCheo = Input.HinhThucDauNoi2_CanhCheo,
                HinhThucDauNoi3_Loai = Input.HinhThucDauNoi3_Loai,
                HinhThucDauNoi3_CanhDai = Input.HinhThucDauNoi3_CanhDai,
                HinhThucDauNoi3_CanhRong = Input.HinhThucDauNoi3_CanhRong,
                HinhThucDauNoi3_CanhCheo = Input.HinhThucDauNoi3_CanhCheo,
                HinhThucDauNoi4_Loai = Input.HinhThucDauNoi4_Loai,
                HinhThucDauNoi4_CanhDai = Input.HinhThucDauNoi4_CanhDai,
                HinhThucDauNoi4_CanhRong = Input.HinhThucDauNoi4_CanhRong,
                HinhThucDauNoi4_CanhCheo = Input.HinhThucDauNoi4_CanhCheo,
                HinhThucDauNoi5_Loai = Input.HinhThucDauNoi5_Loai,
                HinhThucDauNoi5_CanhDai = Input.HinhThucDauNoi5_CanhDai,
                HinhThucDauNoi5_CanhRong = Input.HinhThucDauNoi5_CanhRong,
                HinhThucDauNoi5_CanhCheo = Input.HinhThucDauNoi5_CanhCheo,
                HinhThucDauNoi6_Loai = Input.HinhThucDauNoi6_Loai,
                HinhThucDauNoi6_CanhDai = Input.HinhThucDauNoi6_CanhDai,
                HinhThucDauNoi6_CanhRong = Input.HinhThucDauNoi6_CanhRong,
                HinhThucDauNoi6_CanhCheo = Input.HinhThucDauNoi6_CanhCheo,
                HinhThucDauNoi7_Loai = Input.HinhThucDauNoi7_Loai,
                HinhThucDauNoi7_CanhDai = Input.HinhThucDauNoi7_CanhDai,
                HinhThucDauNoi7_CanhRong = Input.HinhThucDauNoi7_CanhRong,
                HinhThucDauNoi7_CanhCheo = Input.HinhThucDauNoi7_CanhCheo,
                HinhThucDauNoi8_Loai = Input.HinhThucDauNoi8_Loai,
                HinhThucDauNoi8_CanhDai = Input.HinhThucDauNoi8_CanhDai,
                HinhThucDauNoi8_CanhRong = Input.HinhThucDauNoi8_CanhRong,
                HinhThucDauNoi8_CanhCheo = Input.HinhThucDauNoi8_CanhCheo
            };

        PhanLoaiHoGa plHoGa = new();
        phanloai = new();
        plHoGa = await PhanLoaiHoGaRepository.GetPhanLoaiHoGaByDetail(searchData);
        if (plHoGa != null)
        {
            phanloai.Name = plHoGa.ThongTinChungHoGa_TenHoGaSauPhanLoai;
            phanloai.Id = plHoGa.Id;
        }


        return phanloai;
    }

    //Thêm tên theo bảng phân loại tấm đan hố ga
    public async Task<string> ThemTenTheoPLTDHoGa(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        var id = "";
        PhanLoaiTDHoGa searchData = new PhanLoaiTDHoGa
            {
                ThongTinTamDanHoGa2_HinhThucDayHoGa = Input.ThongTinTamDanHoGa2_HinhThucDayHoGa,
                ThongTinTamDanHoGa2_DuongKinh = Input.ThongTinTamDanHoGa2_DuongKinh,
                ThongTinTamDanHoGa2_ChieuDay = Input.ThongTinTamDanHoGa2_ChieuDay,
                ThongTinTamDanHoGa2_D = Input.ThongTinTamDanHoGa2_D,
                ThongTinTamDanHoGa2_R = Input.ThongTinTamDanHoGa2_R,
                ThongTinTamDanHoGa2_C = Input.ThongTinTamDanHoGa2_C

            };
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiTDHoGaRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinTamDanHoGa2_HinhThucDayHoGa));

        }
        return id;

    }

    //Load tên theo phân loại tấm đan hố ga
    public async Task<PhanLoai> LoadTenHoGaSauPhanLoaiTDHoGa(NuocMua Input)
    {
        PhanLoaiTDHoGa searchData = new PhanLoaiTDHoGa
            {

                ThongTinTamDanHoGa2_HinhThucDayHoGa = Input.ThongTinTamDanHoGa2_HinhThucDayHoGa,
                ThongTinTamDanHoGa2_DuongKinh = Input.ThongTinTamDanHoGa2_DuongKinh,
                ThongTinTamDanHoGa2_ChieuDay = Input.ThongTinTamDanHoGa2_ChieuDay,
                ThongTinTamDanHoGa2_D = Input.ThongTinTamDanHoGa2_D,
                ThongTinTamDanHoGa2_R = Input.ThongTinTamDanHoGa2_R,
                ThongTinTamDanHoGa2_C = Input.ThongTinTamDanHoGa2_C
            };

        PhanLoaiTDHoGa plTDHoGa = new();
        phanloai = new();
        plTDHoGa = await PhanLoaiTDHoGaRepository.GetPhanLoaiTDHoGaByDetail(searchData);
        if (plTDHoGa != null)
        {
            phanloai.Id = plTDHoGa.Id;
            phanloai.Name = plTDHoGa.ThongTinTamDanHoGa2_PhanLoaiDayHoGa;
        }
        return phanloai;

    }

    //Thêm tên theo bảng phân loại cống hộp cống tròn nhựa
    public async Task<string> ThemTenTheoPLCTronHopNhua(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiCTronHopNhua searchData = new PhanLoaiCTronHopNhua
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = Input.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien,
                ThongTinCauTaoCongTron_CDayPhuBi = Input.ThongTinCauTaoCongTron_CDayPhuBi,
                TTKTHHCongHopRanh_CauTaoTuong = Input.TTKTHHCongHopRanh_CauTaoTuong,
                TTKTHHCongHopRanh_ChatMatTrong = Input.TTKTHHCongHopRanh_ChatMatTrong,
                TTKTHHCongHopRanh_ChatMatNgoai = Input.TTKTHHCongHopRanh_ChatMatNgoai,
                TTKTHHCongHopRanh_CCaoDe = Input.TTKTHHCongHopRanh_CCaoDe,
                TTKTHHCongHopRanh_CRongDe = Input.TTKTHHCongHopRanh_CRongDe,
                TTKTHHCongHopRanh_CDayTuong01Ben = Input.TTKTHHCongHopRanh_CDayTuong01Ben,
                TTKTHHCongHopRanh_SoLuongTuong = Input.TTKTHHCongHopRanh_SoLuongTuong,
                TTKTHHCongHopRanh_CRongLongSuDung = Input.TTKTHHCongHopRanh_CRongLongSuDung,
                TTKTHHCongHopRanh_CCaoTuongGop = Input.TTKTHHCongHopRanh_CCaoTuongGop,
                TTKTHHCongHopRanh_CCaoMuMoThotDuoi = Input.TTKTHHCongHopRanh_CCaoMuMoThotDuoi,
                TTKTHHCongHopRanh_CRongMuMoDuoi = Input.TTKTHHCongHopRanh_CRongMuMoDuoi,
                TTKTHHCongHopRanh_CCaoMuMoThotTren = Input.TTKTHHCongHopRanh_CCaoMuMoThotTren,
                TTKTHHCongHopRanh_CRongMuMoTren = Input.TTKTHHCongHopRanh_CRongMuMoTren,
                TTKTHHCongHopRanh_CCaoChatMatTrong = Input.TTKTHHCongHopRanh_CCaoChatMatTrong,
                ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = Input.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi,

            };
        var id = "";
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiCTronHopNhuaRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_HinhThucTruyenDan), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan));

        }
        return id;
    }

    //Load tên theo phân loại móng cống tròn
    public async Task<PhanLoai> LoadTenPLCTronHopNhua(NuocMua Input)
    {
        PhanLoaiCTronHopNhua searchData = new PhanLoaiCTronHopNhua
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien = Input.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien,
                ThongTinCauTaoCongTron_CDayPhuBi = Input.ThongTinCauTaoCongTron_CDayPhuBi,
                TTKTHHCongHopRanh_CauTaoTuong = Input.TTKTHHCongHopRanh_CauTaoTuong,
                TTKTHHCongHopRanh_ChatMatTrong = Input.TTKTHHCongHopRanh_ChatMatTrong,
                TTKTHHCongHopRanh_ChatMatNgoai = Input.TTKTHHCongHopRanh_ChatMatNgoai,
                TTKTHHCongHopRanh_CCaoDe = Input.TTKTHHCongHopRanh_CCaoDe,
                TTKTHHCongHopRanh_CRongDe = Input.TTKTHHCongHopRanh_CRongDe,
                TTKTHHCongHopRanh_CDayTuong01Ben = Input.TTKTHHCongHopRanh_CDayTuong01Ben,
                TTKTHHCongHopRanh_SoLuongTuong = Input.TTKTHHCongHopRanh_SoLuongTuong,
                TTKTHHCongHopRanh_CRongLongSuDung = Input.TTKTHHCongHopRanh_CRongLongSuDung,
                TTKTHHCongHopRanh_CCaoTuongGop = Input.TTKTHHCongHopRanh_CCaoTuongGop,
                TTKTHHCongHopRanh_CCaoMuMoThotDuoi = Input.TTKTHHCongHopRanh_CCaoMuMoThotDuoi,
                TTKTHHCongHopRanh_CRongMuMoDuoi = Input.TTKTHHCongHopRanh_CRongMuMoDuoi,
                TTKTHHCongHopRanh_CCaoMuMoThotTren = Input.TTKTHHCongHopRanh_CCaoMuMoThotTren,
                TTKTHHCongHopRanh_CRongMuMoTren = Input.TTKTHHCongHopRanh_CRongMuMoTren,
                TTKTHHCongHopRanh_CCaoChatMatTrong = Input.TTKTHHCongHopRanh_CCaoChatMatTrong,
                ThongTinKichThuocHinhHocOngNhua_CDayPhuBi = Input.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi,

            };

        PhanLoaiCTronHopNhua plCTHNHoGa = new();
        phanloai = new();
        plCTHNHoGa = await PhanLoaiCTronHopNhuaRepository.GetPhanLoaiCTronHopNhuaByDetail(searchData);
        if (plCTHNHoGa != null)
        {
            phanloai.Name = plCTHNHoGa.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai;
            phanloai.Id = plCTHNHoGa.Id;
        }

        return phanloai;
    }

    //Thêm tên theo bảng phân loại cống hộp cống tròn nhựa
    public async Task<string> ThemTenTheoPLMongCTron(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiMongCTron searchData = new PhanLoaiMongCTron
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinMongDuongTruyenDan_LoaiMong = Input.ThongTinMongDuongTruyenDan_LoaiMong,
                ThongTinMongDuongTruyenDan_HinhThucMong = Input.ThongTinMongDuongTruyenDan_HinhThucMong,
                ThongTinCauTaoCongTron_CCaoLotMong = Input.ThongTinCauTaoCongTron_CCaoLotMong,
                ThongTinCauTaoCongTron_CRongLotMong = Input.ThongTinCauTaoCongTron_CRongLotMong,
                ThongTinCauTaoCongTron_CCaoMong = Input.ThongTinCauTaoCongTron_CCaoMong,
                ThongTinCauTaoCongTron_CRongMong = Input.ThongTinCauTaoCongTron_CRongMong,

            };
        var id = "";
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiMongCTronRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinMongDuongTruyenDan_LoaiMong), GetTenDanhMucById(searchData.ThongTinMongDuongTruyenDan_HinhThucMong), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan));

        }
        return id;
    }

    //Load tên theo phân loại móng cống tròn
    public async Task<PhanLoai> LoadTenPhanLoaiMongCTron(NuocMua Input)
    {
        PhanLoaiMongCTron searchData = new PhanLoaiMongCTron
            {
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinMongDuongTruyenDan_LoaiMong = Input.ThongTinMongDuongTruyenDan_LoaiMong,
                ThongTinMongDuongTruyenDan_HinhThucMong = Input.ThongTinMongDuongTruyenDan_HinhThucMong,
                ThongTinCauTaoCongTron_CCaoLotMong = Input.ThongTinCauTaoCongTron_CCaoLotMong,
                ThongTinCauTaoCongTron_CRongLotMong = Input.ThongTinCauTaoCongTron_CRongLotMong,
                ThongTinCauTaoCongTron_CCaoMong = Input.ThongTinCauTaoCongTron_CCaoMong,
                ThongTinCauTaoCongTron_CRongMong = Input.ThongTinCauTaoCongTron_CRongMong,
            };

        PhanLoaiMongCTron plMCT = new();
        phanloai = new();
        plMCT = await PhanLoaiMongCTronRepository.GetPhanLoaiMongCTronByDetail(searchData);
        if (plMCT != null)
        {
            phanloai.Name = plMCT.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop;
            phanloai.Id = plMCT.Id;
        }
        return phanloai;

    }

    //Thêm tên theo bảng phân loại đế cống
    public async Task<string> ThemTenTheoPLDeCong(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiDeCong searchData = new PhanLoaiDeCong
            {
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinDeCong_CauTaoDeCong = Input.ThongTinDeCong_CauTaoDeCong,
                ThongTinDeCong_D = Input.ThongTinDeCong_D,
                ThongTinDeCong_R = Input.ThongTinDeCong_R,
                ThongTinDeCong_C = Input.ThongTinDeCong_C,
            };
        CheckObjHelper checkObjhelper = new();
        var id = "";
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiDeCongRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDeCong_CauTaoDeCong ?? ""), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan??""));

        }
        return id;
    }

    //Load tên theo phân loại đế cống
    public async Task<PhanLoai> LoadTenPhanLoaiDeCong(NuocMua Input)
    {
        PhanLoaiDeCong searchData = new PhanLoaiDeCong
            {
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                ThongTinDeCong_CauTaoDeCong = Input.ThongTinDeCong_CauTaoDeCong,
                ThongTinDeCong_D = Input.ThongTinDeCong_D,
                ThongTinDeCong_R = Input.ThongTinDeCong_R,
                ThongTinDeCong_C = Input.ThongTinDeCong_C,
            };

        PhanLoaiDeCong plDC = new();
        phanloai = new();
        plDC = await PhanLoaiDeCongRepository.GetPhanLoaiDeCongByDetail(searchData);
        if (plDC != null)
        {
            phanloai.Name = plDC.ThongTinDeCong_TenLoaiDeCong;
            phanloai.Id = plDC.Id;
        }
        return phanloai;
    }

    //Thêm tên theo bảng phân loại thanh chống
    public async Task<string> ThemTenTheoPLThanhChong(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiThanhChong searchData = new PhanLoaiThanhChong
            {
                TTKTHHCongHopRanh_CauTaoThanhChong = Input.TTKTHHCongHopRanh_CauTaoThanhChong,
                TTKTHHCongHopRanh_CCaoThanhChong = Input.TTKTHHCongHopRanh_CCaoThanhChong,
                TTKTHHCongHopRanh_CRongThanhChong = Input.TTKTHHCongHopRanh_CRongThanhChong,
                TTKTHHCongHopRanh_CDai = Input.TTKTHHCongHopRanh_CDai,
            };
        var id = "";
        CheckObjHelper checkObjhelper = new();
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            id = await PhanLoaiThanhChongRepository.InsertId(searchData, GetTenDanhMucById(searchData.TTKTHHCongHopRanh_CauTaoThanhChong));

        }
        return id;
    }

    //Load tên theo phân loại thanh chống
    public async Task<PhanLoai> LoadTenPhanLoaiThanhChong(NuocMua Input)
    {
        PhanLoaiThanhChong searchData = new PhanLoaiThanhChong
            {
                TTKTHHCongHopRanh_CauTaoThanhChong = Input.TTKTHHCongHopRanh_CauTaoThanhChong,
                TTKTHHCongHopRanh_CCaoThanhChong = Input.TTKTHHCongHopRanh_CCaoThanhChong,
                TTKTHHCongHopRanh_CRongThanhChong = Input.TTKTHHCongHopRanh_CRongThanhChong,
                TTKTHHCongHopRanh_CDai = Input.TTKTHHCongHopRanh_CDai,
            };

        PhanLoaiThanhChong plTC = new();
        phanloai = new();
        plTC = await PhanLoaiThanhChongRepository.GetPhanLoaiThanhChongByDetail(searchData);
        if (plTC != null)
        {

            phanloai.Name = plTC.TTKTHHCongHopRanh_LoaiThanhChong;
            phanloai.Id = plTC.Id;

        }
        return phanloai;
    }

    //Thêm tên theo bảng phân loại tấm đan tryền dẫn
    public async Task<string> ThemTenTheoPLTDanTDan(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao,
            };
        CheckObjHelper checkObjhelper = new();
        var id = "";
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            if (searchData.TTTDCongHoRanh_CDai > 0 || searchData.TTTDCongHoRanh_CRong > 0 || searchData.TTTDCongHoRanh_CCao > 0)
            {
                id = await PhanLoaiTDanTDanRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_HinhThucTruyenDan), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan), GetTenDanhMucById(searchData.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan));
            }
        }
        return id;
    }

    public async Task<string> ThemTenTheoPLTDanTDan02(NuocMua Input, List<DanhMuc> listDanhMuc)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai1,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong1,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao1,
            };
        CheckObjHelper checkObjhelper = new();
        var id = "";
        if (checkObjhelper.AreAllDoublePropertiesGreaterThanZero(searchData))
        {
            if (searchData.TTTDCongHoRanh_CDai > 0 || searchData.TTTDCongHoRanh_CRong > 0 || searchData.TTTDCongHoRanh_CCao > 0)
            {
                id = await PhanLoaiTDanTDanRepository.InsertId(searchData, GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_HinhThucTruyenDan), GetTenDanhMucById(searchData.ThongTinDuongTruyenDan_LoaiTruyenDan), GetTenDanhMucById(searchData.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan));
            }
        }
        return id;
    }

    //Load tên theo phân loại tấm đan truyền dẫn
    public async Task<PhanLoai> LoadTenPhanLoaiTDanTDan(NuocMua Input)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao,
            };


        PhanLoaiTDanTDan plTDTD = new();
        phanloai = new();
        plTDTD = await PhanLoaiTDanTDanRepository.GetPhanLoaiTDanTDanByDetail(searchData);
        if (plTDTD != null)
        {
            phanloai.Name = plTDTD.TTTDCongHoRanh_TenLoaiTamDanTieuChuan;
            phanloai.Id = plTDTD.Id;
        }
        return phanloai;

    }
    //Load tên theo phân loại tấm đan truyền dẫn 02
    public async Task<PhanLoai> LoadTenPhanLoaiTDanTDan02(NuocMua Input)
    {
        PhanLoaiTDanTDan searchData = new PhanLoaiTDanTDan
            {
                ThongTinLyTrinhTruyenDan_TuLyTrinh = Input.ThongTinLyTrinhTruyenDan_TuLyTrinh,
                ThongTinLyTrinhTruyenDan_DenLyTrinh = Input.ThongTinLyTrinhTruyenDan_DenLyTrinh,
                ThongTinDuongTruyenDan_HinhThucTruyenDan = Input.ThongTinDuongTruyenDan_HinhThucTruyenDan,
                ThongTinDuongTruyenDan_LoaiTruyenDan = Input.ThongTinDuongTruyenDan_LoaiTruyenDan,
                TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan = Input.TTTDCongHoRanh_CauTaoTamDanTruyenDan,
                TTTDCongHoRanh_CDai = Input.TTTDCongHoRanh_CDai1,
                TTTDCongHoRanh_CRong = Input.TTTDCongHoRanh_CRong1,
                TTTDCongHoRanh_CCao = Input.TTTDCongHoRanh_CCao1,
            };


        PhanLoaiTDanTDan plTDTD = new();
        phanloai = new();
        plTDTD = await PhanLoaiTDanTDanRepository.GetPhanLoaiTDanTDanByDetail(searchData);
        if (plTDTD != null)
        {
            phanloai.Name = plTDTD.TTTDCongHoRanh_TenLoaiTamDanTieuChuan;
            phanloai.Id = plTDTD.Id;
        }
        return phanloai;

    }
}
