@page "/NghiepVuCongtrinh/listThoatNuocMua"
@using DucAnhERP.ViewModel
@using DucAnhERP.Models
@using DucAnhERP.Components.Pages.Common
@using System.Linq
@using DucAnhERP.SeedWork
@using Microsoft.AspNetCore.Authorization
@inject NavigationManager navigation
@inject IHopRanhThangRepository HopRanhThangRepository
@inject IDanhMucRepository DanhMucRepository
@attribute [Authorize]

<style>
    table {
        position: relative;
    }

        table thead tr td {
            /*   white-space: nowrap; */
            text-align: center;
            padding: 2px 5px;
        }
</style>
<div class="container-fluid">
    <div>
        <div class="card-header mt-3">
            <h5>BẢNG TỔNG HỢP THÔNG TIN HỆ THỐNG THOÁT NƯỚC MƯA DỌC PHÍA TRÁI TUYẾN</h5>
        </div>
        <div class="our-table">
            @if (!listHopRanhThang.Any())
            {
                <div class="pt-3 pl-4">
                    <div class="callout callout-warning">
                        <h5>Không có dữ liệu tương ứng!</h5>
                    </div>
                </div>
            }
            <table class="table-bordered " cellpadding="0" cellspacing="0">
                <thead>
                    <tr class="nowrap">
                        <td rowspan="3">STT</td>
                        <td colspan="2" rowspan="2">Thông tin lý trình</td>
                        <td colspan="9" rowspan="2">Thông tin chung hố ga</td>
                        <td colspan="34">Thông tin kích thước hình học hố ga</td>
                        <td colspan="32">Hạng mục chiếm chỗ hố ga</td>
                        <td colspan="8">Thông tin tấm đan hố ga</td>
                        <td colspan="4" rowspan="2">Thông tin vật liệu đào hố ga</td>
                        <td colspan="18" rowspan="2">Thông tin cao độ hố ga</td>
                        <td colspan="10" rowspan="2"> Thông tin chiều cao C.Chỗ đắp trả hố thu</td>
                        <td colspan="4" rowspan="2">Thông tin mái đào</td>
                        <td colspan="17">Thông tin khối lượng đào</td>
                        <td colspan="2" rowspan="2">Tọa độ</td>
                        <td colspan="4" rowspan="2">Thông tin lý trình truyền dẫn</td>
                        <td colspan="3" rowspan="2">Thông tin đường truyền dẫn</td>
                        <td colspan="11" rowspan="2">Thông tin chiều dài và số lượng cấu kiện đường truyền dẫn</td>
                        <td colspan="3" rowspan="2">Thông tin móng đường truyền dẫn</td>
                        <td colspan="9">Thông tin đế cống</td>
                        <td colspan="10" rowspan="2">Thông tin cấu tạo cống tròn</td>
                        <td colspan="29">Thông tin kích thước hình học cống hộp, rãnh</td>
                        <td colspan="6" rowspan="2">Thông tin kích thước hình học ống nhựa</td>
                        <td colspan="30">Thông tin rãnh thang</td>
                        <td colspan="19">Thông tin tấm đan cống hộp, rãnh</td>
                        <td colspan="39">Cao độ thượng lưu</td>
                        <td colspan="39">Cao độ hạ lưu</td>
                        <td colspan="7">Thông tin vật liệu đào cống, rãnh</td>
                        <td colspan="24">Thông tin C.Cao C.Chỗ cống tròn</td>
                        <td colspan="18">Thông tin C.Cao C.Chỗ cống hộp, rãnh</td>
                        <td colspan="18">Thông tin C.Cao C.Chỗ ống nhựa</td>
                        <td colspan="12"> Thông tin chiếm chỗ rãnh thang (m)</td>
                        <td colspan="8">Thông tin mái đào</td>
                        <td colspan="4">D.Tích đào thượng lưu cống, rãnh, ống nhựa, rãnh thang</td>
                        <td colspan="4">D.Tích đào hạ lưu cống, rãnh, ống nhựa, rãnh thang</td>
                        <td colspan="4">D.Tích đào chân khay, giằng đỉnh</td>
                        <td colspan="38">Thông tin khối lượng đào</td>
                        <td colspan="6"> D.Tích đắp cát</td>
                        <td colspan="3" rowspan="2"> Thông tin KL đắp cát</td>
                        <td colspan="4"> Tọa độ</td>
                    </tr>
                    <tr>
                        <td colspan="2">Thông tin phủ bì hố ga (m)</td>
                        <td colspan="3">Kích thước hình học bê tông lót móng hố ga (m)</td>
                        <td colspan="3">Kích thước hình học bê tông móng hố ga (m)</td>
                        <td colspan="3">KTHH đế hố ga</td>
                        <td colspan="4">Kích thước hình học tường hố ga (m)</td>
                        <td colspan="5">KTHH dầm giữa hố ga</td>
                        <td colspan="3">Chất hố ga mặt trong</td>
                        <td colspan="3">Chất hố ga mặt ngoài, cạnh 01 +02 (m)</td>
                        <td colspan="4">Kích thước hình học tường mũ mố thép dưới (m)</td>
                        <td colspan="4">Kích thước hình học tường mũ mố thép trên (m)</td>

                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>
                        <td colspan="4">Hình thức đấu nối</td>

                        <td rowspan="2">Phân loại đậy hố ga</td>
                        <td rowspan="2">Hình thức đậy hố ga</td>
                        <td colspan="2">Loại tròn</td>
                        <td colspan="4">Loại vuông hoặc chữ nhật</td>

                        <td colspan="5">Diện tích đào hố ga</td>
                        <td colspan="12">Thông tin KL đào hố ga</td>

                        <td rowspan="2">Tên loại đế cống</td>
                        <td rowspan="2">Cấu tạo đế cống</td>
                        <td colspan="3">KTHH đế cống</td>
                        <td colspan="4">Khối lượng đế cống</td>

                        <td colspan="4">Thông tin chung</td>
                        <td colspan="2">Lót móng</td>
                        <td colspan="2">Móng</td>
                        <td colspan="2">Đế</td>
                        <td colspan="6">Thân</td>
                        <td colspan="4">Mũ mố</td>
                        <td colspan="6">Thanh chống</td>
                        <td colspan="2">Chát</td>
                        <td rowspan="2" class="text-danger">Tổng chiều cao (m)</td>

                        <td rowspan="2">Hình thức mái</td>
                        <td rowspan="2">Cấu tạo chân khay</td>
                        <td rowspan="2">Cấu tạo giằng đỉnh</td>
                        <td rowspan="2">Hình thức hành lang bảo vệ</td>

                        <td colspan="11">Thông tin móng</td>
                        <td colspan="4">Thông tin mái</td>
                        <td colspan="7">Thông tin giằng đỉnh </td>
                        <td colspan="4">Thông tin hành lang bảo vệ </td>

                        <td colspan="6">Thông tin tấm đan tiêu chuẩn</td>
                        <td colspan="6">Thông tin tấm đan loại 02</td>
                        <td colspan="7">Thông tin tính tấm đan bổ sung</td>

                        <td rowspan="2">Hiện trạng trước khi đào thượng lưu (m)</td>
                        <td colspan="9">Đáy đào thượng lưu</td>
                        <td colspan="8">Đỉnh lót thượng lưu</td>
                        <td colspan="8">Đỉnh móng thượng lưu</td>
                        <td colspan="4">Mũ tường, tường thượng lưu</td>
                        <td colspan="9">Đỉnh hoàn thiện thượng lưu</td>

                        <td rowspan="2">Hiện trạng trước khi đào thượng lưu (m)</td>
                        <td colspan="9">Đáy đào hạ lưu</td>
                        <td colspan="8">Đỉnh lót hạ lưu</td>
                        <td colspan="8">Đỉnh móng hạ lưu</td>
                        <td colspan="4">Mũ tường, tường hạ lưu</td>
                        <td colspan="9">Đỉnh hoàn thiện hạ lưu</td>

                        <td rowspan="2">Loại vật liệu đào</td>
                        <td colspan="3">Thượng lưu</td>
                        <td colspan="3">Hạ lưu</td>

                        <td colspan="3">Lót C.Chỗ đất</td>
                        <td colspan="3">Lót C.Chỗ đá</td>
                        <td colspan="3">móng C.Chỗ đất</td>
                        <td colspan="3">móng C.Chỗ đá</td>
                        <td colspan="3">Đế C.Chỗ đất</td>
                        <td colspan="3">Đế C.Chỗ đá</td>
                        <td colspan="3">Đỉnh cống C.Chỗ đất</td>
                        <td colspan="3">Đỉnh cống C.Chỗ đá</td>

                        <td colspan="3">C.Cao lót C.Chỗ đất	</td>
                        <td colspan="3">C.Cao lót C.Chỗ đá</td>
                        <td colspan="3">C.Cao móng C.Chỗ đất</td>
                        <td colspan="3">C.Cao móng C.Chỗ đá	</td>
                        <td colspan="3">C.Cao tường C.Chỗ đất</td>
                        <td colspan="3">C.Cao tường C.Chỗ đá</td>

                        <td colspan="3">C.Cao đệm cát C.Chỗ đất	</td>
                        <td colspan="3">C.Cao đệm cát C.Chỗ đá</td>
                        <td colspan="3">C.Cao ống C.Chỗ đất</td>
                        <td colspan="3">C.Cao ống C.Chỗ đá	</td>
                        <td colspan="3">C.Cao đắp cát C.Chỗ đất</td>
                        <td colspan="3">C.Cao đắp cát C.Chỗ đá</td>

                        <td colspan="3">C.Cao C.Chỗ đất đắp trả</td>
                        <td colspan="3">C.Cao C.Chỗ đá đắp trả</td>
                        <td colspan="3">C.Cao C.Chỗ đất đắp trả</td>
                        <td colspan="3">C.Cao C.Chỗ đá đắp trả</td>

                        <td colspan="4"> Thông tin mái đào cống, rãnh, ống nhựa, rãnh thang</td>
                        <td colspan="4">Thông tin mái đào chân khay, giằng đỉnh rãnh thang</td>


                        <td colspan="2">Đào đất</td>
                        <td colspan="2">Đào đá</td>
                        <td colspan="2">Đào đất</td>
                        <td colspan="2">Đào đá</td>
                        <td colspan="2">Chân khay</td>
                        <td colspan="2">C.Rộng đào đáy lớn (m)</td>


                        <td colspan="3"> KL đào cống, rãnh, ống nhựa, rãnh thang</td>
                        <td colspan="3">Kl đào đất chân khay + giằng đỉnh rãnh thang</td>
                        <td colspan="3">Tổng KL đào</td>
                        <td colspan="3">KL C.Chỗ C.Tròn</td>
                        <td colspan="3">KL C.Chỗ C.hộp</td>
                        <td colspan="3">KL C.Chỗ rãnh xây + bê tông</td>
                        <td colspan="3">KL C.Chỗ ống nhựa</td>
                        <td colspan="8">KL C.Chỗ rãnh thang</td>
                        <td colspan="3">Tổng KL chiếm chỗ</td>
                        <td colspan="3">Kl đắp trả	</td>
                        <td colspan="3">KL thừa</td>

                        <td colspan="3">Thượng lưu</td>
                        <td colspan="3">Hạ lưu</td>

                        <td colspan="2">Từ tọa độ</td>
                        <td colspan="2">Đến tọa độ	</td>

                    </tr>
                    <tr>
                        <td>Tuyến đường</td>
                        <td>Lộ trình tại tim hố ga</td>

                        <td>Tên hố ga sau phân loại</td>
                        <td>Tên hố ga theo bản vẽ</td>
                        <td>Hình thức hố ga</td>
                        <td>Kết cấu mũ mố</td>
                        <td>Kết cấu tường</td>
                        <td>Hình thức móng hố ga</td>
                        <td>Kết cấu móng</td>
                        <td>Chất mặt trong</td>
                        <td>Chất mặt ngoài</td>

                        @* Thông tin kích thước hình học hố ga *@
                        <td>C.D dài (m)</td>
                        <td>C.rộng (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td>C (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td>C (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td>C (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td class="text-danger">C (m)</td>
                        <td>CD tường (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td>C (m)</td>
                        <td>CD dầm (m)</td>
                        <td>C.Cao dầm giữa tường so với đáy hố ga (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td class="text-danger">C (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td class="text-danger">C (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td>C (m)</td>
                        <td>CD tường (m)</td>

                        <td>D (m)</td>
                        <td>R (m)</td>
                        <td>C (m)</td>
                        <td>CD tường (m)</td>

                        @* Hạng mục chiếm chỗ hố ga *@
                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        <td>Loại</td>
                        <td>Cạnh dài</td>
                        <td>Cạnh rộng</td>
                        <td>Cạnh chéo</td>

                        @* Thông tin tấm đan hố ga *@
                        <td>Đường kính (m) </td>
                        <td>Chiều dầy (m)</td>

                        <td>D (m) </td>
                        <td>R (m) </td>
                        <td>C (m)</td>
                        <td>Số lượng nắp đậy (C.Kiện)</td>

                        @* Thông tin vật liệu đào hố ga *@

                        <td> Loại vật liệu đào</td>
                        <td>Chiều cao đào đá (m) </td>
                        <td class="text-danger">Chiều cao đào đất (m)</td>
                        <td class="text-danger">Tổng chiều cao đào</td>

                        @*Thông tin cao độ hố ga *@
                        <td>Cao độ tự nhiên (m)</td>
                        <td>CĐ đỉnh vỉa hè hoàn thiện (m)</td>
                        <td>Cao độ đỉnh K98 (m)</td>
                        <td class="text-danger">Cao độ hiện trạng trước khi đào (m)</td>
                        <td class="text-danger">Đáy đào (m)</td>
                        <td class="text-danger">C.Sâu đào (m)</td>
                        <td class="text-danger">Đỉnh lót móng (m)</td>
                        <td class="text-danger">CĐ đỉnh móng</td>
                        <td>CĐ đáy hố ga (m)</td>
                        <td class="text-danger">C.Cao tường (m)</td>
                        <td class="text-danger">Đỉnh tường dưới dầm giữa tường (m)</td>
                        <td class="text-danger">Đỉnh dầm giữa tường (m)</td>
                        <td class="text-danger">Đỉnh tường (m)</td>
                        <td class="text-danger">Đỉnh mũ mố thớt dưới (m)</td>
                        <td>CĐ đỉnh hố ga (m)</td>
                        <td class="text-danger">Tổng chiều cao hố ga</td>
                        <td class="text-danger">Chênh cao đỉnh hố ga và hiện trạng đào (m)</td>
                        <td class="text-danger">Tổng chiều cao chiếm chỗ đắp trả</td>

                        @* Thông tin chiều cao C.Chỗ đắp trả hố thu *@
                        <td class="text-danger">Chiều cao lót C.Chỗ đất (m)</td>
                        <td class="text-danger">Chiều cao móng C.Chỗ đất (m)</td>
                        <td class="text-danger">Chiều cao tường C.Chỗ đất (m)</td>
                        <td class="text-danger">Chiều cao lót C.Chỗ đá (m)</td>
                        <td class="text-danger">Chiều cao móng C.Chỗ đá (m)</td>
                        <td class="text-danger">Chiều cao tường C.Chỗ đá (m)</td>
                        <td class="text-danger">Tổng C.Cao C.Chỗ đất</td>
                        <td class="text-danger">Tổng C.Cao C.Chỗ đá</td>
                        <td class="text-danger">Chênh đất so với thiết kế</td>
                        <td class="text-danger">Chênh đá so với thiết kế</td>

                        @* Thông tin mái đào *@
                        <td>Chiều rộng đáy đào nhỏ (m)</td>
                        <td>Tỷ lệ mở mái (m)</td>
                        <td>Số cạnh mái trái</td>
                        <td>Số cạnh mái phải</td>

                        @* Thông tin khối lượng đào *@
                        <td class="text-danger">C.Rộng đào đáy lớn đất (m)</td>
                        <td class="text-danger">C.Rộng đào đáy lớn đá (m)</td>
                        <td class="text-danger">Diện tích đào đất (m2)</td>
                        <td class="text-danger">Diện tích đào đá (m2)</td>
                        <td class="text-danger">Tổng DT đào (m2)</td>
                        <td class="text-danger">KL đào đất (m3)</td>
                        <td class="text-danger">KL đào đá (m3)</td>
                        <td class="text-danger">Tổng KL đào (m3)</td>
                        <td class="text-danger">KL chiếm chỗ đất (m3)</td>
                        <td class="text-danger">KL chiếm chỗ đá (m3)</td>
                        <td class="text-danger">Tổng chiếm chỗ (m3)</td>
                        <td class="text-danger">KL đắp trả đất (m3)</td>
                        <td class="text-danger">KL đắp trả đá (m3)</td>
                        <td class="text-danger">Tổng đắp trả (m3)</td>
                        <td class="text-danger">KL thừa đất (m3)</td>
                        <td class="text-danger">KL thừa đá (m3)</td>
                        <td class="text-danger">Tổng thừa (m3)</td>

                        @* Tọa độ *@
                        <td>X</td>
                        <td>Y</td>

                        @* Thông tin lý trình truyền dẫn *@
                        <td>Từ lý trình</td>
                        <td>Đến lý trình</td>
                        <td>Từ hố ga</td>
                        <td>Đến hố ga</td>
                        @* Thông tin đường truyền dẫn *@
                        <td>Hình thức truyền dẫn</td>
                        <td>Loại truyền dẫn</td>
                        <td>Tên loại truyền dẫn sau phân loại</td>
                        @* Thông tin chiều dài và số lượng cấu kiện đường truyền dẫn *@
                        <td>Chiều dài 01 cấu kiện (m)</td>
                        <td>Chiều dài mối nối C.Kiện (m)</td>
                        <td>Số lượng C.Kiện dùng để tính chiều dài bổ sung (C.Kiện)</td>
                        <td>Tổng chiều dài (m)</td>
                        <td class="text-danger">SL cấu kiện tính KL</td>
                        <td class="text-danger">SL cấu kiện nguyên</td>
                        <td class="text-danger">Chiều dài cần để lắp đặt được theo số cấu kiện nguyên (m)</td>
                        <td class="text-danger">Tổng chiều dài lắp đặt theo số cấu kiện nguyên (m)</td>
                        <td class="text-danger">Chiều dài thực tế còn thừa (+)/thiếu (-) so với C.Rộng lòng mũ mố hố ga (m)</td>
                        <td class="text-danger">Xác định ống cống cần thêm</td>
                        <td class="text-danger">Chiều dài còn thừa (+)/thiếu (-) sau tính theo cấu kiện tính KL (m)</td>
                        @* Thông tin móng đường truyền dẫn *@
                        <td>Phân loại móng cống tròn, cống hộp</td>
                        <td>Loại móng</td>
                        <td>Hình thức móng</td>

                        @* Thông tin đế cống *@
                        <td>D</td>
                        <td>R</td>
                        <td>C</td>
                        <td>SL đế cống/01 cấu kiện truyền dẫn (C.Kiện)</td>
                        <td>KL 01 đế cống</td>
                        <td class="text-danger">Tổng số lượng đế cống</td>
                        <td class="text-danger">Tổng KL đế cống</td>

                        @* Thông tin cấu tạo cống tròn *@
                        <td>C.Dầy phủ bì (m)</td>
                        <td>Số cạnh</td>
                        <td>Lòng sử dụng (m)</td>
                        <td class="text-danger">C.Cao cấu kiện</td>
                        <td>C.Cao lót móng (m)</td>
                        <td>C.Rộng lót móng</td>
                        <td>C.Cao móng (m)</td>
                        <td>C.Rộng móng (m)</td>
                        <td>C.Cao đế (tại vị trí đặt C.Kiện) (m)</td>
                        <td class="text-danger">Tổng C.Cao cống (m)</td>

                        @* Thông tin kích thước hình học cống hộp, rãnh *@
                        <td>Cấu tạo tường</td>
                        <td>Cấu tạo mũ mố</td>
                        <td>Chát mặt trong</td>
                        <td>Chát mặt ngoài</td>
                        <td>C.Cao lót móng (m)</td>
                        <td>C.Rộng lót móng (m)</td>
                        <td>C.Cao móng (m)</td>
                        <td>C.Rộng móng (m)</td>
                        <td>C.Cao đế (m)</td>
                        <td>C.Rộng đế (m)</td>
                        <td>C.Dầy tường 01 bên (m)</td>
                        <td>Số lượng tường (m)</td>
                        <td>C.Rộng lòng sử dụng (m)</td>
                        <td>C.Cao tường cống hộp (m)</td>
                        <td class="text-danger">C.Cao tường rãnh</td>
                        <td class="text-danger">C.Cao tường gộp</td>
                        <td>C.Cao mũ mố thớt dưới (m)</td>
                        <td>C.Rộng mũ mố dưới</td>
                        <td>C.Cao mũ mố thớt trên (m)</td>
                        <td>C.Rộng mũ mố trên</td>
                        <td>Loại thanh chống</td>
                        <td>Cấu tạo thanh chống</td>
                        <td>C.Cao thanh chống (m)</td>
                        <td>C.Rộng thanh chống (m)</td>
                        <td>C.Dài (m)</td>
                        <td>Số lượng thanh chống (cái)</td>
                        <td class="text-danger">C.Cao chát mặt trong (m)</td>
                        <td class="text-danger">C.Cao chát mặt ngoài (m)</td>

                        @* Thông tin kích thước hình học ống nhựa *@
                        <td>C.Dầy phủ bì (m)</td>
                        <td>Số cạnh</td>
                        <td>Lòng sử dụng (m)</td>
                        <td class="text-danger">Tổng C.Cao ống (m)</td>
                        <td>C.Cao đệm cát (m)</td>
                        <td>C.Cao đắp cát (m)</td>

                        @* Thông tin rãnh thang *@
                        <td>Phân loại chân khay</td>
                        <td>C.Cao lót chân khay (m)</td>
                        <td>C.Rộng lót chân khay (m)</td>
                        <td>Số lượng lót chân khay</td>
                        <td>C.Cao móng chân khay (m)</td>
                        <td>C.Rộng móng chân khay (m)</td>
                        <td>Số lượng móng chân khay</td>
                        <td>C.Cao lót (m)</td>
                        <td>C.Rộng lót (m)</td>
                        <td>C.Cao móng (m)</td>
                        <td>C.Rộng móng (m)</td>
                        <td>Phân loại mái</td>
                        <td>C.Rộng mái (m)</td>
                        <td>C.Dầy mái (m)</td>
                        <td>Số lượng mái (m)</td>
                        <td>Phân loại giằng đỉnh</td>
                        <td>C.Cao lót giằng đỉnh (m)</td>
                        <td>C.Rộng lót giằng đỉnh (m)</td>
                        <td>Số lượng lót giằng đỉnh</td>
                        <td>C.Cao móng giằng đỉnh (m)</td>
                        <td>C.Rộng móng giằng đỉnh (m)</td>
                        <td>Số lượng móng giằng đỉnh</td>
                        <td>Phân loại hành lang bảo vệ</td>
                        <td>C.Cao hàng lang bảo vệ</td>
                        <td>C.Rộng hành lang bảo vệ</td>
                        <td>Số lượng hàng lang bảo vệ</td>

                        @* Thông tin tấm đan cống hộp, rãnh *@
                        <td>Tên loại tấm đan tiêu chuẩn</td>
                        <td>Cấu tạo tấm đan truyền dẫn tấm đan tiêu chuẩn</td>
                        <td class="text-danger">Số lượng</td>
                        <td>C.Dài</td>
                        <td>C.Rộng</td>
                        <td>C.Cao</td>
                        <td>Tên loại tấm đan loại 02</td>
                        <td>Cấu tạo tấm đan truyền dẫn</td>
                        <td class="text-danger">Số lượng</td>
                        <td class="text-danger">C.Dài</td>
                        <td>C.Rộng</td>
                        <td>C.Cao</td>
                        <td>Chiều dài mối nối (m)</td>
                        <td>Số lượng T.Đan dùng để tính chiều dài bổ sung (C.Kiện)</td>
                        <td class="text-danger">SL cấu kiện nguyên</td>
                        <td class="text-danger">Chiều dài cần để lắp đặt được theo số CK nguyên (m)</td>
                        <td class="text-danger">Tổng chiều dài lắp đặt theo số CK nguyên (m)</td>
                        <td class="text-danger">Chiều dài thực tế còn thừa (+)/thiếu (-) so với C.Rộng lòng mũ mố hố ga (m)</td>
                        <td class="text-danger">Xác định ống cống cần thêm</td>

                        @* Cao độ thượng lưu *@
                        <td class="text-danger">Đáy đào gộp (C.Tròn, C.Hộp, Rãnh, Ô.Nhựa, rãnh thang)</td>
                        <td class="text-danger">Chiều sâu đào</td>
                        <td class="text-danger">Đáy đào cống tròn (m)</td>
                        <td class="text-danger">Đáy đào cống hộp (m)</td>
                        <td class="text-danger">Đáy đào rãnh (m)</td>
                        <td class="text-danger">Đáy đào ống nhựa (m)</td>
                        <td class="text-danger">Đáy đào giằng đỉnh rãnh thang (m)</td>
                        <td class="text-danger">Đáy đào chân khay rãnh thang (m)</td>
                        <td class="text-danger">Đáy đào rãnh thang (m)</td>
                        <td class="text-danger">Đỉnh lót gộp (C.Tròn, C.Hộp, Rãnh, ống nhựa, rãnh thang)</td>
                        <td class="text-danger">Đỉnh lót rãnh thang</td>
                        <td class="text-danger">Đỉnh lót chân khay rãnh thang</td>
                        <td class="text-danger">Đỉnh lót giằng đỉnh rãnh thang</td>
                        <td class="text-danger">Đỉnh lót ống nhựa</td>
                        <td class="text-danger">Đỉnh lót cống tròn (m)</td>
                        <td class="text-danger">Đỉnh lót cống hộp (m)</td>
                        <td class="text-danger">Đỉnh lót rãnh (m)</td>
                        <td class="text-danger">Đỉnh móng gộp (C.Tròn, C.Hộp, Rãnh, rãnh thang)</td>
                        <td class="text-danger">Đỉnh móng rãnh thang (m)</td>
                        <td class="text-danger">Đỉnh móng chân khay (m)</td>
                        <td class="text-danger">Đỉnh móng cống tròn (m)</td>
                        <td class="text-danger">Đỉnh móng cống hộp (m)</td>
                        <td class="text-danger">Đỉnh móng rãnh (m)</td>
                        <td class="text-danger">Đỉnh đế cống (m)</td>
                        <td>Đáy dòng chảy (m)</td>
                        <td class="text-danger">C.Cao tường cống, rãnh (m)</td>
                        <td class="text-danger">Đỉnh tường C.Hộp, rãnh (m)</td>
                        <td class="text-danger">Đỉnh mũ mố thớt dưới cống hộp rãnh (m)</td>
                        <td class="text-danger">Đỉnh giằng đỉnh rãnh thang (m)</td>
                        <td class="text-danger">Đỉnh gộp (C.Tròn, C.Hộp, rãnh, Ô.Nhựa, Rãnh thang (m)</td>
                        <td>Đỉnh trong lòng sử dụng (m)</td>
                        <td class="text-danger">Đỉnh cống tròn (m)</td>
                        <td class="text-danger">Đỉnh cống hộp (m)</td>
                        <td class="text-danger">Đỉnh rãnh (m)</td>
                        <td class="text-danger">Đỉnh ống nhựa (m)</td>
                        <td class="text-danger">Đỉnh đắp cát (m)</td>
                        <td>Chiều cao rãnh thang từ đáy dòng chảy đến đỉnh (m)</td>
                        <td class="text-danger">Đỉnh rãnh thang (m)</td>

                        @* Cao độ hạ lưu *@
                        <td class="text-danger">Đáy đào gộp (C.Tròn, C.Hộp, Rãnh, Ô.Nhựa, rãnh thang)</td>
                        <td class="text-danger">Chiều sâu đào</td>
                        <td class="text-danger">Đáy đào cống tròn (m)</td>
                        <td class="text-danger"> Đáy đào cống hộp (m)</td>
                        <td class="text-danger">Đáy đào rãnh (m)</td>
                        <td class="text-danger">Đáy đào ống nhựa (m)</td>
                        <td class="text-danger">Đáy đào giằng đỉnh rãnh thang (m)</td>
                        <td class="text-danger">Đáy đào chân khay rãnh thang (m)</td>
                        <td class="text-danger">Đáy đào rãnh thang (m)</td>
                        <td class="text-danger">Đỉnh lót gộp (C.Tròn, C.Hộp, Rãnh, ống nhựa, rãnh thang)</td>
                        <td class="text-danger">Đỉnh lót rãnh thang</td>
                        <td class="text-danger">Đỉnh lót chân khay rãnh thang</td>
                        <td class="text-danger">Đỉnh lót giằng đỉnh rãnh thang</td>
                        <td class="text-danger">Đỉnh lót ống nhựa</td>
                        <td class="text-danger">Đỉnh lót cống tròn (m)</td>
                        <td class="text-danger">Đỉnh lót cống hộp (m)</td>
                        <td class="text-danger">Đỉnh lót rãnh (m)</td>
                        <td class="text-danger">Đỉnh móng gộp (C.Tròn, C.Hộp, Rãnh, rãnh thang)</td>
                        <td class="text-danger">Đỉnh móng rãnh thang (m)</td>
                        <td class="text-danger">Đỉnh móng chân khay (m)</td>
                        <td class="text-danger">Đỉnh móng cống tròn (m)</td>
                        <td class="text-danger">Đỉnh móng cống hộp (m)</td>
                        <td class="text-danger">Đỉnh móng rãnh (m)</td>
                        <td class="text-danger">Đỉnh đế cống (m)</td>
                        <td>Đáy dòng chảy (m)</td>
                        <td class="text-danger">C.Cao tường cống, rãnh (m)</td>
                        <td class="text-danger">Đỉnh tường C.Hộp, rãnh (m)</td>
                        <td class="text-danger">Đỉnh mũ mố thớt dưới cống hộp rãnh (m)</td>
                        <td class="text-danger">Đỉnh giằng đỉnh rãnh thang (m)</td>
                        <td class="text-danger">Đỉnh gộp (C.Tròn, C.Hộp, rãnh, Ô.Nhựa, Rãnh thang (m)</td>
                        <td>Đỉnh trong lòng sử dụng (m)</td>
                        <td class="text-danger">Đỉnh cống tròn (m)</td>
                        <td class="text-danger">Đỉnh cống hộp (m)</td>
                        <td class="text-danger">Đỉnh rãnh (m)</td>
                        <td class="text-danger">Đỉnh ống nhựa (m)</td>
                        <td class="text-danger">Đỉnh đắp cát (m)</td>
                        <td>Chiều cao rãnh thang từ đáy dòng chảy đến đỉnh (m)</td>
                        <td class="text-danger">Đỉnh rãnh thang (m)</td>

                        @* Thông tin vật liệu đào cống, rãnh *@
                        <td>Chiều cao đào đá (m)</td>
                        <td class="text-danger">Chiều cao đào đất (m)</td>
                        <td class="text-danger">Tổng chiều sâu đào</td>
                        <td>Chiều cao đào đá (m)</td>
                        <td class="text-danger">Chiều cao đào đất (m)</td>
                        <td class="text-danger">Tổng chiều sâu đào</td>

                        @* Thông tin C.Cao C.Chỗ cống tròn *@
                        <td class="text-danger">C.Cao lót T.Lưu</td>
                        <td class="text-danger">C.Cao lót H.lưu</td>
                        <td class="text-danger">C.Cao lót móng T.Bình</td>
                        <td class="text-danger">C.Cao lót T.Lưu</td>
                        <td class="text-danger">C.Cao lót H.lưu</td>
                        <td class="text-danger">C.Cao lót móng T.Bình</td>
                        <td class="text-danger">C.Cao móng T.Lưu</td>
                        <td class="text-danger">C.Cao móng H.Lưu</td>
                        <td class="text-danger">C.Cao móng T.Bình</td>
                        <td class="text-danger">C.Cao móng T.Lưu</td>
                        <td class="text-danger">C.Cao móng H.Lưu</td>
                        <td class="text-danger">C.Cao móng T.Bình</td>
                        <td class="text-danger">C.Cao đế T.Lưu</td>
                        <td class="text-danger">C.Cao đế H.Lưu</td>
                        <td class="text-danger">C.Cao đế T.Bình</td>
                        <td class="text-danger">C.Cao đế T.Lưu</td>
                        <td class="text-danger">C.Cao đế H.Lưu</td>
                        <td class="text-danger">C.Cao đế T.Bình</td>
                        <td class="text-danger">C.Cao cống T.Lưu</td>
                        <td class="text-danger">C.Cao cống H.Lưu</td>
                        <td class="text-danger">C.Cao cống T.Bình</td>
                        <td class="text-danger">C.Cao cống T.Lưu</td>
                        <td class="text-danger">C.Cao cống H.Lưu</td>
                        <td class="text-danger">C.Cao cống T.Bình</td>

                        @* Thông tin C.Cao C.Chỗ cống hộp, rãnh *@

                        <td class="text-danger">C.Cao lót T.Lưu</td>
                        <td class="text-danger">C.Cao lót H.Lưu</td>
                        <td class="text-danger">C.Cao lót T.Bình</td>
                        <td class="text-danger">C.Cao lót T.Lưu</td>
                        <td class="text-danger">C.Cao lót H.Lưu</td>
                        <td class="text-danger">C.Cao lót T.Bình</td>
                        <td class="text-danger">C.Cao móng T.Lưu</td>
                        <td class="text-danger">C.Cao móng H.Lưu</td>
                        <td class="text-danger">C.Cao móng T.Bình</td>
                        <td class="text-danger">C.Cao móng T.Lưu</td>
                        <td class="text-danger">C.Cao móng H.Lưu</td>
                        <td class="text-danger">C.Cao móng T.Bình</td>
                        <td class="text-danger">C.Cao tường T.Lưu</td>
                        <td class="text-danger">C.Cao tường H.Lưu</td>
                        <td class="text-danger">C.Cao tường T.Bình</td>
                        <td class="text-danger">C.Cao tường T.Lưu</td>
                        <td class="text-danger">C.Cao tường H.Lưu</td>
                        <td class="text-danger">C.Cao tường T.Bình</td>

                        @* Thông tin C.Cao C.Chỗ ống nhựa *@
                        <td class="text-danger">C.Cao đệm cát T.Lưu</td>
                        <td class="text-danger">C.Cao đệm cát H.Lưu</td>
                        <td class="text-danger">C.Cao đệm cát T.Bình</td>
                        <td class="text-danger">C.Cao đệm cát T.Lưu</td>
                        <td class="text-danger">C.Cao đệm cát H.Lưu</td>
                        <td class="text-danger">C.Cao đệm cát T.Bình</td>
                        <td class="text-danger">C.Cao ống T.Lưu</td>
                        <td class="text-danger">C.Cao ống H.Lưu</td>
                        <td class="text-danger">C.Cao T.Bình</td>
                        <td class="text-danger">C.Cao ống T.Lưu</td>
                        <td class="text-danger">C.Cao ống H.Lưu</td>
                        <td class="text-danger">C.Cao T.Bình</td>
                        <td class="text-danger">C.Cao đắp cát T.Lưu</td>
                        <td class="text-danger">C.Cao Đắp cát H.Lưu</td>
                        <td class="text-danger">C.Cao đắp cát T.Bình</td>
                        <td class="text-danger">C.Cao đắp cát T.Lưu</td>
                        <td class="text-danger">C.Cao Đắp cát H.Lưu</td>
                        <td class="text-danger">C.Cao đắp cát T.Bình</td>

                        @* Thông tin chiếm chỗ rãnh thang (m) *@
                        <td class="text-danger">Lót thượng lưu</td>
                        <td class="text-danger">Lót hạ lưu</td>
                        <td class="text-danger">Lót trung bình</td>
                        <td class="text-danger">Lót thượng lưu</td>
                        <td class="text-danger">Lót hạ lưu</td>
                        <td class="text-danger">Lót trung bình</td>
                        <td class="text-danger">Móng thượng lưu</td>
                        <td class="text-danger">Móng hạ lưu</td>
                        <td class="text-danger">Móng trung bình</td>
                        <td class="text-danger">Móng thượng lưu</td>
                        <td class="text-danger">Móng hạ lưu</td>
                        <td class="text-danger">Móng trung bình</td>

                        @* Thông tin mái đào *@
                        <td>Chiều rộng đáy đào nhỏ (m)</td>
                        <td>Tỷ lệ mở mái</td>
                        <td>Số cạnh mái trái</td>
                        <td>Số cạnh mái phải</td>
                        <td>Chiều rộng đáy đào nhỏ (m)</td>
                        <td>Tỷ lệ mở mái</td>
                        <td>Số cạnh mái trái</td>
                        <td>Số cạnh mái phải</td>

                        @* D.Tích đào thượng lưu cống, rãnh, ống nhựa, rãnh thang *@
                        <td class="text-danger">C.Rộng đào đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đào (m2)</td>
                        <td class="text-danger">C.Rộng đào đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đào (m2)</td>
                        @* D.Tích đào hạ lưu cống, rãnh, ống nhựa, rãnh thang *@
                        <td class="text-danger">C.Rộng đào đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đào (m2)</td>
                        <td class="text-danger">C.Rộng đào đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đào (m2)</td>
                        @* D.Tích đào chân khay, giằng đỉnh  *@
                        <td class="text-danger">C.Rộng đào đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đào (m2)</td>
                        <td class="text-danger">C.Rộng đào đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đào (m2)</td>
                        @* Thông tin khối lượng đào *@
                        <td class="text-danger">KL đào đất (m3)</td>
                        <td class="text-danger">KL đào đá (m3)</td>
                        <td class="text-danger">Tổng KL đào cống, rãnh, ống nhựa, rãnh thang (m3)</td>
                        <td class="text-danger">Chân khay (m3)</td>
                        <td class="text-danger">Giằng đỉnh (m3)</td>
                        <td class="text-danger">Tổng KL đào đất chân khay + rảnh đỉnh (m3)</td>
                        <td class="text-danger">Tổng KL đào đất (m3)</td>
                        <td class="text-danger">Tổng KL đào đá (m3)</td>
                        <td class="text-danger">Tổng KL đào (m3)</td>
                        <td class="text-danger">KL C.Chỗ đất cống tròn (m3)</td>
                        <td class="text-danger">KL C.Chỗ đá cống tròn (m3)</td>
                        <td class="text-danger">Tổng KL chiếm chỗ C.Tròn (m3)</td>
                        <td class="text-danger">KL C.chỗ đất cống hộp (m3)</td>
                        <td class="text-danger">KL C.chỗ đá cống hộp (m3)</td>
                        <td class="text-danger">Tổng KL C.chỗ cống hộp (m3)</td>
                        <td class="text-danger">KL C.chỗ đất rãnh (m3)</td>
                        <td class="text-danger">KL C.chỗ đá rãnh (m3)</td>
                        <td class="text-danger">Tổng KL C.chỗ rãnh (m3)</td>
                        <td class="text-danger">KL C.Chỗ đất ống nhựa (m)</td>
                        <td class="text-danger">KL C.Chỗ đá ống nhựa (m3)</td>
                        <td class="text-danger">Tổng KL C.Chỗ ống nhựa (m3)</td>
                        <td class="text-danger">KL C.Chỗ đất rãnh thang (m3)</td>
                        <td class="text-danger">KL C.Chỗ đá rãnh thang (m3)</td>
                        <td class="text-danger">Tổng KL C.Chỗ rãnh thang (m3)</td>
                        <td class="text-danger">KL C.Chố đất chân khay (m3)</td>
                        <td class="text-danger">KL C.Chố đất chân giằng đỉnh (m3)</td>
                        <td class="text-danger">Tổng KL C.Chỗ đất (m3)</td>
                        <td class="text-danger">Tổng KL C.Chỗ đá (m3)</td>
                        <td class="text-danger">Tổng KL C.Chỗ (m3)</td>
                        <td class="text-danger">KL C.chỗ đất (m3)</td>
                        <td class="text-danger">KL C.Chỗ đá (m3)</td>
                        <td class="text-danger">Tổng chiếm chỗ (m3)</td>
                        <td class="text-danger">KL đắp trả đất (m3)</td>
                        <td class="text-danger">KL đắp trả đá (m3)</td>
                        <td class="text-danger">Tổng KL đắp trả (m3)</td>
                        <td class="text-danger">KL thừa đất (m3)</td>
                        <td class="text-danger">KL thừa đá (m3)</td>
                        <td class="text-danger">Tổng KL thừa (m3) </td>
                        @*D.Tích đắp cát *@
                        <td class="text-danger">C.Sâu đắp (m)</td>
                        <td class="text-danger">C.Rộng đắp đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đắp (m2)</td>
                        <td class="text-danger">C.Sâu đắp (m)</td>
                        <td class="text-danger">C.Rộng đắp đáy lớn (m)</td>
                        <td class="text-danger">D.Tích đắp (m2)</td>
                        @*Thông tin KL đắp cát *@
                        <td class="text-danger">KL đắp cát trước chiếm chỗ (m3)</td>
                        <td class="text-danger">KL chiếm chỗ (m3)</td>
                        <td class="text-danger">KL đắp cát sau chiếm chỗ (m3) </td>
                        @* Tọa độ	 *@
                        <td>X</td>
                        <td>Y</td>
                        <td>X</td>
                        <td>Y</td>

                    </tr>

                </thead>
                @if (listHopRanhThang.Any())
                {

                    <tbody>
                        @{
                            int stt = 1;
                        }
                        @foreach (var item in listHopRanhThang)
                        {

                            <tr onclick="alert(@item.Id)">
                                <td class="text-center">@stt</td>
                                <td class="text-center">@item.ThongTinLyTrinh_TuyenDuong </td>
                                <td class="text-center">@item.ThongTinLyTrinh_LyTrinhTaiTimHoGa </td>
                                <td class="text-center">@item.ThongTinChungHoGa_TenHoGaSauPhanLoai </td>
                                <td class="text-center">@item.ThongTinChungHoGa_TenHoGaTheoBanVe </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_HinhThucHoGa) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_KetCauMuMo)  </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_KetCauTuong) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_HinhThucMongHoGa) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_KetCauMong) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_ChatMatTrong) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinChungHoGa_ChatMatNgoai)  </td>

                                <td class="text-center">@item.PhuBiHoGa_CDai  </td>
                                <td class="text-center">@item.PhuBiHoGa_CRong</td>
                                <td class="text-center">@item.BeTongLotMong_D</td>
                                <td class="text-center">@item.BeTongLotMong_R</td>
                                <td class="text-center">@item.BeTongLotMong_C</td>
                                <td class="text-center">@item.BeTongMongHoGa_D  </td>
                                <td class="text-center">@item.BeTongMongHoGa_R  </td>
                                <td class="text-center">@item.TBeTongMongHoGa_C</td>
                                <td class="text-center">@item.DeHoGa_D</td>
                                <td class="text-center">@item.DeHoGa_R</td>
                                <td class="text-center">@item.DeHoGa_C</td>
                                <td class="text-center">@item.TuongHoGa_D</td>
                                <td class="text-center">@item.TuongHoGa_R  </td>
                                <td class="text-center">@item.TuongHoGa_C</td>
                                <td class="text-center">@item.TuongHoGa_CdTuong</td>
                                <td class="text-center">@item.DamGiuaHoGa_D  </td>
                                <td class="text-center">@item.DamGiuaHoGa_R</td>
                                <td class="text-center">@item.DamGiuaHoGa_C</td>
                                <td class="text-center">@item.DamGiuaHoGa_CdDam</td>
                                <td class="text-center">@item.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa</td>
                                <td class="text-center">@item.ChatMatTrong_D  </td>
                                <td class="text-center">@item.ChatMatTrong_R  </td>
                                <td class="text-center">@item.ChatMatTrong_C</td>
                                <td class="text-center">@item.ChatMatNgoaiCanh_D</td>
                                <td class="text-center">@item.ChatMatNgoaiCanh_R  </td>
                                <td class="text-center">@item.ChatMatNgoaiCanh_C</td>
                                <td class="text-center">@item.MuMoThotDuoi_D</td>
                                <td class="text-center">@item.MuMoThotDuoi_R</td>
                                <td class="text-center">@item.MuMoThotDuoi_C</td>
                                <td class="text-center">@item.MuMoThotDuoi_CdTuong</td>
                                <td class="text-center">@item.MuMoThotTren_D  </td>
                                <td class="text-center">@item.MuMoThotTren_R</td>
                                <td class="text-center">@item.MuMoThotTren_C</td>
                                <td class="text-center">@item.MuMoThotTren_CdTuong</td>
                                <td class="text-center">@item.HinhThucDauNoi1_Loai</td>

                                <td class="text-center">@item.HinhThucDauNoi1_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi1_CanhRong</td>
                                <td class="text-center">@item.HinhThucDauNoi1_CanhCheo</td>
                                <td class="text-center">@item.HinhThucDauNoi2_Loai</td>
                                <td class="text-center">@item.HinhThucDauNoi2_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi2_CanhRong</td>
                                <td class="text-center">@item.HinhThucDauNoi2_CanhCheo  </td>
                                <td class="text-center">@item.HinhThucDauNoi3_Loai</td>
                                <td class="text-center">@item.HinhThucDauNoi3_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi3_CanhRong  </td>
                                <td class="text-center">@item.HinhThucDauNoi3_CanhCheo</td>
                                <td class="text-center">@item.HinhThucDauNoi4_Loai</td>
                                <td class="text-center">@item.HinhThucDauNoi4_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi4_CanhRong  </td>
                                <td class="text-center">@item.HinhThucDauNoi4_CanhCheo</td>
                                <td class="text-center">@item.HinhThucDauNoi5_Loai</td>
                                <td class="text-center">@item.HinhThucDauNoi5_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi5_CanhRong</td>
                                <td class="text-center">@item.HinhThucDauNoi5_CanhCheo</td>
                                <td class="text-center">@item.HinhThucDauNoi6_Loai</td>
                                <td class="text-center">@item.HinhThucDauNoi6_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi6_CanhRong</td>
                                <td class="text-center">@item.HinhThucDauNoi6_CanhCheo  </td>
                                <td class="text-center">@item.HinhThucDauNoi7_Loai  </td>
                                <td class="text-center">@item.HinhThucDauNoi7_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi7_CanhRong </td>
                                <td class="text-center">@item.HinhThucDauNoi7_CanhCheo</td>
                                <td class="text-center">@item.HinhThucDauNoi8_Loai</td>
                                <td class="text-center">@item.HinhThucDauNoi8_CanhDai</td>
                                <td class="text-center">@item.HinhThucDauNoi8_CanhRong</td>
                                <td class="text-center">@item.HinhThucDauNoi8_CanhCheo </td>

                                <td class="text-center">@item.ThongTinTamDanHoGa2_PhanLoaiDayHoGa </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinTamDanHoGa2_HinhThucDayHoGa)  </td>
                                <td class="text-center">@item.ThongTinTamDanHoGa2_DuongKinh  </td>
                                <td class="text-center">@item.ThongTinTamDanHoGa2_ChieuDay</td>
                                <td class="text-center">@item.ThongTinTamDanHoGa2_D</td>
                                <td class="text-center">@item.ThongTinTamDanHoGa2_R</td>
                                <td class="text-center">@item.ThongTinTamDanHoGa2_C </td>
                                <td class="text-center">@item.ThongTinTamDanHoGa2_SoLuongNapDay </td>

                                <td class="text-center">@GetTenDanhMucById(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao)</td>
                                <td class="text-center">@item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa  </td>
                                <td class="text-center">@item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat</td>
                                <td class="text-center">@item.ThongTinVatLieuDaoHoGa_TongChieuCaoDao</td>

                                <td class="text-center">@item.ThongTinCaoDoHoGa_CaoDoTuNhien</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CdDinhViaHeHoanThien</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CaoDoDinhK98</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_DayDao</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CSauDao</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_DinhLotMong</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CdDinhMong</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CdDayHoGa</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CCaoTuong</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_DinhDamGiuaTuong</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_DinhTuong</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_DinhMuMoThotDuoi</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_CdDinhHoGa</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_TongChieuCaoHoGa</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_ChenhCaoDinhHoGaVaHienTrangDao</td>
                                <td class="text-center">@item.ThongTinCaoDoHoGa_TongChieuCaoChiemChoDapTra</td>

                                <td class="text-center">@item.TTCCCCDTHT_ChieuCaoLotDat</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChieuCaoMongDat</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChieuCaoTuongDat</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChieuCaoLotDa</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChieuCaoMongDa</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChieuCaoTuongDa</td>
                                <td class="text-center">@item.TTCCCCDTHT_TongCieuCaoDat</td>
                                <td class="text-center">@item.TTCCCCDTHT_TongChieuCaoDa</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChenhDatSoVoiTK</td>
                                <td class="text-center">@item.TTCCCCDTHT_ChenhDaSoVoiTK</td>

                                <td class="text-center">@item.ThongTinMaiDao_ChieuRongDayDaoNho </td>
                                <td class="text-center">@item.ThongTinMaiDao_TyLeMoMai </td>
                                <td class="text-center">@item.ThongTinMaiDao_SoCanhMaiTrai </td>
                                <td class="text-center">@item.ThongTinMaiDao_SoCanhMaiPhai  </td>

                                <td class="text-center">@item.TTKLD_CRongDaoDayLonDat</td>
                                <td class="text-center">@item.TTKLD_CRongDaoDayLonDa</td>
                                <td class="text-center">@item.TTKLD_DienTichDaoDat</td>
                                <td class="text-center">@item.TTKLD_DienTichDaoDa</td>
                                <td class="text-center">@item.TTKLD_TongDtDao</td>
                                <td class="text-center">@item.TTKLD_KlDaoDat</td>
                                <td class="text-center">@item.TTKLD_KlDaoDa</td>
                                <td class="text-center">@item.TTKLD_TongKlDao</td>
                                <td class="text-center">@item.TTKLD_KlChiemChoDat</td>
                                <td class="text-center">@item.TTKLD_KlChiemChoDa</td>
                                <td class="text-center">@item.TTKLD_TongChiemCho</td>
                                <td class="text-center">@item.TTKLD_KlDapTraDat</td>
                                <td class="text-center">@item.TTKLD_KlDapTraDa</td>
                                <td class="text-center">@item.TTKLD_TongDapTra</td>
                                <td class="text-center">@item.TTKLD_KlThuaDat</td>
                                <td class="text-center">@item.TTKLD_KlThuaDa</td>
                                <td class="text-center">@item.TTKLD_TongThua</td>

                                <td class="text-center">@item.ToaDoX  </td>
                                <td class="text-center">@item.ToaDoY  </td>


                                <td class="text-center">@item.ThongTinLyTrinhTruyenDan_TuLyTrinh </td>
                                <td class="text-center">@item.ThongTinLyTrinhTruyenDan_DenLyTrinh </td>
                                <td class="text-center">@item.ThongTinLyTrinhTruyenDan_TuHoGa </td>
                                <td class="text-center">@item.ThongTinLyTrinhTruyenDan_DenHoGa </td>

                                <td class="text-center">@GetTenDanhMucById(item.ThongTinDuongTruyenDan_HinhThucTruyenDan) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinDuongTruyenDan_LoaiTruyenDan) </td>
                                <td class="text-center">@item.ThongTinDuongTruyenDan_TenLoaiTruyenDanSauPhanLoai</td>

                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien </td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung  </td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_TongChieuDai </td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem</td>
                                <td class="text-center">@item.TTCDSLCauKienDuongTruyenDan_CDaiConThuaThieuSauTinhTheoCkTinhKl </td>

                                <td class="text-center">@item.ThongTinMongDuongTruyenDan_PhanLoaiMongCongTronCongHop </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinMongDuongTruyenDan_LoaiMong) </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinMongDuongTruyenDan_HinhThucMong) </td>

                                <td class="text-center">@item.ThongTinDeCong_TenLoaiDeCong </td>
                                <td class="text-center">@GetTenDanhMucById(item.ThongTinDeCong_CauTaoDeCong)</td>
                                <td class="text-center">@item.ThongTinDeCong_D</td>
                                <td class="text-center">@item.ThongTinDeCong_R </td>
                                <td class="text-center">@item.ThongTinDeCong_C </td>
                                <td class="text-center">@item.ThongTinDeCong_SlDeCong01CauKienTruyenDan </td>
                                <td class="text-center">@item.ThongTinDeCong_Kl01DeCong </td>
                                <td class="text-center">@item.ThongTinDeCong_TongSoLuongDC</td>
                                <td class="text-center">@item.ThongTinDeCong_TongKLDeCong</td>

                                <td class="text-center">@item.ThongTinCauTaoCongTron_CDayPhuBi</td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_SoCanh</td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_LongSuDung</td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_CCaoCauKien</td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_CCaoLotMong</td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_CRongLotMong</td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_CCaoMong  </td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_CRongMong </td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_CCaoDe </td>
                                <td class="text-center">@item.ThongTinCauTaoCongTron_TongCCaoCong </td>

                                <td class="text-center">@GetTenDanhMucById(item.TTKTHHCongHopRanh_CauTaoTuong) </td>
                                <td class="text-center">@GetTenDanhMucById(item.TTKTHHCongHopRanh_CauTaoMuMo) </td>
                                <td class="text-center">@GetTenDanhMucById(item.TTKTHHCongHopRanh_ChatMatTrong) </td>
                                <td class="text-center">@GetTenDanhMucById(item.TTKTHHCongHopRanh_ChatMatNgoai)</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoLotMong</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongLotMong</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoMong</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongMong</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoDe  </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongDe  </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CDayTuong01Ben</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_SoLuongTuong </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongLongSuDung</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoTuongCongHop </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoTuongRanh </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoTuongGop </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoMuMoThotDuoi</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongMuMoDuoi</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoMuMoThotTren</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongMuMoTren </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_LoaiThanhChong </td>
                                <td class="text-center">@GetTenDanhMucById(item.TTKTHHCongHopRanh_CauTaoThanhChong)</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoThanhChong</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CRongThanhChong</td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CDai </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_SoLuongThanhChong </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoChatMatTrong </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_CCaoChatmatNgoai </td>
                                <td class="text-center">@item.TTKTHHCongHopRanh_TongChieuCao </td>

                                <td class="text-center">@item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi</td>
                                <td class="text-center">@item.ThongTinKichThuocHinhHocOngNhua_SoCanh</td>
                                <td class="text-center">@item.ThongTinKichThuocHinhHocOngNhua_LongSuDung</td>
                                <td class="text-center">@item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng</td>

                                <td class="text-center">@item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat </td>
                                <td class="text-center">@item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat </td>
                                <td class="text-center">@item.ThongTinRanhThang_HinhThucMai </td>
                                <td class="text-center">@item.ThongTinRanhThang_CauTaoChanKhay </td>
                                <td class="text-center">@item.ThongTinRanhThang_CauTaoGiangDinh </td>
                                <td class="text-center">@item.ThongTinRanhThang_HinhThucHanhLangBaoVe </td>
                                <td class="text-center">@item.ThongTinRanhThang_PhanLoaiChanKhay</td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoLotChanKhay</td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongLotChanKhay</td>
                                <td class="text-center">@item.ThongTinRanhThang_SoLuongLotChanKhay</td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoMongChanKhay</td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongMongChanKhay</td>
                                <td class="text-center">@item.ThongTinRanhThang_SoLuongMongChanKhay </td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoLot</td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongLot</td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoMong</td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongMong </td>
                                <td class="text-center">@item.ThongTinRanhThang_PhanLoaiMai  </td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongMai</td>
                                <td class="text-center">@item.ThongTinRanhThang_CDayMai  </td>
                                <td class="text-center">@item.ThongTinRanhThang_SoLuongMai </td>
                                <td class="text-center">@item.ThongTinRanhThang_PhanLoaiGiangDinh </td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoLotGiangDinh</td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongLotGiangDinh </td>
                                <td class="text-center">@item.ThongTinRanhThang_SoLuongLotGiangDinh</td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoMongGiangDinh  </td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongMongGiangDinh </td>
                                <td class="text-center">@item.ThongTinRanhThang_SoLuongMongGiangDinh </td>
                                <td class="text-center">@item.ThongTinRanhThang_PhanLoaiHanhLangBaoVe </td>
                                <td class="text-center">@item.ThongTinRanhThang_CCaoHanhLangBaoVe </td>
                                <td class="text-center">@item.ThongTinRanhThang_CRongHanhLangBaoVe </td>
                                <td class="text-center">@item.ThongTinRanhThang_SoLuongHangLangBaoVe </td>

                                <td class="text-center">@item.TTTDCongHoRanh_TenLoaiTamDanTieuChuan </td>
                                <td class="text-center">@GetTenDanhMucById(item.TTTDCongHoRanh_CauTaoTamDanTruyenDanTamDanTieuChuan) </td>
                                <td class="text-center">@item.TTTDCongHoRanh_SoLuong </td>
                                <td class="text-center">@item.TTTDCongHoRanh_CDai </td>
                                <td class="text-center">@item.TTTDCongHoRanh_CRong </td>
                                <td class="text-center">@item.TTTDCongHoRanh_CCao </td>

                                <td class="text-center">@item.TTTDCongHoRanh_TenLoaiTamDanLoai02 </td>
                                <td class="text-center">@GetTenDanhMucById(item.TTTDCongHoRanh_CauTaoTamDanTruyenDan) </td>
                                <td class="text-center">@item.TTTDCongHoRanh_SoLuong1 </td>
                                <td class="text-center">@item.TTTDCongHoRanh_CDai1 </td>
                                <td class="text-center">@item.TTTDCongHoRanh_CRong1 </td>
                                <td class="text-center">@item.TTTDCongHoRanh_CCao1 </td>

                                <td class="text-center">@item.TTTDCongHoRanh_ChieuDaiMoiNoi </td>
                                <td class="text-center">@item.TTTDCongHoRanh_SoLuongTDanDungDeTinhChieuDaiBoSung </td>
                                <td class="text-center">@item.TTTDCongHoRanh_SLCauKienNguyen</td>
                                <td class="text-center">@item.TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen</td>
                                <td class="text-center">@item.TTTDCongHoRanh_TongChieuDaiTheoCKNguyen</td>
                                <td class="text-center">@item.TTTDCongHoRanh_ChieuDaiThucTe</td>
                                <td class="text-center text-danger">@item.TTTDCongHoRanh_XacDinhOngCongCanThem</td>

                                <td class="text-center">@item.CDThuongLuu_HienTrangTruocKhiDaoThuongLuu</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoGop</td>
                                <td class="text-center">@item.CDThuongLuu_ChieuSauDao</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoCongTron</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoCongHop</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoOngNhua</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoGiangDinhRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoChanKhayRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DayDaoRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotGop</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotChanKhayRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotGiangDinhRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotOngNhua</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotCongTron</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotCongHop</td>
                                <td class="text-center">@item.CDThuongLuu_DinhLotRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMongGop</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMongRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMongChanKhay</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMongCongTron</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMongCongHop</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMongRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhDeCong</td>
                                <td class="text-center">@item.CDThuongLuu_DayDongChay</td>
                                <td class="text-center">@item.CDThuongLuu_CCaoTuongCongRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhTuongCHopRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhMuMoThotDuoiCongHopRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhGiangDinhRanhThang</td>
                                <td class="text-center">@item.CDThuongLuu_DinhGop</td>
                                <td class="text-center">@item.CDThuongLuu_DinhTrongLongSuDung</td>
                                <td class="text-center">@item.CDThuongLuu_DinhCongTron</td>
                                <td class="text-center">@item.CDThuongLuu_DinhCongHop</td>
                                <td class="text-center">@item.CDThuongLuu_DinhRanh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhOngNhua</td>
                                <td class="text-center">@item.CDThuongLuu_DinhDapCat</td>
                                <td class="text-center">@item.CDThuongLuu_ChieuCaoRanhThangTuDayDongChayDenDinh</td>
                                <td class="text-center">@item.CDThuongLuu_DinhRanhThang </td>

                                <td class="text-center">@item.CDHaLu_HienTrangTruocKhiDaoHaLuu</td>
                                <td class="text-center">@item.CDHaLu_DayDaoGop</td>
                                <td class="text-center">@item.CDHaLu_ChieuSauDao</td>
                                <td class="text-center">@item.CDHaLu_DayDaoCongTron</td>
                                <td class="text-center">@item.CDHaLu_DayDaoCongHop</td>
                                <td class="text-center">@item.CDHaLu_DayDaoRanh</td>
                                <td class="text-center">@item.CDHaLu_DayDaoOngNhua</td>
                                <td class="text-center">@item.CDHaLu_DayDaoGiangDinhRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DayDaoChanKhayRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DayDaoRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DinhLotGop</td>
                                <td class="text-center">@item.CDHaLu_DinhLotRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DinhLotChanKhayRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DinhLotGiangDinhRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DinhLotOngNhua</td>
                                <td class="text-center">@item.CDHaLu_DinhLotCongTron</td>
                                <td class="text-center">@item.CDHaLu_DinhLotCongHop</td>
                                <td class="text-center">@item.CDHaLu_DinhLotRanh</td>
                                <td class="text-center">@item.CDHaLu_DinhMongGop</td>
                                <td class="text-center">@item.CDHaLu_DinhMongRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DinhMongChanKhay</td>
                                <td class="text-center">@item.CDHaLu_DinhMongCongTron</td>
                                <td class="text-center">@item.CDHaLu_DinhMongCongHop</td>
                                <td class="text-center">@item.CDHaLu_DinhMongRanh</td>
                                <td class="text-center">@item.CDHaLu_DinhDeCong</td>
                                <td class="text-center">@item.CDHaLu_DayDongChay</td>
                                <td class="text-center">@item.CDHaLu_CCaoTuongCongRanh</td>
                                <td class="text-center">@item.CDHaLu_DinhTuongCHopRanh</td>
                                <td class="text-center">@item.CDHaLu_DinhMuMoThotDuoiCongHopRanh</td>
                                <td class="text-center">@item.CDHaLu_DinhGiangDinhRanhThang</td>
                                <td class="text-center">@item.CDHaLu_DinhGop</td>
                                <td class="text-center">@item.CDHaLu_DinhTrongLongSuDung</td>
                                <td class="text-center">@item.CDHaLu_DinhCongTron</td>
                                <td class="text-center">@item.CDHaLu_DinhCongHop</td>
                                <td class="text-center">@item.CDHaLu_DinhRanh</td>
                                <td class="text-center">@item.CDHaLu_DinhOngNhua</td>
                                <td class="text-center">@item.CDHaLu_DinhDapCat</td>
                                <td class="text-center">@item.CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh</td>
                                <td class="text-center">@item.CDHaLu_DinhRanhThang </td>

                                <td class="text-center">@GetTenDanhMucById(item.TTVLDCongRanh_LoaiVatLieuDao) </td>
                                <td class="text-center">@item.TTVLDCongRanh_TLChieuCaoDaoDa</td>
                                <td class="text-center">@item.TTVLDCongRanh_TLChieuCaoDaoDat</td>
                                <td class="text-center">@item.TTVLDCongRanh_TLTongChieuSauDao</td>
                                <td class="text-center">@item.TTVLDCongRanh_HLChieuCaoDaoDa</td>
                                <td class="text-center">@item.TTVLDCongRanh_HLChieuCaoDaoDat</td>
                                <td class="text-center">@item.TTVLDCongRanh_HLTongChieuSauDao  </td>


                                <td class="text-center">@item.TTCCCCT_CCaoLotDatTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoLotDatHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoLotDatMongTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoLotDaTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoLotDaHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoLotDaMongTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoMongDatTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoMongDatHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoMongDatTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoMongDaTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoMongDaHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoMongDaTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoDeDatTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoDeDatHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoDeDatTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoDeDaTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoDeDaHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoDeDaTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoCongDatTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoCongDatHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCongCongDatTBinh </td>
                                <td class="text-center">@item.TTCCCCT_CCaoCongDaTLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCaoCongDaHLuu </td>
                                <td class="text-center">@item.TTCCCCT_CCongCongDaTBinh </td>

                                <td class="text-center">@item.TTCCCCCHR_CCaoLotDatTLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoLotDatHLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoLotDatTBinh </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoLotDaTLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoLotDaHLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoLotDaTBinh </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoMongDatTLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoMongDatHLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoMongDatTBinh </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoMongDaTLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoMongDaHLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoMongDaTBinh </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoTuongDatTLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoTuongDatHLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoTuongDatTBinh </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoTuongDaTLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoTuongDaHLuu </td>
                                <td class="text-center">@item.TTCCCCCHR_CCaoTuongDaTBinh  </td>

                                <td class="text-center">@item.TTCCCCON_CCaoDemCatDatTLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDemCatDatHLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDemCatDatTBinh  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDemCatDaTLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDemCatDaHLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDemCatDaTBinh  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoOngDatTLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoOngDatHLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDatTBinh  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoOngDaTLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoOngDaHLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDaTBinh  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDapCatDatTLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDapCatDatHLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDapCatDatTBinh  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDapCatDaTLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDapCatDaHLuu  </td>
                                <td class="text-center">@item.TTCCCCON_CCaoDapCatDaTBinh</td>

                                <td class="text-center">@item.TTCCRT_LotDatThuongLuu</td>
                                <td class="text-center">@item.TTCCRT_LotDatHaLuu</td>
                                <td class="text-center">@item.TTCCRT_LotDatTrungBinh</td>
                                <td class="text-center">@item.TTCCRT_LotDaThuongLuu</td>
                                <td class="text-center">@item.TTCCRT_LotDaHaLuu</td>
                                <td class="text-center">@item.TTCCRT_LotDaTrungBinh</td>
                                <td class="text-center">@item.TTCCRT_MongDatThuongLuu</td>
                                <td class="text-center">@item.TTCCRT_MongDatHaLuu</td>
                                <td class="text-center">@item.TTCCRT_MongDatTrungBinh</td>
                                <td class="text-center">@item.TTCCRT_MongDaThuongLuu</td>
                                <td class="text-center">@item.TTCCRT_MongDaHaLuu</td>
                                <td class="text-center">@item.TTCCRT_MongDaTrungBinh</td>

                                <td class="text-center">@item.TTMDRanhOngThang_ChieuRongDayDaoNho </td>
                                <td class="text-center">@item.TTMDRanhOngThang_TyLeMoMai </td>
                                <td class="text-center">@item.TTMDRanhOngThang_SoCanhMaiTrai</td>
                                <td class="text-center">@item.TTMDRanhOngThang_SoCanhMaiPhai</td>
                                <td class="text-center">@item.TTMDRanhOngThang_ChieuRongDayDaoNho1 </td>
                                <td class="text-center">@item.TTMDRanhOngThang_TyLeMoMai1 </td>
                                <td class="text-center">@item.TTMDRanhOngThang_SoCanhMaiTrai1</td>
                                <td class="text-center">@item.TTMDRanhOngThang_SoCanhMaiPhai1 </td>

                                <td class="text-center">@item.DTDTLCRONRT_CRongDaoDatDayLon</td>
                                <td class="text-center">@item.DTDTLCRONRT_DTichDaoDat</td>
                                <td class="text-center">@item.DTDTLCRONRT_CRongDaoDaDayLon</td>
                                <td class="text-center">@item.DTDTLCRONRT_DTichDaoDa</td>
                                <td class="text-center">@item.DTDHLCRONRT_CRongDaoDatDayLon</td>
                                <td class="text-center">@item.DTDHLCRONRT_DTichDaoDat</td>
                                <td class="text-center">@item.DTDHLCRONRT_CRongDaoDaDayLon</td>
                                <td class="text-center">@item.DTDHLCRONRT_DTichDaoDa</td>
                                <td class="text-center">@item.DTDCKRD_CKCRongDaoDayLon</td>
                                <td class="text-center">@item.DTDCKRD_CKDTichDao</td>
                                <td class="text-center">@item.DTDCKRD_CRongDaoDayLon</td>
                                <td class="text-center">@item.DTDCKRD_DTichDao</td>



                                <td class="text-center">@item.TKLD_KlDaoDat</td>
                                <td class="text-center">@item.TKLD_KlDaoDa</td>
                                <td class="text-center">@item.TKLD_TongKlDaoCongRanhOngNhuaRanhThang</td>
                                <td class="text-center">@item.TKLD_ChanKhay</td>
                                <td class="text-center">@item.TKLD_GiangDinh</td>
                                <td class="text-center">@item.TKLD_TongKlDaoDatChanKhayRanhDinh</td>
                                <td class="text-center">@item.TKLD_TongKlDaoDat</td>
                                <td class="text-center">@item.TKLD_TongKlDaoDa</td>
                                <td class="text-center">@item.TKLD_TongKlDao</td>
                                <td class="text-center">@item.TKLD_KlCChoDatCongTron</td>
                                <td class="text-center">@item.TKLD_KlCChoDaCongTron</td>
                                <td class="text-center">@item.TKLD_TongKlChiemChoCTron</td>
                                <td class="text-center">@item.TKLD_KlCChoDatCongHop</td>
                                <td class="text-center">@item.TKLD_KlCChoDaCongHop</td>
                                <td class="text-center">@item.TKLD_TongKlCChoCongHop</td>
                                <td class="text-center">@item.TKLD_KlCChoDatRanh</td>
                                <td class="text-center">@item.TKLD_KlCChoDaRanh</td>
                                <td class="text-center">@item.TKLD_TongKlCChoRanh</td>
                                <td class="text-center">@item.TKLD_KlCChoDatOngNhua</td>
                                <td class="text-center">@item.TKLD_KlCChoDaOngNhua</td>
                                <td class="text-center">@item.TKLD_TongKlCChoOngNhua</td>
                                <td class="text-center">@item.TKLD_KlCChoDatRanhThang</td>
                                <td class="text-center">@item.TKLD_KlCChoDaRanhThang</td>
                                <td class="text-center">@item.TKLD_TongKlCChoRanhThang</td>
                                <td class="text-center">@item.TKLD_KlCChoDatChanKhay</td>
                                <td class="text-center">@item.TKLD_KlCChoDatChanGiangDinh</td>
                                <td class="text-center">@item.TKLD_TongKlCChoDat</td>
                                <td class="text-center">@item.TKLD_TongKlCChoDa</td>
                                <td class="text-center">@item.TKLD_TongKlCCho</td>
                                <td class="text-center">@item.TKLD_KlCChoDat</td>
                                <td class="text-center">@item.TKLD_KlCChoDa</td>
                                <td class="text-center">@item.TKLD_TongChiemCho</td>
                                <td class="text-center">@item.TKLD_KlDapTraDat</td>
                                <td class="text-center">@item.TKLD_KlDapTraDa</td>
                                <td class="text-center">@item.TKLD_TongKlDapTra</td>
                                <td class="text-center">@item.TKLD_KlThuaDat</td>
                                <td class="text-center">@item.TKLD_KlThuaDa</td>
                                <td class="text-center">@item.TKLD_TongKLThua</td>
                                <td class="text-center">@item.DTDC_TLCSauDap</td>
                                <td class="text-center">@item.DTDC_TLCRongDapDayLon</td>
                                <td class="text-center">@item.DTDC_TLDTichDap</td>
                                <td class="text-center">@item.DTDC_HLCSauDap</td>
                                <td class="text-center">@item.DTDC_HLCRongDapDayLon</td>
                                <td class="text-center">@item.DTDC_HLDTichDap </td>

                                <td class="text-center">@item.TTKLDC_KlDapCatTruocChiemCho</td>
                                <td class="text-center">@item.TTKLDC_KlChiemCho</td>
                                <td class="text-center">@item.TTKLDC_KlDapCatSauChiemCho </td>

                                <td class="text-center">@item.TuToaDoX </td>
                                <td class="text-center">@item.TuToaDoY </td>
                                <td class="text-center">@item.DenToaDoX </td>
                                <td class="text-center">@item.DenToaDoY </td>

                            </tr>
                            stt++;
                        }

                    </tbody>
                }
            </table>
        </div>
        <div class="mt-4">
            @if (listHopRanhThang.Any())
            {
                <Pagination MetaData="MetaData" Spread="2" SelectedPage="SelectedPage" ChangePageSize="ChangePageSize"></Pagination>
            }
        </div>
    </div>
</div>

@code {
    public List<MDanhMuc> listDanhMuc = new();

    public List<HopRanhThangModel> listHopRanhThang
    {
        get;
        set;
    } = new();

    public List<HopRanhThangModel> listModel
    {
        get;
        set;
    } = new();

    public MetaData MetaData
    {
        get;
        set;
    }

    public HopRanhThangModel hopRanhThangModel
    {
        get;
        set;
    }


    // Khởi tạo màn hình
    protected override async Task OnInitializedAsync()
    {
        hopRanhThangModel = new();
        await LoadData();
    }


    // Truy vấn data theo điều kiện tìm kiếm
    private async Task LoadData()
    {
        listDanhMuc = await DanhMucRepository.GetAll();
        var hopranhthangs = await HopRanhThangRepository.GetData();
        var convertDatas = await ConvertData(hopranhthangs);
        listModel = convertDatas;
        listHopRanhThang = Paging(convertDatas);

    }

    public string GetTenDanhMucById(string id)
    {
        var danhMuc = listDanhMuc.FirstOrDefault(dm => dm.Id == id);
        return danhMuc != null ? danhMuc.Ten : null;
    }


    public async Task<List<HopRanhThangModel>> ConvertData(List<HopRanhThangModel> list)
    {
        if (list == null || list.Count == 0)
        {
            Console.WriteLine("Danh sách trống.");
        }
        else
        {
            list.ForEach(item =>
            {
                item.ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao = ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao(item.ThongTinCaoDoHoGa_CaoDoTuNhien, item.ThongTinCaoDoHoGa_CaoDoDinhK98, item.ThongTinCaoDoHoGa_CdDinhViaHeHoanThien);
                item.ThongTinCaoDoHoGa_CdDinhMong = ThongTinCaoDoHoGa_CdDinhMong(item.ThongTinChungHoGa_HinhThucHoGa, item.ThongTinChungHoGa_HinhThucMongHoGa, item.ThongTinCaoDoHoGa_CdDayHoGa, item.DeHoGa_C);
                item.ThongTinCaoDoHoGa_DinhLotMong = ThongTinCaoDoHoGa_DinhLotMong(item.ThongTinChungHoGa_HinhThucMongHoGa, item.ThongTinCaoDoHoGa_CdDinhMong, item.TBeTongMongHoGa_C);
                item.ThongTinCaoDoHoGa_DayDao = ThongTinCaoDoHoGa_DayDao(item.ThongTinChungHoGa_HinhThucHoGa, item.ThongTinChungHoGa_HinhThucMongHoGa, item.ThongTinCaoDoHoGa_DinhLotMong, item.BeTongLotMong_C, item.ThongTinCaoDoHoGa_CdDayHoGa, item.DeHoGa_C);
                item.ThongTinCaoDoHoGa_CSauDao = ThongTinCaoDoHoGa_CSauDao(item.ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao, item.ThongTinCaoDoHoGa_DayDao);
                item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinCaoDoHoGa_CSauDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa);
                item.ThongTinVatLieuDaoHoGa_TongChieuCaoDao = (item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa + item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat);
                item.TuongHoGa_C = item.ThongTinCaoDoHoGa_CCaoTuong;
                item.ChatMatNgoaiCanh_C = ChatMatNgoaiCanh_C(item.ThongTinChungHoGa_ChatMatNgoai, item.ThongTinChungHoGa_KetCauTuong, item.ThongTinChungHoGa_KetCauMuMo, item.TuongHoGa_C, item.DamGiuaHoGa_CdDam, item.MuMoThotDuoi_C, item.MuMoThotTren_C, item.MuMoThotTren_CdTuong);
                item.ThongTinCaoDoHoGa_TongChieuCaoHoGa = ThongTinCaoDoHoGa_TongChieuCaoHoGa(item.ThongTinCaoDoHoGa_CdDinhHoGa, item.ThongTinCaoDoHoGa_DayDao);
                item.ThongTinCaoDoHoGa_ChenhCaoDinhHoGaVaHienTrangDao = ThongTinCaoDoHoGa_ChenhCaoDinhHoGaVaHienTrangDao(item.ThongTinCaoDoHoGa_CdDinhHoGa, item.ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao);
                item.ThongTinCaoDoHoGa_TongChieuCaoChiemChoDapTra = item.ThongTinCaoDoHoGa_TongChieuCaoHoGa - item.ThongTinCaoDoHoGa_ChenhCaoDinhHoGaVaHienTrangDao;
                item.ThongTinCaoDoHoGa_DinhMuMoThotDuoi = ThongTinCaoDoHoGa_DinhMuMoThotDuoi(item.ThongTinCaoDoHoGa_CdDinhHoGa, item.MuMoThotTren_C);
                item.ThongTinCaoDoHoGa_DinhTuong = ThongTinCaoDoHoGa_DinhTuong(item.ThongTinCaoDoHoGa_DinhMuMoThotDuoi, item.MuMoThotDuoi_C);
                item.ThongTinCaoDoHoGa_DinhDamGiuaTuong = ThongTinCaoDoHoGa_DinhDamGiuaTuong(item.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa, item.ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong, item.DamGiuaHoGa_C);
                item.ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong = ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong(item.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa, item.ThongTinCaoDoHoGa_CdDayHoGa);
                item.ThongTinCaoDoHoGa_CCaoTuong = ThongTinCaoDoHoGa_CCaoTuong(item.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa, item.ThongTinCaoDoHoGa_DinhTuong, item.ThongTinCaoDoHoGa_CdDayHoGa, item.DamGiuaHoGa_C);
                item.TTCCCCDTHT_ChieuCaoLotDat = TTCCCCDTHT_ChieuCaoLotDat(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, item.BeTongLotMong_C);
                item.TTCCCCDTHT_ChieuCaoMongDat = TTCCCCDTHT_ChieuCaoMongDat(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, item.BeTongLotMong_C, item.TBeTongMongHoGa_C);
                item.TTCCCCDTHT_ChieuCaoTuongDat = TTCCCCDTHT_ChieuCaoTuongDat(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, item.BeTongLotMong_C, item.TBeTongMongHoGa_C, item.TuongHoGa_C, item.DamGiuaHoGa_C, item.MuMoThotDuoi_C, item.MuMoThotTren_C);
                item.TTCCCCDTHT_ChieuCaoLotDa = TTCCCCDTHT_ChieuCaoLotDa(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, item.ThongTinVatLieuDaoHoGa_TongChieuCaoDao, item.TTCCCCDTHT_ChieuCaoLotDat, item.BeTongLotMong_C);
                item.TTCCCCDTHT_ChieuCaoMongDa = TTCCCCDTHT_ChieuCaoMongDa(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, item.ThongTinVatLieuDaoHoGa_TongChieuCaoDao, item.TTCCCCDTHT_ChieuCaoMongDat, item.TTCCCCDTHT_ChieuCaoLotDa, item.BeTongLotMong_C, item.TBeTongMongHoGa_C);
                item.TTCCCCDTHT_ChieuCaoTuongDa = TTCCCCDTHT_ChieuCaoTuongDa(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, item.ThongTinVatLieuDaoHoGa_TongChieuCaoDao, item.TTCCCCDTHT_ChieuCaoTuongDat, item.TTCCCCDTHT_ChieuCaoLotDa, item.TTCCCCDTHT_ChieuCaoMongDa, item.BeTongLotMong_C, item.TBeTongMongHoGa_C, item.TuongHoGa_C, item.DamGiuaHoGa_C, item.MuMoThotDuoi_C, item.MuMoThotTren_C);
                item.TTCCCCDTHT_TongCieuCaoDat = (item.TTCCCCDTHT_ChieuCaoLotDat + item.TTCCCCDTHT_ChieuCaoMongDat + item.TTCCCCDTHT_ChieuCaoTuongDat);
                item.TTCCCCDTHT_TongChieuCaoDa = (item.TTCCCCDTHT_ChieuCaoLotDa + item.TTCCCCDTHT_ChieuCaoMongDa + item.TTCCCCDTHT_ChieuCaoTuongDa);
                item.TTCCCCDTHT_ChenhDatSoVoiTK = (item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat - item.TTCCCCDTHT_TongCieuCaoDat);
                item.TTCCCCDTHT_ChenhDaSoVoiTK = (item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa - item.TTCCCCDTHT_TongChieuCaoDa);

                item.TTKLD_CRongDaoDayLonDat = TTKLD_CRongDaoDayLonDat(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, item.ThongTinMaiDao_TyLeMoMai, item.ThongTinMaiDao_SoCanhMaiTrai, item.ThongTinMaiDao_SoCanhMaiPhai, item.ThongTinMaiDao_ChieuRongDayDaoNho);
                item.TTKLD_CRongDaoDayLonDa = TinhTTTKLD_CRongDaoDayLonDaoan(item.ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, item.ThongTinMaiDao_TyLeMoMai, item.ThongTinMaiDao_SoCanhMaiTrai, item.ThongTinMaiDao_SoCanhMaiPhai, item.TTKLD_CRongDaoDayLonDat, item.ThongTinMaiDao_ChieuRongDayDaoNho);
                item.TTKLD_DienTichDaoDat = TiTTKLD_DienTichDaoDatnhToan(item.TTKLD_CRongDaoDayLonDat, item.ThongTinMaiDao_ChieuRongDayDaoNho, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat);
                item.TTKLD_DienTichDaoDa = TTKLD_DienTichDaoDa(item.TTKLD_CRongDaoDayLonDa, item.TTKLD_CRongDaoDayLonDat, item.ThongTinMaiDao_ChieuRongDayDaoNho, item.ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa);
                item.TTKLD_TongDtDao = TTKLD_TongDtDao(item.TTKLD_DienTichDaoDat, item.TTKLD_DienTichDaoDa);
                item.TTKLD_KlDaoDat = TTKLD_KlDaoDat(item.TTKLD_DienTichDaoDat, item.BeTongLotMong_D, item.PhuBiHoGa_CDai, item.ThongTinChungHoGa_TenHoGaTheoBanVe);
                item.TTKLD_KlDaoDa = TTKLD_KlDaoDa(item.TTKLD_DienTichDaoDa, item.BeTongLotMong_D, item.PhuBiHoGa_CDai, item.ThongTinChungHoGa_TenHoGaTheoBanVe);
                item.TTKLD_TongKlDao = TTKLD_TongKlDao(item.TTKLD_KlDaoDat, item.TTKLD_KlDaoDa);
                item.TTKLD_KlChiemChoDat = TTKLD_KlChiemChoDat(item.ThongTinChungHoGa_TenHoGaTheoBanVe, item.BeTongLotMong_D, item.TTCCCCDTHT_ChieuCaoLotDat, item.BeTongLotMong_R, item.BeTongMongHoGa_D, item.BeTongMongHoGa_R, item.TTCCCCDTHT_ChieuCaoMongDat, item.TTCCCCDTHT_ChieuCaoTuongDat, item.PhuBiHoGa_CDai, item.PhuBiHoGa_CRong);
                item.TTKLD_KlChiemChoDa = TTKLD_KlChiemChoDa(item.ThongTinChungHoGa_TenHoGaTheoBanVe, item.BeTongLotMong_D, item.TTCCCCDTHT_ChieuCaoLotDa, item.BeTongLotMong_R, item.BeTongMongHoGa_D, item.BeTongMongHoGa_R, item.TTCCCCDTHT_ChieuCaoMongDa, item.TTCCCCDTHT_ChieuCaoTuongDa, item.PhuBiHoGa_CDai, item.PhuBiHoGa_CRong);
                item.TTKLD_TongChiemCho = TTKLD_TongChiemCho(item.TTKLD_KlChiemChoDat, item.TTKLD_KlChiemChoDa);
                item.TTKLD_KlDapTraDat = TinhTTKLD_KlDapTraDatHieu(item.TTKLD_KlDaoDat, item.TTKLD_KlChiemChoDat);
                item.TTKLD_KlDapTraDa = TTKLD_KlDapTraDa(item.TTKLD_KlDaoDa, item.TTKLD_KlChiemChoDa);
                item.TTKLD_TongDapTra = TTKLD_TongDapTra(item.TTKLD_KlDapTraDat, item.TTKLD_KlDapTraDa);
                item.TTKLD_KlThuaDat = item.TTKLD_KlChiemChoDat;
                item.TTKLD_KlThuaDa = item.TTKLD_KlChiemChoDa;
                item.TTKLD_TongThua = item.TTKLD_KlThuaDat + item.TTKLD_KlThuaDa;

                item.TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen = TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem, item.TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, item.TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung);
                item.TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem = TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem(item.TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa);
                item.TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl = TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem, item.TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, item.TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung);
                item.TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen = TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, item.TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung, item.TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien);
                item.TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen = TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, item.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien, item.TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen);
                item.TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa = TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TTCDSLCauKienDuongTruyenDan_CDaiConThuaThieuSauTinhTheoCkTinhKl = TTCDSLCauKienDuongTruyenDan_CDaiConThuaThieuSauTinhTheoCkTinhKl(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl, item.TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung, item.TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien, item.TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);

                item.ThongTinDeCong_TongSoLuongDC = item.ThongTinDeCong_SlDeCong01CauKienTruyenDan * item.TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl;
                item.ThongTinDeCong_TongKLDeCong = Math.Round(item.ThongTinDeCong_Kl01DeCong * item.ThongTinDeCong_TongSoLuongDC, 2);

                item.ThongTinCauTaoCongTron_CCaoCauKien = ThongTinCauTaoCongTron_CCaoCauKien(item.ThongTinCauTaoCongTron_CDayPhuBi, item.ThongTinCauTaoCongTron_SoCanh, item.ThongTinCauTaoCongTron_LongSuDung);
                item.ThongTinCauTaoCongTron_TongCCaoCong = ThongTinCauTaoCongTron_TongCCaoCong(item.ThongTinCauTaoCongTron_CCaoCauKien, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe);

                item.TTKTHHCongHopRanh_CCaoTuongRanh = TTKTHHCongHopRanh_CCaoTuongRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDThuongLuu_CCaoTuongCongRanh, item.CDHaLu_CCaoTuongCongRanh);
                item.TTKTHHCongHopRanh_CCaoTuongGop = TTKTHHCongHopRanh_CCaoTuongGop(item.TTKTHHCongHopRanh_CCaoTuongCongHop, item.TTKTHHCongHopRanh_CCaoTuongRanh);

                item.TTKTHHCongHopRanh_CCaoChatMatTrong = TTKTHHCongHopRanh_CCaoChatMatTrong(item.TTKTHHCongHopRanh_ChatMatTrong, item.TTKTHHCongHopRanh_CauTaoTuong, item.TTKTHHCongHopRanh_CauTaoMuMo, item.TTKTHHCongHopRanh_CCaoTuongGop, item.TTKTHHCongHopRanh_CCaoMuMoThotDuoi, item.TTKTHHCongHopRanh_CCaoMuMoThotTren);
                item.TTKTHHCongHopRanh_CCaoChatmatNgoai = TTKTHHCongHopRanh_CCaoChatmatNgoai(item.TTKTHHCongHopRanh_ChatMatNgoai, item.TTKTHHCongHopRanh_CauTaoTuong, item.TTKTHHCongHopRanh_CauTaoMuMo, item.TTKTHHCongHopRanh_CCaoTuongGop, item.TTKTHHCongHopRanh_CCaoMuMoThotDuoi, item.TTKTHHCongHopRanh_CCaoMuMoThotTren, item.TTKTHHCongHopRanh_CRongMuMoTren);
                item.TTKTHHCongHopRanh_TongChieuCao = TTKTHHCongHopRanh_TongChieuCao(item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTKTHHCongHopRanh_CCaoDe, item.TTKTHHCongHopRanh_CCaoTuongGop, item.TTKTHHCongHopRanh_CCaoMuMoThotDuoi, item.TTKTHHCongHopRanh_CCaoMuMoThotTren);

                item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng = ThongTinKichThuocHinhHocOngNhua_TongCCaoOng(item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.ThongTinKichThuocHinhHocOngNhua_SoCanh, item.ThongTinKichThuocHinhHocOngNhua_LongSuDung);

                item.TTTDCongHoRanh_SoLuong = TTTDCongHoRanh_SoLuong(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTTDCongHoRanh_SLCauKienNguyen);

                item.TTTDCongHoRanh_SLCauKienNguyen = TTTDCongHoRanh_SLCauKienNguyen(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai, item.TTTDCongHoRanh_CDai, item.TTTDCongHoRanh_ChieuDaiMoiNoi);
                item.TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen = TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTTDCongHoRanh_SLCauKienNguyen, item.TTTDCongHoRanh_ChieuDaiMoiNoi);
                item.TTTDCongHoRanh_TongChieuDaiTheoCKNguyen = TTTDCongHoRanh_TongChieuDaiTheoCKNguyen(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTTDCongHoRanh_SLCauKienNguyen, item.TTTDCongHoRanh_CDai, item.TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen);
                item.TTTDCongHoRanh_ChieuDaiThucTe = TTTDCongHoRanh_ChieuDaiThucTe(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTTDCongHoRanh_TongChieuDaiTheoCKNguyen, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TTTDCongHoRanh_XacDinhOngCongCanThem = TTTDCongHoRanh_XacDinhOngCongCanThem(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTTDCongHoRanh_ChieuDaiThucTe);
                item.TTTDCongHoRanh_SoLuong1 = TTTDCongHoRanh_SoLuong1(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTTDCongHoRanh_XacDinhOngCongCanThem);
;

                item.TTTDCongHoRanh_CDai1 = TTTDCongHoRanh_CDai1(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, new List<string> { "Cống hộp", "Rãnh xây", "Rãnh bê tông", "Cống hộp", "Rãnh xây" },
                new List<double> { 100, 200, 150, 250, 300 },
                new List<string> { "Thêm 01", "Thêm 01", "Thêm 01", "Thêm 01", "Không thêm" });

                item.CDThuongLuu_DinhDeCong = CDThuongLuu_DinhDeCong(item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi);
                item.CDThuongLuu_DinhMongRanh = CDThuongLuu_DinhMongRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay);
                item.CDThuongLuu_DinhMongCongHop = CDThuongLuu_DinhMongCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.TTKTHHCongHopRanh_CCaoDe);
                item.CDThuongLuu_DinhMongCongTron = CDThuongLuu_DinhMongCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDThuongLuu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe);
                item.CDThuongLuu_DinhMongChanKhay = CDThuongLuu_DinhMongChanKhay(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoChanKhay, item.CDThuongLuu_DayDongChay);
                item.CDThuongLuu_DinhMongRanhThang = CDThuongLuu_DinhMongRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay);
                item.CDThuongLuu_DinhMongGop = CDThuongLuu_DinhMongGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDThuongLuu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe, item.TTKTHHCongHopRanh_CCaoDe);
                item.CDThuongLuu_DinhLotRanh = CDThuongLuu_DinhLotRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DinhMongRanh, item.TTKTHHCongHopRanh_CCaoMong);
                item.CDThuongLuu_DinhLotCongHop = CDThuongLuu_DinhLotCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DinhMongCongHop, item.TTKTHHCongHopRanh_CCaoMong);
                item.CDThuongLuu_DinhLotCongTron = CDThuongLuu_DinhLotCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DinhMongCongTron, item.ThongTinCauTaoCongTron_CCaoMong);
                item.CDThuongLuu_DinhLotOngNhua = CDThuongLuu_DinhLotOngNhua(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi);
                item.CDThuongLuu_DinhLotGiangDinhRanhThang = CDThuongLuu_DinhLotGiangDinhRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoGiangDinh, item.CDThuongLuu_DinhRanhThang, item.ThongTinRanhThang_CCaoMongGiangDinh);
                item.CDThuongLuu_DinhLotChanKhayRanhThang = CDThuongLuu_DinhLotChanKhayRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoChanKhay, item.CDThuongLuu_DayDongChay, item.ThongTinRanhThang_CCaoMongChanKhay);
                item.CDThuongLuu_DinhLotRanhThang = CDThuongLuu_DinhLotRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinRanhThang_CCaoMong);
                item.CDThuongLuu_DinhLotGop = CDThuongLuu_DinhLotGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinRanhThang_CCaoMong, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.CDThuongLuu_DinhMongCongTron, item.ThongTinCauTaoCongTron_CCaoMong, item.CDThuongLuu_DinhMongCongHop, item.TTKTHHCongHopRanh_CCaoMong, item.CDThuongLuu_DinhMongRanh);
                item.CDThuongLuu_DayDaoRanhThang = CDThuongLuu_DayDaoRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DinhLotRanhThang, item.ThongTinRanhThang_CCaoLot, item.CDThuongLuu_DayDongChay);
                item.CDThuongLuu_DayDaoChanKhayRanhThang = CDThuongLuu_DayDaoChanKhayRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoChanKhay, item.CDThuongLuu_DinhLotChanKhayRanhThang, item.ThongTinRanhThang_CCaoLotChanKhay, item.CDThuongLuu_DayDongChay);
                item.CDThuongLuu_DayDaoGiangDinhRanhThang = CDThuongLuu_DayDaoGiangDinhRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoGiangDinh, item.CDThuongLuu_DinhLotGiangDinhRanhThang, item.ThongTinRanhThang_CCaoLotGiangDinh, item.CDThuongLuu_DinhRanhThang);
                item.CDThuongLuu_DayDaoOngNhua = CDThuongLuu_DayDaoOngNhua(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.CDThuongLuu_DinhLotOngNhua, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
                item.CDThuongLuu_DayDaoRanh = CDThuongLuu_DayDaoRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDThuongLuu_DinhLotRanh, item.TTKTHHCongHopRanh_CCaoLotMong);
                item.CDThuongLuu_DayDaoCongHop = CDThuongLuu_DayDaoCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.TTKTHHCongHopRanh_CCaoDe, item.CDThuongLuu_DinhLotCongHop, item.TTKTHHCongHopRanh_CCaoLotMong);
                item.CDThuongLuu_DayDaoCongTron = CDThuongLuu_DayDaoCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDThuongLuu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe, item.CDThuongLuu_DinhLotCongTron, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.CDThuongLuu_DayDaoGop = CDThuongLuu_DayDaoGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDThuongLuu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDThuongLuu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe, item.CDThuongLuu_DinhLotCongTron, item.ThongTinCauTaoCongTron_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoDe, item.CDThuongLuu_DinhLotCongHop, item.TTKTHHCongHopRanh_CCaoLotMong, item.CDThuongLuu_DinhLotRanh, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.CDThuongLuu_DinhLotOngNhua, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.CDThuongLuu_DinhLotRanhThang, item.ThongTinRanhThang_CCaoLot);
                item.CDThuongLuu_ChieuSauDao = CDThuongLuu_ChieuSauDao(item.CDThuongLuu_HienTrangTruocKhiDaoThuongLuu, item.CDThuongLuu_DayDaoGop);

                item.CDHaLu_DinhRanhThang = CDHaLu_DinhRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DayDongChay, item.CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh);
                item.CDHaLu_DinhDapCat = CDHaLu_DinhDapCat(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhOngNhua, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat);
                item.CDHaLu_DinhOngNhua = CDHaLu_DinhOngNhua(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhTrongLongSuDung, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi);
                item.CDHaLu_DinhRanh = CDHaLu_DinhRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhTrongLongSuDung, item.TTKTHHCongHopRanh_CCaoMuMoThotTren);
                item.CDHaLu_DinhCongHop = CDHaLu_DinhCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhTrongLongSuDung, item.TTKTHHCongHopRanh_CCaoMuMoThotTren);
                item.CDHaLu_DinhCongTron = CDHaLu_DinhCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhTrongLongSuDung, item.ThongTinCauTaoCongTron_CDayPhuBi);
                item.CDHaLu_DinhGop = CDHaLu_DinhGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhTrongLongSuDung, item.ThongTinCauTaoCongTron_CDayPhuBi, item.TTKTHHCongHopRanh_CCaoMuMoThotTren, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.CDHaLu_DayDongChay, item.CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh);
                item.CDHaLu_DinhGiangDinhRanhThang = CDHaLu_DinhGiangDinhRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoGiangDinh, item.CDHaLu_DinhRanhThang);
                item.CDHaLu_DinhMuMoThotDuoiCongHopRanh = CDHaLu_DinhMuMoThotDuoiCongHopRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhCongHop, item.TTKTHHCongHopRanh_CCaoMuMoThotTren, item.CDHaLu_DinhRanh);
                item.CDHaLu_DinhTuongCHopRanh = CDHaLu_DinhTuongCHopRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhMuMoThotDuoiCongHopRanh, item.TTKTHHCongHopRanh_CCaoMuMoThotDuoi);
                item.CDHaLu_CCaoTuongCongRanh = CDHaLu_CCaoTuongCongRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhTuongCHopRanh, item.CDHaLu_DayDongChay);
                item.CDHaLu_DinhDeCong = CDHaLu_DinhDeCong(item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi);
                item.CDHaLu_DinhMongRanh = CDHaLu_DinhMongRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay);
                item.CDHaLu_DinhMongCongHop = CDHaLu_DinhMongCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.TTKTHHCongHopRanh_CCaoDe);
                item.CDHaLu_DinhMongCongTron = CDHaLu_DinhMongCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDHaLu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe);
                item.CDHaLu_DinhMongChanKhay = CDHaLu_DinhMongChanKhay(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoChanKhay, item.CDHaLu_DayDongChay);
                item.CDHaLu_DinhMongRanhThang = CDHaLu_DinhMongRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay);
                item.CDHaLu_DinhMongGop = CDHaLu_DinhMongGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDHaLu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe, item.TTKTHHCongHopRanh_CCaoDe);
                item.CDHaLu_DinhLotRanh = CDHaLu_DinhLotRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DinhMongRanh, item.TTKTHHCongHopRanh_CCaoMong);
                item.CDHaLu_DinhLotCongHop = CDHaLu_DinhLotCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DinhMongCongHop, item.TTKTHHCongHopRanh_CCaoMong);
                item.CDHaLu_DinhLotCongTron = CDHaLu_DinhLotCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DinhMongCongTron, item.ThongTinCauTaoCongTron_CCaoMong);
                item.CDHaLu_DinhLotOngNhua = CDHaLu_DinhLotOngNhua(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi);
                item.CDHaLu_DinhLotGiangDinhRanhThang = CDHaLu_DinhLotGiangDinhRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoGiangDinh, item.CDHaLu_DinhRanhThang, item.ThongTinRanhThang_CCaoMongGiangDinh);
                item.CDHaLu_DinhLotChanKhayRanhThang = CDHaLu_DinhLotChanKhayRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoChanKhay, item.CDHaLu_DayDongChay, item.ThongTinRanhThang_CCaoMongChanKhay);
                item.CDHaLu_DinhLotRanhThang = CDHaLu_DinhLotRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinRanhThang_CCaoMong);
                item.CDHaLu_DinhLotGop = CDHaLu_DinhLotGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinRanhThang_CCaoMong, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.CDHaLu_DinhMongCongTron, item.ThongTinCauTaoCongTron_CCaoMong, item.CDHaLu_DinhMongCongHop, item.TTKTHHCongHopRanh_CCaoMong, item.CDHaLu_DinhMongRanh);
                item.CDHaLu_DayDaoRanhThang = CDHaLu_DayDaoRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DinhLotRanhThang, item.ThongTinRanhThang_CCaoLot, item.CDHaLu_DayDongChay);
                item.CDHaLu_DayDaoChanKhayRanhThang = CDHaLu_DayDaoChanKhayRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoChanKhay, item.CDHaLu_DinhLotChanKhayRanhThang, item.ThongTinRanhThang_CCaoLotChanKhay, item.CDHaLu_DayDongChay);
                item.CDHaLu_DayDaoGiangDinhRanhThang = CDHaLu_DayDaoGiangDinhRanhThang(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinRanhThang_CauTaoGiangDinh, item.CDHaLu_DinhLotGiangDinhRanhThang, item.ThongTinRanhThang_CCaoLotGiangDinh, item.CDHaLu_DinhRanhThang);
                item.CDHaLu_DayDaoOngNhua = CDHaLu_DayDaoOngNhua(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, item.CDHaLu_DinhLotOngNhua, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
                item.CDHaLu_DayDaoRanh = CDHaLu_DayDaoRanh(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.CDHaLu_DinhLotRanh, item.TTKTHHCongHopRanh_CCaoLotMong);
                item.CDHaLu_DayDaoCongHop = CDHaLu_DayDaoCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.TTKTHHCongHopRanh_CCaoDe, item.CDHaLu_DinhLotCongHop, item.TTKTHHCongHopRanh_CCaoLotMong);
                item.CDHaLu_DayDaoCongTron = CDHaLu_DayDaoCongTron(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDHaLu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe, item.CDHaLu_DinhLotCongTron, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.CDHaLu_DayDaoGop = CDHaLu_DayDaoGop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong, item.CDHaLu_DayDongChay, item.ThongTinCauTaoCongTron_CDayPhuBi, item.CDHaLu_DinhDeCong, item.ThongTinCauTaoCongTron_CCaoDe, item.CDHaLu_DinhLotCongTron, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.CDHaLu_ChieuSauDao = CDHaLu_ChieuSauDao(item.CDHaLu_DayDaoGop, item.CDHaLu_HienTrangTruocKhiDaoHaLuu);

                item.TTVLDCongRanh_TLChieuCaoDaoDat = TTVLDCongRanh_TLChieuCaoDaoDat(item.TTVLDCongRanh_LoaiVatLieuDao, item.CDThuongLuu_ChieuSauDao, item.TTVLDCongRanh_TLChieuCaoDaoDa);
                item.TTVLDCongRanh_TLTongChieuSauDao = item.TTVLDCongRanh_TLChieuCaoDaoDa + item.TTVLDCongRanh_TLChieuCaoDaoDat;
                item.TTVLDCongRanh_HLChieuCaoDaoDat = TTVLDCongRanh_HLChieuCaoDaoDat(item.TTVLDCongRanh_LoaiVatLieuDao, item.CDHaLu_ChieuSauDao, item.TTVLDCongRanh_HLChieuCaoDaoDa);
                item.TTVLDCongRanh_HLTongChieuSauDao = item.TTVLDCongRanh_HLChieuCaoDaoDa + item.TTVLDCongRanh_HLChieuCaoDaoDat;

                item.TTCCCCT_CCaoLotDatTLuu = TTCCCCT_CCaoLotDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.TTCCCCT_CCaoLotDatHLuu = TTCCCCT_CCaoLotDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.TTCCCCT_CCaoLotDatMongTBinh = (item.TTCCCCT_CCaoLotDatTLuu + item.TTCCCCT_CCaoLotDatHLuu) / 2;
                item.TTCCCCT_CCaoLotDaTLuu = TTCCCCT_CCaoLotDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCT_CCaoLotDatTLuu, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.TTCCCCT_CCaoLotDaHLuu = TTCCCCT_CCaoLotDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCT_CCaoLotDatHLuu, item.ThongTinCauTaoCongTron_CCaoLotMong);
                item.TTCCCCT_CCaoLotDaMongTBinh = (item.TTCCCCT_CCaoLotDaTLuu + item.TTCCCCT_CCaoLotDaHLuu) / 2;
                item.TTCCCCT_CCaoMongDatTLuu = TTCCCCT_CCaoMongDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong);
                item.TTCCCCT_CCaoMongDatHLuu = TTCCCCT_CCaoMongDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong);
                item.TTCCCCT_CCaoMongDatTBinh = (item.TTCCCCT_CCaoMongDatTLuu + item.TTCCCCT_CCaoMongDatHLuu) / 2;
                item.TTCCCCT_CCaoMongDaTLuu = TTCCCCT_CCaoMongDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCT_CCaoMongDatTLuu, item.TTCCCCT_CCaoLotDaTLuu);
                item.TTCCCCT_CCaoMongDaHLuu = TTCCCCT_CCaoMongDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCT_CCaoMongDatHLuu, item.TTCCCCT_CCaoLotDaHLuu);
                item.TTCCCCT_CCaoMongDaTBinh = (item.TTCCCCT_CCaoMongDaTLuu + item.TTCCCCT_CCaoMongDaHLuu) / 2;
                item.TTCCCCT_CCaoDeDatTLuu = TTCCCCT_CCaoDeDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe);
                item.TTCCCCT_CCaoDeDatHLuu = TTCCCCT_CCaoDeDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe);
                item.TTCCCCT_CCaoDeDatTBinh = (item.TTCCCCT_CCaoDeDatTLuu + item.TTCCCCT_CCaoDeDatHLuu) / 2;
                item.TTCCCCT_CCaoDeDaTLuu = TTCCCCT_CCaoDeDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCT_CCaoDeDatTLuu, item.TTCCCCT_CCaoLotDaTLuu, item.TTCCCCT_CCaoMongDaTLuu);
                item.TTCCCCT_CCaoDeDaHLuu = TTCCCCT_CCaoDeDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCT_CCaoDeDatHLuu, item.TTCCCCT_CCaoLotDaHLuu, item.TTCCCCT_CCaoMongDaHLuu);
                item.TTCCCCT_CCaoDeDaTBinh = (item.TTCCCCT_CCaoDeDaTLuu + item.TTCCCCT_CCaoDeDaHLuu) / 2;
                item.TTCCCCT_CCaoCongDatTLuu = TTCCCCT_CCaoCongDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe, item.ThongTinCauTaoCongTron_TongCCaoCong);
                item.TTCCCCT_CCaoCongDatHLuu = TTCCCCT_CCaoCongDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe, item.ThongTinCauTaoCongTron_TongCCaoCong);
                item.TTCCCCT_CCongCongDatTBinh = (item.TTCCCCT_CCaoCongDatTLuu + item.TTCCCCT_CCaoCongDatHLuu) / 2;
                item.TTCCCCT_CCaoCongDaTLuu = TTCCCCT_CCaoCongDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCT_CCaoCongDatTLuu, item.ThongTinCauTaoCongTron_CCaoCauKien, item.ThongTinCauTaoCongTron_TongCCaoCong, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe, item.TTCCCCT_CCaoLotDaTLuu, item.TTCCCCT_CCaoMongDaTLuu, item.TTCCCCT_CCaoDeDaTLuu);
                item.TTCCCCT_CCaoCongDaHLuu = TTCCCCT_CCaoCongDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCT_CCaoCongDatHLuu, item.ThongTinCauTaoCongTron_CCaoCauKien, item.ThongTinCauTaoCongTron_TongCCaoCong, item.ThongTinCauTaoCongTron_CCaoLotMong, item.ThongTinCauTaoCongTron_CCaoMong, item.ThongTinCauTaoCongTron_CCaoDe, item.TTCCCCT_CCaoLotDaHLuu, item.TTCCCCT_CCaoMongDaHLuu, item.TTCCCCT_CCaoDeDaHLuu);
                item.TTCCCCT_CCongCongDaTBinh = (item.TTCCCCT_CCaoCongDaTLuu + item.TTCCCCT_CCaoCongDaHLuu) / 2;

                item.TTCCCCCHR_CCaoLotDatTLuu = TTCCCCCHR_CCaoLotDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.TTKTHHCongHopRanh_CCaoLotMong);
                item.TTCCCCCHR_CCaoLotDatHLuu = TTCCCCCHR_CCaoLotDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.TTKTHHCongHopRanh_CCaoLotMong);
                item.TTCCCCCHR_CCaoLotDatTBinh = (item.TTCCCCCHR_CCaoLotDatTLuu + item.TTCCCCCHR_CCaoLotDatHLuu) / 2;
                item.TTCCCCCHR_CCaoLotDaTLuu = TTCCCCCHR_CCaoLotDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTCCCCCHR_CCaoLotDatTLuu);
                item.TTCCCCCHR_CCaoLotDaHLuu = TTCCCCCHR_CCaoLotDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTCCCCCHR_CCaoLotDatHLuu);
                item.TTCCCCCHR_CCaoLotDaTBinh = (item.TTCCCCCHR_CCaoLotDaTLuu + item.TTCCCCCHR_CCaoLotDaHLuu) / 2;
                item.TTCCCCCHR_CCaoMongDatTLuu = TTCCCCCHR_CCaoMongDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong);
                item.TTCCCCCHR_CCaoMongDatHLuu = TTCCCCCHR_CCaoMongDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong);
                item.TTCCCCCHR_CCaoMongDatTBinh = (item.TTCCCCCHR_CCaoMongDatTLuu + item.TTCCCCCHR_CCaoMongDatHLuu) / 2;
                item.TTCCCCCHR_CCaoMongDaTLuu = TTCCCCCHR_CCaoMongDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCCHR_CCaoMongDatTLuu, item.TTCCCCCHR_CCaoLotDaTLuu);
                item.TTCCCCCHR_CCaoMongDaHLuu = TTCCCCCHR_CCaoMongDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCCHR_CCaoMongDatHLuu, item.TTCCCCCHR_CCaoLotDaHLuu);
                item.TTCCCCCHR_CCaoMongDaTBinh = (item.TTCCCCCHR_CCaoMongDaTLuu + item.TTCCCCCHR_CCaoMongDaHLuu) / 2;
                item.TTCCCCCHR_CCaoTuongDatTLuu = TTCCCCCHR_CCaoTuongDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTKTHHCongHopRanh_TongChieuCao);
                item.TTCCCCCHR_CCaoTuongDatHLuu = TTCCCCCHR_CCaoTuongDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTKTHHCongHopRanh_TongChieuCao);
                item.TTCCCCCHR_CCaoTuongDatTBinh = (item.TTCCCCCHR_CCaoTuongDatTLuu + item.TTCCCCCHR_CCaoTuongDatHLuu) / 2;
                item.TTCCCCCHR_CCaoTuongDaTLuu = TTCCCCCHR_CCaoTuongDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTKTHHCongHopRanh_TongChieuCao, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCCHR_CCaoTuongDatTLuu, item.TTCCCCCHR_CCaoLotDaTLuu, item.TTCCCCCHR_CCaoMongDaTLuu);
                item.TTCCCCCHR_CCaoTuongDaHLuu = TTCCCCCHR_CCaoTuongDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTKTHHCongHopRanh_CCaoLotMong, item.TTKTHHCongHopRanh_CCaoMong, item.TTKTHHCongHopRanh_TongChieuCao, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCCHR_CCaoTuongDatHLuu, item.TTCCCCCHR_CCaoLotDaHLuu, item.TTCCCCCHR_CCaoMongDaHLuu);
                item.TTCCCCCHR_CCaoTuongDaTBinh = (item.TTCCCCCHR_CCaoTuongDaTLuu + item.TTCCCCCHR_CCaoTuongDaHLuu) / 2;
                item.TTCCCCON_CCaoDemCatDatTLuu = TTCCCCON_CCaoDemCatDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
                item.TTCCCCON_CCaoDemCatDatHLuu = TTCCCCON_CCaoDemCatDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
                item.TTCCCCON_CCaoDemCatDatTBinh = (item.TTCCCCON_CCaoDemCatDatTLuu + item.TTCCCCON_CCaoDemCatDatHLuu) / 2;
                item.TTCCCCON_CCaoDemCatDaTLuu = TTCCCCON_CCaoDemCatDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTVLDCongRanh_TLTongChieuSauDao, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.TTCCCCON_CCaoDemCatDatTLuu);
                item.TTCCCCON_CCaoDemCatDaHLuu = TTCCCCON_CCaoDemCatDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTVLDCongRanh_HLTongChieuSauDao, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.TTCCCCON_CCaoDemCatDatHLuu);
                item.TTCCCCON_CCaoDemCatDaTBinh = (item.TTCCCCON_CCaoDemCatDaTLuu + item.TTCCCCON_CCaoDemCatDaHLuu) / 2;
                item.TTCCCCON_CCaoOngDatTLuu = TTCCCCON_CCaoOngDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng);
                item.TTCCCCON_CCaoOngDatHLuu = TTCCCCON_CCaoOngDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng);
                item.TTCCCCON_CCaoDatTBinh = (item.TTCCCCON_CCaoOngDatTLuu + item.TTCCCCON_CCaoOngDatHLuu) / 2;
                item.TTCCCCON_CCaoOngDaTLuu = TTCCCCON_CCaoOngDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCON_CCaoOngDatTLuu, item.TTCCCCON_CCaoDemCatDaTLuu);
                item.TTCCCCON_CCaoOngDaHLuu = TTCCCCON_CCaoOngDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCON_CCaoOngDatHLuu, item.TTCCCCON_CCaoDemCatDaHLuu);
                item.TTCCCCON_CCaoDaTBinh = (item.TTCCCCON_CCaoOngDaTLuu + item.TTCCCCON_CCaoOngDaHLuu) / 2;
                item.TTCCCCON_CCaoDapCatDatTLuu = TTCCCCON_CCaoDapCatDatTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat);
                item.TTCCCCON_CCaoDapCatDatHLuu = TTCCCCON_CCaoDapCatDatHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat);
                item.TTCCCCON_CCaoDapCatDatTBinh = (item.TTCCCCON_CCaoDapCatDatTLuu + item.TTCCCCON_CCaoDapCatDatHLuu) / 2;
                item.TTCCCCON_CCaoDapCatDaTLuu = TTCCCCON_CCaoDapCatDaTLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCCCON_CCaoDapCatDatTLuu, item.TTCCCCON_CCaoDemCatDaTLuu, item.TTCCCCON_CCaoOngDaTLuu);
                item.TTCCCCON_CCaoDapCatDaHLuu = TTCCCCON_CCaoDapCatDaHLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCCCON_CCaoDapCatDatHLuu, item.TTCCCCON_CCaoDemCatDaTLuu, item.TTCCCCON_CCaoOngDaTLuu);
                item.TTCCCCON_CCaoDapCatDaTBinh = (item.TTCCCCON_CCaoDapCatDaTLuu + item.TTCCCCON_CCaoDapCatDaHLuu) / 2;
                item.TTCCRT_LotDatThuongLuu = TTCCRT_LotDatThuongLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinRanhThang_CCaoLot);
                item.TTCCRT_LotDatHaLuu = TTCCRT_LotDatHaLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinRanhThang_CCaoLot);
                item.TTCCRT_LotDatTrungBinh = (item.TTCCRT_LotDatThuongLuu + item.TTCCRT_LotDatHaLuu) / 2;
                item.TTCCRT_LotDaThuongLuu = TTCCRT_LotDaThuongLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.TTVLDCongRanh_TLTongChieuSauDao, item.ThongTinRanhThang_CCaoLot, item.TTCCRT_LotDatThuongLuu);
                item.TTCCRT_LotDaHaLuu = TTCCRT_LotDaHaLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.TTVLDCongRanh_HLTongChieuSauDao, item.ThongTinRanhThang_CCaoLot, item.TTCCRT_LotDatHaLuu);
                item.TTCCRT_LotDaTrungBinh = (item.TTCCRT_LotDaThuongLuu + item.TTCCRT_LotDaHaLuu) / 2;
                item.TTCCRT_MongDatThuongLuu = TTCCRT_MongDatThuongLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDat, item.ThongTinRanhThang_CCaoLot, item.ThongTinRanhThang_CCaoMong);
                item.TTCCRT_MongDatHaLuu = TTCCRT_MongDatHaLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDat, item.ThongTinRanhThang_CCaoLot, item.ThongTinRanhThang_CCaoMong);
                item.TTCCRT_MongDatTrungBinh = (item.TTCCRT_MongDatThuongLuu + item.TTCCRT_MongDatHaLuu) / 2;
                item.TTCCRT_MongDaThuongLuu = TTCCRT_MongDaThuongLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_TLChieuCaoDaoDa, item.ThongTinRanhThang_CCaoLot, item.ThongTinRanhThang_CCaoMong, item.TTVLDCongRanh_TLTongChieuSauDao, item.TTCCRT_MongDatThuongLuu, item.TTCCRT_LotDaThuongLuu);
                item.TTCCRT_MongDaHaLuu = TTCCRT_MongDaHaLuu(item.TTVLDCongRanh_LoaiVatLieuDao, item.TTVLDCongRanh_HLChieuCaoDaoDa, item.ThongTinRanhThang_CCaoLot, item.ThongTinRanhThang_CCaoMong, item.TTVLDCongRanh_HLTongChieuSauDao, item.TTCCRT_MongDatHaLuu, item.TTCCRT_LotDaHaLuu);
                item.TTCCRT_MongDaTrungBinh = (item.TTCCRT_MongDaThuongLuu + item.TTCCRT_MongDaHaLuu) / 2;

                item.TKLD_KlDaoDat = TKLD_KlDaoDat(item.DTDTLCRONRT_DTichDaoDat, item.DTDHLCRONRT_DTichDaoDat, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_KlDaoDa = TKLD_KlDaoDa(item.DTDTLCRONRT_DTichDaoDa, item.DTDHLCRONRT_DTichDaoDa, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_TongKlDaoCongRanhOngNhuaRanhThang = TKLD_TongKlDaoCongRanhOngNhuaRanhThang(item.TKLD_KlDaoDat, item.TKLD_KlDaoDa);
                item.TKLD_ChanKhay = TKLD_ChanKhay(item.DTDCKRD_CKDTichDao, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_GiangDinh = TKLD_GiangDinh(item.DTDCKRD_DTichDao, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_TongKlDaoDatChanKhayRanhDinh = (item.TKLD_ChanKhay + item.TKLD_GiangDinh);
                item.TKLD_TongKlDaoDat = TKLD_TongKlDaoDat(item.TKLD_KlDaoDat, item.TKLD_TongKlDaoDatChanKhayRanhDinh);
                item.TKLD_TongKlDaoDa = TKLD_TongKlDaoDa(item.TKLD_KlDaoDa);
                item.TKLD_TongKlDao = TKLD_TongKlDao(item.TKLD_TongKlDaoDat, item.TKLD_TongKlDaoDa);
                item.TKLD_KlCChoDatCongTron = TKLD_KlCChoDatCongTron(item.TTCCCCT_CCaoLotDatMongTBinh, item.ThongTinCauTaoCongTron_CRongLotMong, item.ThongTinCauTaoCongTron_CRongMong, item.TTCCCCT_CCaoMongDatTBinh, item.TTCCCCT_CCongCongDatTBinh, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai, item.TTCCCCT_CCaoDeDatTBinh, item.ThongTinDeCong_Kl01DeCong, item.ThongTinDeCong_TongSoLuongDC);
                item.TKLD_KlCChoDaCongTron = TKLD_KlCChoDaCongTron(item.TTCCCCT_CCaoLotDaMongTBinh, item.ThongTinCauTaoCongTron_CRongLotMong, item.ThongTinCauTaoCongTron_CRongMong, item.TTCCCCT_CCaoMongDaTBinh, item.TTCCCCT_CCongCongDaTBinh, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai, item.TTCCCCT_CCaoDeDaTBinh, item.ThongTinDeCong_Kl01DeCong, item.ThongTinDeCong_TongSoLuongDC);
                item.TKLD_TongKlChiemChoCTron = TKLD_TongKlChiemChoCTron(item.TKLD_KlCChoDatCongTron, item.TKLD_KlCChoDaCongTron);
                item.TKLD_KlCChoDatCongHop = TKLD_KlCChoDatCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCCCCCHR_CCaoLotDatTBinh, item.TTKTHHCongHopRanh_CRongLotMong, item.TTKTHHCongHopRanh_CRongMong, item.TTCCCCCHR_CCaoMongDatTBinh, item.TTCCCCCHR_CCaoTuongDatTBinh, item.TTKTHHCongHopRanh_CDayTuong01Ben, item.TTKTHHCongHopRanh_SoLuongTuong, item.TTKTHHCongHopRanh_CRongLongSuDung, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_KlCChoDaCongHop = TKLD_KlCChoDaCongHop(item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.TTCCCCCHR_CCaoLotDaTBinh, item.TTKTHHCongHopRanh_CRongLotMong, item.TTKTHHCongHopRanh_CRongMong, item.TTCCCCCHR_CCaoMongDaTBinh, item.TTCCCCCHR_CCaoTuongDaTBinh, item.TTKTHHCongHopRanh_CDayTuong01Ben, item.TTKTHHCongHopRanh_SoLuongTuong, item.TTKTHHCongHopRanh_CRongLongSuDung, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_TongKlCChoCongHop = TKLD_TongKlCChoCongHop(item.TKLD_KlCChoDatCongHop, item.TKLD_KlCChoDaCongHop);
                item.TKLD_KlCChoDatRanh = TKLD_KlCChoDatRanh(item.TTCCCCCHR_CCaoLotDatTBinh, item.TTKTHHCongHopRanh_CRongLotMong, item.TTKTHHCongHopRanh_CRongMong, item.TTCCCCCHR_CCaoMongDatTBinh, item.TTCCCCCHR_CCaoTuongDatTBinh, item.TTKTHHCongHopRanh_CDayTuong01Ben, item.TTKTHHCongHopRanh_SoLuongTuong, item.TTKTHHCongHopRanh_CRongLongSuDung, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai, item.ThongTinDuongTruyenDan_HinhThucTruyenDan);
                item.TKLD_KlCChoDaRanh = TKLD_KlCChoDaRanh(item.TTCCCCCHR_CCaoLotDaTBinh, item.TTKTHHCongHopRanh_CRongLotMong, item.TTKTHHCongHopRanh_CRongMong, item.TTCCCCCHR_CCaoMongDaTBinh, item.TTCCCCCHR_CCaoTuongDaTBinh, item.TTKTHHCongHopRanh_CDayTuong01Ben, item.TTKTHHCongHopRanh_SoLuongTuong, item.TTKTHHCongHopRanh_CRongLongSuDung, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai, item.ThongTinDuongTruyenDan_HinhThucTruyenDan);
                item.TKLD_TongKlCChoRanh = TKLD_TongKlCChoRanh(item.TKLD_KlCChoDatRanh, item.TKLD_KlCChoDaRanh);
                item.TKLD_KlCChoDatOngNhua = TKLD_KlCChoDatOngNhua(item.TTCCCCON_CCaoDemCatDatTBinh, item.TTCCCCON_CCaoDatTBinh, item.TTCCCCON_CCaoDapCatDatTBinh, item.TTMDRanhOngThang_TyLeMoMai, item.TTMDRanhOngThang_SoCanhMaiTrai, item.TTMDRanhOngThang_SoCanhMaiPhai, item.TTMDRanhOngThang_ChieuRongDayDaoNho, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_KlCChoDaOngNhua = TKLD_KlCChoDaOngNhua(item.TTCCCCON_CCaoDemCatDaTBinh, item.TTCCCCON_CCaoDaTBinh, item.TTCCCCON_CCaoDapCatDaTBinh, item.TTMDRanhOngThang_TyLeMoMai, item.TTMDRanhOngThang_SoCanhMaiTrai, item.TTMDRanhOngThang_SoCanhMaiPhai, item.TTMDRanhOngThang_ChieuRongDayDaoNho, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_TongKlCChoOngNhua = TKLD_TongKlCChoOngNhua(item.TKLD_KlCChoDatOngNhua, item.TKLD_KlCChoDaOngNhua);
                item.TKLD_KlCChoDatRanhThang = TKLD_KlCChoDatRanhThang(item.TTCCRT_LotDatTrungBinh, item.ThongTinRanhThang_CRongLot, item.ThongTinRanhThang_CRongMong, item.TTCCRT_MongDatTrungBinh, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_KlCChoDaRanhThang = TKLD_KlCChoDaRanhThang(item.TTCCRT_LotDaTrungBinh, item.ThongTinRanhThang_CRongLot, item.ThongTinRanhThang_CRongMong, item.TTCCRT_MongDaTrungBinh, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_TongKlCChoRanhThang = TKLD_TongKlCChoRanhThang(item.TKLD_KlCChoDatRanhThang, item.TKLD_KlCChoDaRanhThang);
                item.TKLD_KlCChoDatChanKhay = TKLD_KlCChoDatChanKhay(item.ThongTinRanhThang_CCaoLotChanKhay, item.ThongTinRanhThang_CRongLotChanKhay, item.ThongTinRanhThang_SoLuongLotChanKhay, item.ThongTinRanhThang_CCaoMongChanKhay, item.ThongTinRanhThang_CRongMongChanKhay, item.ThongTinRanhThang_SoLuongMongChanKhay, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_KlCChoDatChanGiangDinh = TKLD_KlCChoDatChanGiangDinh(item.ThongTinRanhThang_CCaoLotGiangDinh, item.ThongTinRanhThang_CRongLotGiangDinh, item.ThongTinRanhThang_SoLuongLotGiangDinh, item.ThongTinRanhThang_CCaoMongGiangDinh, item.ThongTinRanhThang_CRongMongGiangDinh, item.ThongTinRanhThang_SoLuongMongGiangDinh, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TKLD_TongKlCChoDat = TKLD_TongKlCChoDat(item.TKLD_KlCChoDatRanhThang, item.TKLD_KlCChoDatChanKhay, item.TKLD_KlCChoDatChanGiangDinh);
                item.TKLD_TongKlCChoDa = TKLD_TongKlCChoDa(item.TKLD_KlCChoDaRanhThang);
                item.TKLD_TongKlCCho = TKLD_TongKlCCho(item.TKLD_TongKlCChoDat, item.TKLD_TongKlCChoDa);
                item.TKLD_KlCChoDat = TKLD_KlCChoDat(item.TKLD_KlCChoDatCongTron, item.TKLD_KlCChoDatCongHop, item.TKLD_KlCChoDatRanh, item.TKLD_KlCChoDatOngNhua, item.TKLD_TongKlCChoDat);
                item.TKLD_KlCChoDa = TKLD_KlCChoDa(item.TKLD_KlCChoDaCongTron, item.TKLD_KlCChoDaCongHop, item.TKLD_KlCChoDaRanh, item.TKLD_KlCChoDaOngNhua, item.TKLD_TongKlCChoDa);
                item.TKLD_TongChiemCho = TKLD_TongChiemCho(item.TKLD_KlCChoDat, item.TKLD_KlCChoDa);
                item.TKLD_KlDapTraDat = TKLD_KlDapTraDat(item.TKLD_TongKlDaoDat, item.TKLD_KlCChoDat);
                item.TKLD_KlDapTraDa = TKLD_KlDapTraDa(item.TKLD_TongKlDaoDa, item.TKLD_KlCChoDa);
                item.TKLD_TongKlDapTra = TKLD_TongKlDapTra(item.TKLD_KlDapTraDat, item.TKLD_KlDapTraDa);
                item.TKLD_KlThuaDat = item.TKLD_KlCChoDat;
                item.TKLD_KlThuaDa = item.TKLD_KlCChoDa;
                item.TKLD_TongKLThua = item.TKLD_TongChiemCho;
                item.DTDC_TLCSauDap = DTDC_TLCSauDap(item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.DTDC_TLCRongDapDayLon = DTDC_TLCRongDapDayLon(item.DTDC_TLCSauDap, item.TTMDRanhOngThang_TyLeMoMai, item.TTMDRanhOngThang_SoCanhMaiTrai, item.TTMDRanhOngThang_SoCanhMaiPhai, item.TTMDRanhOngThang_ChieuRongDayDaoNho, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.DTDC_TLDTichDap = DTDC_TLDTichDap(item.DTDC_TLCRongDapDayLon, item.TTMDRanhOngThang_ChieuRongDayDaoNho, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.DTDC_HLCSauDap = DTDC_HLCSauDap(item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.DTDC_HLCRongDapDayLon = DTDC_HLCRongDapDayLon(item.DTDC_HLCSauDap, item.TTMDRanhOngThang_TyLeMoMai, item.TTMDRanhOngThang_SoCanhMaiTrai, item.TTMDRanhOngThang_SoCanhMaiPhai, item.TTMDRanhOngThang_ChieuRongDayDaoNho, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.DTDC_HLDTichDap = DTDC_HLDTichDap(item.DTDC_HLCRongDapDayLon, item.TTMDRanhOngThang_ChieuRongDayDaoNho, item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, item.ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.TTKLDC_KlDapCatTruocChiemCho = TTKLDC_KlDapCatTruocChiemCho(item.DTDC_TLDTichDap, item.DTDC_HLDTichDap, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai);
                item.TTKLDC_KlChiemCho = TTKLDC_KlChiemCho(item.ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, item.TTCDSLCauKienDuongTruyenDan_TongChieuDai, item.ThongTinDuongTruyenDan_HinhThucTruyenDan, item.ThongTinMongDuongTruyenDan_LoaiMong);
                item.TTKLDC_KlDapCatSauChiemCho = item.TTKLDC_KlDapCatTruocChiemCho - item.TTKLDC_KlChiemCho;
            });
        }
        return list;
    }

    public double ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao(double ThongTinCaoDoHoGa_CaoDoTuNhien, double ThongTinCaoDoHoGa_CaoDoDinhK98, double ThongTinCaoDoHoGa_CdDinhViaHeHoanThien)
    {
        double result;

        if (ThongTinCaoDoHoGa_CaoDoTuNhien < ThongTinCaoDoHoGa_CaoDoDinhK98)
        {
            result = ThongTinCaoDoHoGa_CaoDoDinhK98;
        }
        else if (ThongTinCaoDoHoGa_CaoDoTuNhien >= ThongTinCaoDoHoGa_CdDinhViaHeHoanThien)
        {
            result = ThongTinCaoDoHoGa_CdDinhViaHeHoanThien;
        }
        else
        {
            result = ThongTinCaoDoHoGa_CaoDoTuNhien;
        }

        return Math.Round(result, 2);
    }

    public double ThongTinCaoDoHoGa_CdDinhMong(string ThongTinChungHoGa_HinhThucHoGa, string ThongTinChungHoGa_HinhThucMongHoGa, double ThongTinCaoDoHoGa_CdDayHoGa, double DeHoGa_C)
    {
        ThongTinChungHoGa_HinhThucHoGa = GetTenDanhMucById(ThongTinChungHoGa_HinhThucHoGa);
        ThongTinChungHoGa_HinhThucMongHoGa = GetTenDanhMucById(ThongTinChungHoGa_HinhThucMongHoGa);
        if (ThongTinChungHoGa_HinhThucHoGa.ToUpper().Trim() == "Lắp đặt".ToUpper()
        && ThongTinChungHoGa_HinhThucMongHoGa.ToUpper().Trim() == "Có móng".ToUpper())
        {
            return ThongTinCaoDoHoGa_CdDayHoGa - DeHoGa_C;
        }
        else
        {
            return ThongTinCaoDoHoGa_CdDayHoGa;
        }
    }

    public double ThongTinCaoDoHoGa_DinhLotMong(string ThongTinChungHoGa_HinhThucMongHoGa, double ThongTinCaoDoHoGa_CdDinhMong, double TBeTongMongHoGa_C)
    {
        if (ThongTinChungHoGa_HinhThucMongHoGa == "Không có móng")
        {
            return 0;
        }
        else
        {
            return ThongTinCaoDoHoGa_CdDinhMong - TBeTongMongHoGa_C;
        }
    }

    public double ThongTinCaoDoHoGa_DayDao(string ThongTinChungHoGa_HinhThucHoGa, string ThongTinChungHoGa_HinhThucMongHoGa, double ThongTinCaoDoHoGa_DinhLotMong, double BeTongLotMong_C, double ThongTinCaoDoHoGa_CdDayHoGa, double DeHoGa_C)
    {
        double result;
        ThongTinChungHoGa_HinhThucMongHoGa = GetTenDanhMucById(ThongTinChungHoGa_HinhThucMongHoGa).ToUpper().Trim();
        ThongTinChungHoGa_HinhThucHoGa = GetTenDanhMucById(ThongTinChungHoGa_HinhThucHoGa).ToUpper().Trim();
        if (ThongTinChungHoGa_HinhThucMongHoGa == "Có móng".ToUpper())
        {
            result = ThongTinCaoDoHoGa_DinhLotMong - BeTongLotMong_C;
        }
        else if (ThongTinChungHoGa_HinhThucHoGa == "Lắp đặt".ToUpper() && ThongTinChungHoGa_HinhThucMongHoGa == "Không có móng".ToUpper())
        {
            result = ThongTinCaoDoHoGa_CdDayHoGa - DeHoGa_C;
        }
        else
        {
            result = ThongTinCaoDoHoGa_CdDayHoGa;
        }

        return Math.Round(result, 2);
    }
    public double ThongTinCaoDoHoGa_CSauDao(double ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao, double ThongTinCaoDoHoGa_DayDao)
    {
        return Math.Round(ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao - ThongTinCaoDoHoGa_DayDao, 2);
    }
    public double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinCaoDoHoGa_CSauDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa)
    {
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();
        if (string.IsNullOrEmpty(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao))
        {
            return 0;
        }
        else if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            return 0;
        }
        else
        {
            return ThongTinCaoDoHoGa_CSauDao - ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa;
        }
    }

    public double ChatMatNgoaiCanh_C(string ThongTinChungHoGa_ChatMatNgoai, string ThongTinChungHoGa_KetCauTuong, string ThongTinChungHoGa_KetCauMuMo, double TuongHoGa_C, double DamGiuaHoGa_CdDam, double MuMoThotDuoi_C, double MuMoThotTren_C, double MuMoThotTren_CdTuong)
    {
        ThongTinChungHoGa_KetCauMuMo = GetTenDanhMucById(ThongTinChungHoGa_KetCauMuMo).ToUpper().Trim();
        ThongTinChungHoGa_KetCauTuong = GetTenDanhMucById(ThongTinChungHoGa_KetCauTuong).ToLower().Trim();
        ThongTinChungHoGa_ChatMatNgoai = GetTenDanhMucById(ThongTinChungHoGa_ChatMatNgoai).ToLower().Trim();

        if (ThongTinChungHoGa_ChatMatNgoai == "Có".ToUpper() && ThongTinChungHoGa_KetCauTuong == "Tường xây gạch".ToUpper())
        {
            if (ThongTinChungHoGa_KetCauMuMo == "Mũ mố xây gạch".ToUpper())
            {
                return TuongHoGa_C + DamGiuaHoGa_CdDam + MuMoThotDuoi_C + MuMoThotTren_C + MuMoThotTren_CdTuong;
            }
            else
            {
                return TuongHoGa_C + DamGiuaHoGa_CdDam;
            }
        }
        else if (ThongTinChungHoGa_ChatMatNgoai == "Có".ToUpper() && ThongTinChungHoGa_KetCauTuong == "Tường bê tông".ToUpper())
        {
            if (ThongTinChungHoGa_KetCauMuMo == "Mũ mố xây gạch".ToUpper())
            {
                return MuMoThotTren_C + MuMoThotTren_CdTuong;
            }
            else
            {
                return 0;
            }
        }
        else if (ThongTinChungHoGa_ChatMatNgoai == "Không".ToUpper() && ThongTinChungHoGa_KetCauMuMo == "Mũ mố xây gạch".ToUpper())
        {
            return MuMoThotTren_C + MuMoThotTren_CdTuong;
        }
        else
        {
            return 0;
        }
    }
    public double ThongTinCaoDoHoGa_TongChieuCaoHoGa(double ThongTinCaoDoHoGa_CdDinhHoGa, double ThongTinCaoDoHoGa_DayDao)
    {
        return Math.Round(ThongTinCaoDoHoGa_CdDinhHoGa - ThongTinCaoDoHoGa_DayDao, 2);
    }
    public double ThongTinCaoDoHoGa_ChenhCaoDinhHoGaVaHienTrangDao(double ThongTinCaoDoHoGa_CdDinhHoGa, double ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao)
    {
        return Math.Round(ThongTinCaoDoHoGa_CdDinhHoGa - ThongTinCaoDoHoGa_CaoDoHienTrangTruocKhiDao, 2);
    }
    public double ThongTinCaoDoHoGa_DinhMuMoThotDuoi(double ThongTinCaoDoHoGa_CdDinhHoGa, double MuMoThotTren_C)
    {
        return Math.Round(ThongTinCaoDoHoGa_CdDinhHoGa - MuMoThotTren_C, 2);
    }

    public double ThongTinCaoDoHoGa_DinhTuong(double ThongTinCaoDoHoGa_DinhMuMoThotDuoi, double MuMoThotDuoi_C)
    {
        return Math.Round(ThongTinCaoDoHoGa_DinhMuMoThotDuoi - MuMoThotDuoi_C, 2);
    }

    public double ThongTinCaoDoHoGa_DinhDamGiuaTuong(double DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa, double ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong, double DamGiuaHoGa_C)
    {
        return Math.Round(DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa > 0 ? ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong + DamGiuaHoGa_C : 0, 2);
    }

    public double ThongTinCaoDoHoGa_DinhTuongDuoiDamGiuaTuong(double DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa, double ThongTinCaoDoHoGa_CdDayHoGa)
    {
        return Math.Round(DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa > 0 ? ThongTinCaoDoHoGa_CdDayHoGa + DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa : 0, 2);
    }

    public double ThongTinCaoDoHoGa_CCaoTuong(double DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa, double ThongTinCaoDoHoGa_DinhTuong, double ThongTinCaoDoHoGa_CdDayHoGa, double DamGiuaHoGa_C)
    {
        double ketQua = DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa > 0 ? ThongTinCaoDoHoGa_DinhTuong - ThongTinCaoDoHoGa_CdDayHoGa - DamGiuaHoGa_C : ThongTinCaoDoHoGa_DinhTuong - ThongTinCaoDoHoGa_CdDayHoGa;
        return Math.Round(ketQua, 2);
    }

    public double TTCCCCDTHT_ChieuCaoLotDat(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, double BeTongLotMong_C)
    {
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();
        double ketQua = 0;

        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất".ToUpper() || ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat >= BeTongLotMong_C ? BeTongLotMong_C : ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat;
        }

        return Math.Round(ketQua, 2);
    }

    public double TTCCCCDTHT_ChieuCaoMongDat(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, double BeTongLotMong_C, double TBeTongMongHoGa_C)
    {
        double ketQua = 0;
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();

        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất".ToUpper() || ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat <= BeTongLotMong_C)
            {
                ketQua = 0;
            }
            else if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat >= BeTongLotMong_C + TBeTongMongHoGa_C)
            {
                ketQua = TBeTongMongHoGa_C;
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat - BeTongLotMong_C;
            }
        }

        return Math.Round(ketQua, 2);
    }

    public double TTCCCCDTHT_ChieuCaoTuongDat(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, double BeTongLotMong_C, double TBeTongMongHoGa_C, double TuongHoGa_C, double DamGiuaHoGa_C, double MuMoThotDuoi_C, double MuMoThotTren_C)
    {
        double ketQua = 0;
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();
        double tongThem = TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C;
        double gioiHanTren = BeTongLotMong_C + TBeTongMongHoGa_C + TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C;

        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất".ToUpper() || ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat <= BeTongLotMong_C + TBeTongMongHoGa_C)
            {
                ketQua = 0;
            }
            else if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat >= gioiHanTren)
            {
                ketQua = tongThem;
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat - (BeTongLotMong_C + TBeTongMongHoGa_C);
            }
        }

        return Math.Round(ketQua, 2);
    }

    public double TTCCCCDTHT_ChieuCaoLotDa(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, double ThongTinVatLieuDaoHoGa_TongChieuCaoDao, double TTCCCCDTHT_ChieuCaoLotDat, double BeTongLotMong_C)
    {
        double ketQua = 0;

        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();

        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa >= BeTongLotMong_C ? BeTongLotMong_C : ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa;
        }
        else if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + Đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_TongChieuCaoDao >= BeTongLotMong_C)
            {
                ketQua = TTCCCCDTHT_ChieuCaoLotDat < BeTongLotMong_C ? BeTongLotMong_C - TTCCCCDTHT_ChieuCaoLotDat : 0;
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa;
            }
        }

        return Math.Round(ketQua, 2);
    }

    public double TTCCCCDTHT_ChieuCaoMongDa(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, double ThongTinVatLieuDaoHoGa_TongChieuCaoDao, double TTCCCCDTHT_ChieuCaoMongDat, double TTCCCCDTHT_ChieuCaoLotDa, double BeTongLotMong_C, double TBeTongMongHoGa_C)
    {
        double ketQua = 0;
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();
        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa <= BeTongLotMong_C)
            {
                ketQua = 0;
            }
            else if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa >= BeTongLotMong_C + TBeTongMongHoGa_C)
            {
                ketQua = TBeTongMongHoGa_C;
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa - BeTongLotMong_C;
            }
        }
        else if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + Đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_TongChieuCaoDao >= BeTongLotMong_C + TBeTongMongHoGa_C)
            {
                if (TTCCCCDTHT_ChieuCaoMongDat < TBeTongMongHoGa_C)
                {
                    ketQua = TBeTongMongHoGa_C - TTCCCCDTHT_ChieuCaoMongDat;
                }
                else
                {
                    ketQua = 0;
                }
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa - TTCCCCDTHT_ChieuCaoLotDa;
            }
        }

        return Math.Round(ketQua, 2);
    }

    public double TTCCCCDTHT_ChieuCaoTuongDa(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, double ThongTinVatLieuDaoHoGa_TongChieuCaoDao, double TTCCCCDTHT_ChieuCaoTuongDat, double TTCCCCDTHT_ChieuCaoLotDa, double TTCCCCDTHT_ChieuCaoMongDa, double BeTongLotMong_C, double TBeTongMongHoGa_C, double TuongHoGa_C, double DamGiuaHoGa_C, double MuMoThotDuoi_C, double MuMoThotTren_C)
    {
        double ketQua = 0;
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();
        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa <= BeTongLotMong_C + TBeTongMongHoGa_C)
            {
                ketQua = 0;
            }
            else if (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa >= BeTongLotMong_C + TBeTongMongHoGa_C + TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C)
            {
                ketQua = TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C;
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa - (BeTongLotMong_C + TBeTongMongHoGa_C);
            }
        }
        else if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + Đào đá".ToUpper())
        {
            if (ThongTinVatLieuDaoHoGa_TongChieuCaoDao >= BeTongLotMong_C + TBeTongMongHoGa_C + TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C)
            {
                if (TTCCCCDTHT_ChieuCaoTuongDat < TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C)
                {
                    ketQua = TuongHoGa_C + DamGiuaHoGa_C + MuMoThotDuoi_C + MuMoThotTren_C - TTCCCCDTHT_ChieuCaoTuongDat;
                }
                else
                {
                    ketQua = 0;
                }
            }
            else
            {
                ketQua = ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa - (TTCCCCDTHT_ChieuCaoLotDa + TTCCCCDTHT_ChieuCaoMongDa);
            }
        }

        return Math.Round(ketQua, 2);
    }

    public double TTKLD_CRongDaoDayLonDat(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat, double ThongTinMaiDao_TyLeMoMai, double ThongTinMaiDao_SoCanhMaiTrai, double ThongTinMaiDao_SoCanhMaiPhai, double ThongTinMaiDao_ChieuRongDayDaoNho)
    {
        double ketQua = 0;
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();

        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất".ToUpper() || ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            ketQua = (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat * ThongTinMaiDao_TyLeMoMai * (ThongTinMaiDao_SoCanhMaiTrai + ThongTinMaiDao_SoCanhMaiPhai)) + ThongTinMaiDao_ChieuRongDayDaoNho;
        }

        return Math.Round(ketQua, 2);
    }
    public double TinhTTTKLD_CRongDaoDayLonDaoan(string ThongTinVatLieuDaoHoGa_LoaiVatLieuDao, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa, double ThongTinMaiDao_TyLeMoMai, double ThongTinMaiDao_SoCanhMaiTrai, double ThongTinMaiDao_SoCanhMaiPhai, double TTKLD_CRongDaoDayLonDat, double ThongTinMaiDao_ChieuRongDayDaoNho)
    {
        double ketQua = 0;
        ThongTinVatLieuDaoHoGa_LoaiVatLieuDao = GetTenDanhMucById(ThongTinVatLieuDaoHoGa_LoaiVatLieuDao).ToUpper().Trim();
        if (ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đá".ToUpper() || ThongTinVatLieuDaoHoGa_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            if (TTKLD_CRongDaoDayLonDat > 0)
            {
                ketQua = (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa * ThongTinMaiDao_TyLeMoMai * (ThongTinMaiDao_SoCanhMaiTrai + ThongTinMaiDao_SoCanhMaiPhai)) + TTKLD_CRongDaoDayLonDat;
            }
            else
            {
                ketQua = (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa * ThongTinMaiDao_TyLeMoMai * (ThongTinMaiDao_SoCanhMaiTrai + ThongTinMaiDao_SoCanhMaiPhai)) + ThongTinMaiDao_ChieuRongDayDaoNho;
            }
        }

        return Math.Round(ketQua, 2);
    }
    public double TiTTKLD_DienTichDaoDatnhToan(double TTKLD_CRongDaoDayLonDat, double ThongTinMaiDao_ChieuRongDayDaoNho, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat)
    {
        double ketQua = (TTKLD_CRongDaoDayLonDat + ThongTinMaiDao_ChieuRongDayDaoNho) * (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDat / 2);
        return Math.Round(ketQua, 2);
    }
    public double TTKLD_DienTichDaoDa(double TTKLD_CRongDaoDayLonDa, double TTKLD_CRongDaoDayLonDat, double ThongTinMaiDao_ChieuRongDayDaoNho, double ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa)
    {
        // Tính toán giá trị dựa trên điều kiện và làm tròn đến 2 chữ số thập phân
        double ketQua;
        if (TTKLD_CRongDaoDayLonDat > 0)
        {
            ketQua = (TTKLD_CRongDaoDayLonDa + TTKLD_CRongDaoDayLonDat) * (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa / 2);
        }
        else
        {
            ketQua = (TTKLD_CRongDaoDayLonDa + ThongTinMaiDao_ChieuRongDayDaoNho) * (ThongTinVatLieuDaoHoGa_ChieuCaoDaoDa / 2);
        }
        return Math.Round(ketQua, 2);
    }
    public double TTKLD_TongDtDao(double TTKLD_DienTichDaoDat, double TTKLD_DienTichDaoDa)
    {
        // Tính tổng và làm tròn đến 2 chữ số thập phân
        double ketQua = TTKLD_DienTichDaoDat + TTKLD_DienTichDaoDa;
        return Math.Round(ketQua, 2);
    }
    public double TTKLD_KlDaoDat(double TTKLD_DienTichDaoDat, double BeTongLotMong_D, double PhuBiHoGa_CDai, string ThongTinChungHoGa_TenHoGaTheoBanVe)
    {
        string cuoi2KyTu = ThongTinChungHoGa_TenHoGaTheoBanVe.Length >= 2 ? ThongTinChungHoGa_TenHoGaTheoBanVe.Substring(ThongTinChungHoGa_TenHoGaTheoBanVe.Length - 2) : string.Empty;
        double ketQua;
        if (cuoi2KyTu == "=G")
        {
            ketQua = 0;
        }
        else
        {
            ketQua = BeTongLotMong_D > 0 ? TTKLD_DienTichDaoDat * BeTongLotMong_D : TTKLD_DienTichDaoDat * PhuBiHoGa_CDai;
        }
        return Math.Round(ketQua, 2);
    }
    public double TTKLD_KlDaoDa(double TTKLD_DienTichDaoDa, double BeTongLotMong_D, double PhuBiHoGa_CDai, string ThongTinChungHoGa_TenHoGaTheoBanVe)
    {
        string cuoi2KyTu = ThongTinChungHoGa_TenHoGaTheoBanVe.Length >= 2 ? ThongTinChungHoGa_TenHoGaTheoBanVe.Substring(ThongTinChungHoGa_TenHoGaTheoBanVe.Length - 2) : string.Empty;
        double ketQua = cuoi2KyTu == "=G" ? 0 : (BeTongLotMong_D > 0 ? TTKLD_DienTichDaoDa * BeTongLotMong_D : TTKLD_DienTichDaoDa * PhuBiHoGa_CDai);
        return Math.Round(ketQua, 2);
    }
    public double TTKLD_TongKlDao(double TTKLD_KlDaoDat, double TTKLD_KlDaoDa)
    {
        return Math.Round(TTKLD_KlDaoDat + TTKLD_KlDaoDa, 2);
    }
    public double TTKLD_KlChiemChoDat(string ThongTinChungHoGa_TenHoGaTheoBanVe, double BeTongLotMong_D, double DThongTinChungHoGa_TenHoGaTheoBanVe, double BeTongLotMong_R, double TBeTongMongHoGa_D, double TBeTongMongHoGa_R, double TTCCCCDTHT_ChieuCaoMongDat, double TTCCCCDTHT_ChieuCaoTuongDat, double PhuBiHoGa_CDai, double PhuBiHoGa_CRong)
    {
        if (ThongTinChungHoGa_TenHoGaTheoBanVe.ToUpper().EndsWith("=G"))
        {
            return 0;
        }
        else if (BeTongLotMong_D > 0)
        {
            return Math.Round((DThongTinChungHoGa_TenHoGaTheoBanVe * BeTongLotMong_D * BeTongLotMong_R) + (TBeTongMongHoGa_D * TBeTongMongHoGa_R * TTCCCCDTHT_ChieuCaoMongDat) + (TTCCCCDTHT_ChieuCaoTuongDat * PhuBiHoGa_CDai * PhuBiHoGa_CRong), 2);
        }
        else
        {
            return Math.Round((DThongTinChungHoGa_TenHoGaTheoBanVe * PhuBiHoGa_CDai * PhuBiHoGa_CRong) + (PhuBiHoGa_CDai * PhuBiHoGa_CRong * TTCCCCDTHT_ChieuCaoMongDat) + (TTCCCCDTHT_ChieuCaoTuongDat * PhuBiHoGa_CDai * PhuBiHoGa_CRong), 2);
        }
    }
    public double TTKLD_KlChiemChoDa(string ThongTinChungHoGa_TenHoGaTheoBanVe, double BeTongLotMong_D, double TTCCCCDTHT_ChieuCaoLotDa, double BeTongLotMong_R, double TBeTongMongHoGa_D, double TBeTongMongHoGa_R, double TTCCCCDTHT_ChieuCaoMongDa, double TTCCCCDTHT_ChieuCaoTuongDa, double PhuBiHoGa_CDai, double PhuBiHoGa_CRong)
    {
        if (ThongTinChungHoGa_TenHoGaTheoBanVe.EndsWith("=G"))
        {
            return 0;
        }
        else if (BeTongLotMong_D > 0)
        {
            return Math.Round((TTCCCCDTHT_ChieuCaoLotDa * BeTongLotMong_D * BeTongLotMong_R) + (TBeTongMongHoGa_D * TBeTongMongHoGa_R * TTCCCCDTHT_ChieuCaoMongDa) + (TTCCCCDTHT_ChieuCaoTuongDa * PhuBiHoGa_CDai * PhuBiHoGa_CRong), 2);
        }
        else
        {
            return Math.Round((TTCCCCDTHT_ChieuCaoLotDa * PhuBiHoGa_CDai * PhuBiHoGa_CRong) + (PhuBiHoGa_CDai * PhuBiHoGa_CRong * TTCCCCDTHT_ChieuCaoMongDa) + (TTCCCCDTHT_ChieuCaoTuongDa * PhuBiHoGa_CDai * PhuBiHoGa_CRong), 2);
        }
    }
    public double TTKLD_TongChiemCho(double TTKLD_KlChiemChoDat, double TTKLD_KlChiemChoDa)
    {
        return Math.Round(TTKLD_KlChiemChoDat + TTKLD_KlChiemChoDa, 2);
    }
    public double TinhTTKLD_KlDapTraDatHieu(double TTKLD_KlDaoDat, double TTKLD_KlChiemChoDat)
    {
        return Math.Round(TTKLD_KlDaoDat - TTKLD_KlChiemChoDat, 2);
    }
    public double TTKLD_KlDapTraDa(double TTKLD_KlDaoDa, double TTKLD_KlChiemChoDa)
    {
        return Math.Round(TTKLD_KlDaoDa - TTKLD_KlChiemChoDa, 2);
    }
    public double TTKLD_TongDapTra(double TTKLD_KlDapTraDat, double TTKLD_KlDapTraDa)
    {
        return Math.Round(TTKLD_KlDapTraDat + TTKLD_KlDapTraDa, 2);
    }

    public string TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem(double TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa)
    {
        return TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa < -0.1 ? "Thêm 01" : "Đủ";
    }
    public double TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem, double TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, double TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).Trim().ToUpper();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            return Math.Round(TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem == "Thêm 01".ToUpper() ? TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen + TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung : TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, 2);
        }
        return 0;
    }
    public double TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem, double TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, double TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            return TTCDSLCauKienDuongTruyenDan_XacDinhOngCongCanThem == "Thêm 01" ? TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen + TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung : TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen;
        }
        return 0;
    }
    public double TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, double TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung, double TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper()) ? (TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen - TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung) * TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien : 0;
    }
    public double TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen, double TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien, double TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper()) ? (TTCDSLCauKienDuongTruyenDan_SlCauKienNguyen * TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien) + TTCDSLCauKienDuongTruyenDan_CDaiCanDeLapDatDuocTheoSoCkNguyen : 0;
    }
    public double TTCDSLCauKienDuongTruyenDan_CDaiThucTeConThuaThieuSoVoiCRongLongMuMoHoGa(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper()) ? TTCDSLCauKienDuongTruyenDan_TongCDaiLapDatTheoSoCkNguyen - TTCDSLCauKienDuongTruyenDan_TongChieuDai : 0;
    }
    public double TTCDSLCauKienDuongTruyenDan_CDaiConThuaThieuSauTinhTheoCkTinhKl(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl, double TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung, double TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien, double TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
            ? (((TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl - TTCDSLCauKienDuongTruyenDan_SoLuongCKienDungDeTinhChieuDaiBoSung) * TTCDSLCauKienDuongTruyenDan_ChieuDaiMoiNoiCKien) + (TTCDSLCauKienDuongTruyenDan_SlCauKienTinhKl * TTCDSLCauKienDuongTruyenDan_ChieuDai01CauKien)) - TTCDSLCauKienDuongTruyenDan_TongChieuDai
            : 0;
    }

    public double ThongTinCauTaoCongTron_CCaoCauKien(double ThongTinCauTaoCongTron_CDayPhuBi, double ThongTinCauTaoCongTron_SoCanh, double ThongTinCauTaoCongTron_LongSuDung)
    {
        return Math.Round((ThongTinCauTaoCongTron_CDayPhuBi * ThongTinCauTaoCongTron_SoCanh) + ThongTinCauTaoCongTron_LongSuDung, 2);
    }
    public double ThongTinCauTaoCongTron_TongCCaoCong(double ThongTinCauTaoCongTron_CCaoCauKien, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe)
    {
        return Math.Round(ThongTinCauTaoCongTron_CCaoCauKien + ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe, 2);
    }

    public double TTKTHHCongHopRanh_CCaoTuongRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDThuongLuu_CCaoTuongCongRanh, double CDHaLu_CCaoTuongCongRanh)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            return Math.Round((CDThuongLuu_CCaoTuongCongRanh + CDHaLu_CCaoTuongCongRanh) / 2, 2);
        }
        return 0;
    }
    public double TTKTHHCongHopRanh_CCaoTuongGop(double TTKTHHCongHopRanh_CCaoTuongCongHop, double TTKTHHCongHopRanh_CCaoTuongRanh)
    {
        return Math.Round(TTKTHHCongHopRanh_CCaoTuongCongHop + TTKTHHCongHopRanh_CCaoTuongRanh, 2);
    }


    public double TTKTHHCongHopRanh_CCaoChatMatTrong(string TTKTHHCongHopRanh_ChatMatTrong, string TTKTHHCongHopRanh_CauTaoTuong, string TTKTHHCongHopRanh_CauTaoMuMo, double TTKTHHCongHopRanh_CCaoTuongGop, double TTKTHHCongHopRanh_CCaoMuMoThotDuoi, double TTKTHHCongHopRanh_CCaoMuMoThotTren)
    {
        TTKTHHCongHopRanh_ChatMatTrong = GetTenDanhMucById(TTKTHHCongHopRanh_ChatMatTrong).ToUpper().Trim();
        TTKTHHCongHopRanh_CauTaoTuong = GetTenDanhMucById(TTKTHHCongHopRanh_CauTaoTuong).ToUpper().Trim();

        if (TTKTHHCongHopRanh_ChatMatTrong == "Có".ToUpper() && TTKTHHCongHopRanh_CauTaoTuong == "Tường xây gạch".ToUpper())
        {
            return TTKTHHCongHopRanh_CauTaoMuMo == "Không mũ mố".ToUpper() ? TTKTHHCongHopRanh_CCaoTuongGop : TTKTHHCongHopRanh_CCaoTuongGop + TTKTHHCongHopRanh_CCaoMuMoThotDuoi + TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }
        else if (TTKTHHCongHopRanh_ChatMatTrong == "Không".ToUpper() && TTKTHHCongHopRanh_CauTaoMuMo == "Mũ mố xây gạch".ToUpper())
        {
            return TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }
        return 0;
    }
    public double TTKTHHCongHopRanh_CCaoChatmatNgoai(string TTKTHHCongHopRanh_ChatMatNgoai, string TTKTHHCongHopRanh_CauTaoTuong, string TTKTHHCongHopRanh_CauTaoMuMo, double TTKTHHCongHopRanh_CCaoTuongGop, double TTKTHHCongHopRanh_CCaoMuMoThotDuoi, double TTKTHHCongHopRanh_CCaoMuMoThotTren, double TTKTHHCongHopRanh_CRongMuMoTren)
    {
        if (TTKTHHCongHopRanh_ChatMatNgoai == "Có" && TTKTHHCongHopRanh_CauTaoTuong == "Tường xây gạch")
        {
            return TTKTHHCongHopRanh_CauTaoMuMo == "Không mũ mố" ? TTKTHHCongHopRanh_CCaoTuongGop : TTKTHHCongHopRanh_CCaoTuongGop + TTKTHHCongHopRanh_CCaoMuMoThotDuoi + TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }
        else if (TTKTHHCongHopRanh_ChatMatNgoai == "Không" && TTKTHHCongHopRanh_CauTaoMuMo == "Mũ mố xây gạch")
        {
            return TTKTHHCongHopRanh_CCaoMuMoThotTren + TTKTHHCongHopRanh_CRongMuMoTren;
        }
        return 0;
    }
    public double TTKTHHCongHopRanh_TongChieuCao(double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTKTHHCongHopRanh_CCaoDe, double TTKTHHCongHopRanh_CCaoTuongGop, double TTKTHHCongHopRanh_CCaoMuMoThotDuoi, double TTKTHHCongHopRanh_CCaoMuMoThotTren)
    {
        return Math.Round(TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong + TTKTHHCongHopRanh_CCaoDe + TTKTHHCongHopRanh_CCaoTuongGop + TTKTHHCongHopRanh_CCaoMuMoThotDuoi + TTKTHHCongHopRanh_CCaoMuMoThotTren, 2);
    }

    public double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng(double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double ThongTinKichThuocHinhHocOngNhua_SoCanh, double ThongTinKichThuocHinhHocOngNhua_LongSuDung)
    {
        return Math.Round((ThongTinKichThuocHinhHocOngNhua_CDayPhuBi * ThongTinKichThuocHinhHocOngNhua_SoCanh) + ThongTinKichThuocHinhHocOngNhua_LongSuDung, 2);
    }

    public double TTTDCongHoRanh_SoLuong(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTTDCongHoRanh_SLCauKienNguyen)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).Trim().ToUpper();
        return Math.Round((ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper()) ? TTTDCongHoRanh_SLCauKienNguyen : 0, 2);
    }


    public int TTTDCongHoRanh_SLCauKienNguyen(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCDSLCauKienDuongTruyenDan_TongChieuDai, double TTTDCongHoRanh_Cdai, double TTTDCongHoRanh_ChieuDaiMoiNoi)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper()
            || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper()
            || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            double denominator = TTTDCongHoRanh_Cdai + TTTDCongHoRanh_ChieuDaiMoiNoi;
            if (denominator != 0)
            {
                return (int)(TTCDSLCauKienDuongTruyenDan_TongChieuDai / denominator);
            }
            else
            {
                // Trường hợp nếu mẫu số bằng 0, trả về 0
                return 0;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTTDCongHoRanh_SLCauKienNguyen, double TTTDCongHoRanh_ChieuDaiMoiNoi)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
            ? TTTDCongHoRanh_SLCauKienNguyen * TTTDCongHoRanh_ChieuDaiMoiNoi
            : 0;
    }
    public double TTTDCongHoRanh_TongChieuDaiTheoCKNguyen(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTTDCongHoRanh_SLCauKienNguyen, double TTTDCongHoRanh_Cdai, double TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
            ? (TTTDCongHoRanh_SLCauKienNguyen * TTTDCongHoRanh_Cdai) + TTTDCongHoRanh_ChieuDaiTheoSoCKNguyen
            : 0;
    }
    public double TTTDCongHoRanh_ChieuDaiThucTe(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTTDCongHoRanh_TongChieuDaiTheoCKNguyen, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
            ? TTTDCongHoRanh_TongChieuDaiTheoCKNguyen - TTCDSLCauKienDuongTruyenDan_TongChieuDai
            : 0;
    }
    public string TTTDCongHoRanh_XacDinhOngCongCanThem(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTTDCongHoRanh_ChieuDaiThucTe)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            return (TTTDCongHoRanh_ChieuDaiThucTe >= -0.02) ? "Đủ" : "Thêm 01";
        }
        return "0";
    }

    

    public int TTTDCongHoRanh_SoLuong1(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string TTTDCongHoRanh_XacDinhOngCongCanThem)
    {
        // Chuyển đổi các tham số EP17 và JE17 thành dạng chữ hoa và loại bỏ khoảng trắng đầu cuối
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        TTTDCongHoRanh_XacDinhOngCongCanThem =  TTTDCongHoRanh_XacDinhOngCongCanThem.ToUpper().Trim();

        // Kiểm tra điều kiện
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "CỐNG HỘP" || ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH XÂY" || ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH BÊ TÔNG")
        {
            return TTTDCongHoRanh_XacDinhOngCongCanThem == "THÊM 01" ? 1 : 0;
        }
        else
        {
            return 0;
        }
    }


    public double TTTDCongHoRanh_CDai1(string ThongTinDuongTruyenDan_HinhThucTruyenDan, IEnumerable<string> EPRange, IEnumerable<double> JDRange, IEnumerable<string> JERange)
    {
        // Chuyển đổi EP16 thành dạng chữ hoa và loại bỏ khoảng trắng đầu cuối
        ThongTinDuongTruyenDan_HinhThucTruyenDan =  GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
    
        // Lọc các giá trị cần tính trung bình dựa trên điều kiện
        var filteredValues = new List<double>();
    
        for (int i = 0; i < EPRange.Count(); i++)
        {
            bool condition = false;
        
            if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "CỐNG HỘP" && EPRange.ElementAt(i) == "Cống hộp" && JERange.ElementAt(i) == "Thêm 01")
            {
                condition = true;
            }
            else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH XÂY" && EPRange.ElementAt(i) == "Rãnh xây" && JERange.ElementAt(i) == "Thêm 01")
            {
                condition = true;
            }
            else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH BÊ TÔNG" && EPRange.ElementAt(i) == "Rãnh bê tông" && JERange.ElementAt(i) == "Thêm 01")
            {
                condition = true;
            }

            if (condition)
            {
                filteredValues.Add(JDRange.ElementAt(i));
            }
        }

        // Tính trung bình các giá trị đã lọc
        double average = filteredValues.Count > 0 ? filteredValues.Average() : 0;

        // Làm tròn và trả về giá trị tuyệt đối
        return Math.Round(Math.Abs(average), 2);
    }



    public double CDThuongLuu_DinhDeCong(string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi)
    {
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();
        if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Đế".ToUpper())
        {
            return CDThuongLuu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
        }
        else
        {
            return 0;
        }
    }
    public double CDThuongLuu_DinhMongRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if ((ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper()) ||
            (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper()))
        {
            return CDThuongLuu_DayDongChay;
        }
        else
        {
            return 0;
        }
    }
    public double CDThuongLuu_DinhMongCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double TTKTHHCongHopRanh_CCaoDe)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDThuongLuu_DayDongChay - TTKTHHCongHopRanh_CCaoDe;
        }
        else
        {
            return 0;
        }
    }
    public double CDThuongLuu_DinhMongCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDThuongLuu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDThuongLuu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DinhMongChanKhay(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoChanKhay, double CDThuongLuu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinRanhThang_CauTaoChanKhay == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoChanKhay == "Bê tông cốt thép".ToUpper())
            {
                return CDThuongLuu_DayDongChay;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DinhMongRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDThuongLuu_DayDongChay;
        }
        return 0;
    }
    public double CDThuongLuu_DinhMongGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDThuongLuu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe, double TTKTHHCongHopRanh_CCaoDe)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay;
            }
            return 0;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDThuongLuu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
            return 0;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay - TTKTHHCongHopRanh_CCaoDe;
            }
            return 0;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay;
            }
            else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay;
            }
            return 0;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DinhMongRanh, double TTKTHHCongHopRanh_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if ((ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper()) && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDThuongLuu_DinhMongRanh - TTKTHHCongHopRanh_CCaoMong;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DinhMongCongHop, double TTKTHHCongHopRanh_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDThuongLuu_DinhMongCongHop - TTKTHHCongHopRanh_CCaoMong;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DinhMongCongTron, double ThongTinCauTaoCongTron_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() && (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper()))
        {
            return CDThuongLuu_DinhMongCongTron - ThongTinCauTaoCongTron_CCaoMong;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotOngNhua(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
        {
            return CDThuongLuu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotGiangDinhRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoGiangDinh, double CDThuongLuu_DinhRanhThang, double ThongTinRanhThang_CCaoMongGiangDinh)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && (ThongTinRanhThang_CauTaoGiangDinh == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoGiangDinh == "Bê tông cốt thép".ToUpper()))
        {
            return CDThuongLuu_DinhRanhThang - ThongTinRanhThang_CCaoMongGiangDinh;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotChanKhayRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoChanKhay, double CDThuongLuu_DayDongChay, double ThongTinRanhThang_CCaoMongChanKhay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && (ThongTinRanhThang_CauTaoChanKhay == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoChanKhay == "Bê tông cốt thép".ToUpper()))
        {
            return CDThuongLuu_DayDongChay - ThongTinRanhThang_CCaoMongChanKhay;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinRanhThang_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDThuongLuu_DayDongChay - ThongTinRanhThang_CCaoMong;
        }
        return 0;
    }
    public double CDThuongLuu_DinhLotGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinRanhThang_CCaoMong, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double CDThuongLuu_DinhMongCongTron, double ThongTinCauTaoCongTron_CCaoMong, double CDThuongLuu_DinhMongCongHop, double TTKTHHCongHopRanh_CCaoMong, double CDThuongLuu_DinhMongRanh)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DayDongChay - ThongTinRanhThang_CCaoMong;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
            {
                return CDThuongLuu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDThuongLuu_DinhMongCongTron - ThongTinCauTaoCongTron_CCaoMong;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DinhMongCongHop - TTKTHHCongHopRanh_CCaoMong;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DinhMongRanh - TTKTHHCongHopRanh_CCaoMong;
            }
        }

        return 0;
    }
    public double CDThuongLuu_DayDaoRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DinhLotRanhThang, double ThongTinRanhThang_CCaoLot, double CDThuongLuu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DinhLotRanhThang - ThongTinRanhThang_CCaoLot;
            }
            else
            {
                return CDThuongLuu_DayDongChay;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoChanKhayRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoChanKhay, double CDThuongLuu_DinhLotChanKhayRanhThang, double ThongTinRanhThang_CCaoLotChanKhay, double CDThuongLuu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinRanhThang_CauTaoChanKhay == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoChanKhay == "Bê tông cốt thép".ToUpper())
            {
                return CDThuongLuu_DinhLotChanKhayRanhThang - ThongTinRanhThang_CCaoLotChanKhay;
            }
            else
            {
                return CDThuongLuu_DayDongChay;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoGiangDinhRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoGiangDinh, double CDThuongLuu_DinhLotGiangDinhRanhThang, double ThongTinRanhThang_CCaoLotGiangDinh, double CDThuongLuu_DinhRanhThang)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinRanhThang_CauTaoGiangDinh == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoGiangDinh == "Bê tông cốt thép".ToUpper())
            {
                return CDThuongLuu_DinhLotGiangDinhRanhThang - ThongTinRanhThang_CCaoLotGiangDinh;
            }
            else
            {
                return CDThuongLuu_DinhRanhThang;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoOngNhua(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double CDThuongLuu_DinhLotOngNhua, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không đắp cát".ToUpper())
            {
                return CDThuongLuu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
            {
                return CDThuongLuu_DinhLotOngNhua - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDThuongLuu_DinhLotRanh, double TTKTHHCongHopRanh_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            return CDThuongLuu_DinhLotRanh - TTKTHHCongHopRanh_CCaoLotMong;
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double TTKTHHCongHopRanh_CCaoDe, double CDThuongLuu_DinhLotCongHop, double TTKTHHCongHopRanh_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
            {
                return CDThuongLuu_DayDongChay - TTKTHHCongHopRanh_CCaoDe;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDThuongLuu_DinhLotCongHop - TTKTHHCongHopRanh_CCaoLotMong;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDThuongLuu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe, double CDThuongLuu_DinhLotCongTron, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
            {
                return CDThuongLuu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đế".ToUpper())
            {
                return CDThuongLuu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDThuongLuu_DinhLotCongTron - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }
        return 0;
    }
    public double CDThuongLuu_DayDaoGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDThuongLuu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDThuongLuu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe, double CDThuongLuu_DinhLotCongTron, double ThongTinCauTaoCongTron_CCaoLotMong, double TTKTHHCongHopRanh_CCaoDe, double CDThuongLuu_DinhLotCongHop, double TTKTHHCongHopRanh_CCaoLotMong, double CDThuongLuu_DinhLotRanh, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double CDThuongLuu_DinhLotOngNhua, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double CDThuongLuu_DinhLotRanhThang, double ThongTinRanhThang_CCaoLot)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
            {
                return Math.Round(CDThuongLuu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi, 2);
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đế".ToUpper())
            {
                return Math.Round(CDThuongLuu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe, 2);
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return Math.Round(CDThuongLuu_DinhLotCongTron - ThongTinCauTaoCongTron_CCaoLotMong, 2);
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
            {
                return Math.Round(CDThuongLuu_DayDongChay - TTKTHHCongHopRanh_CCaoDe, 2);
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return Math.Round(CDThuongLuu_DinhLotCongHop - TTKTHHCongHopRanh_CCaoLotMong, 2);
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            return Math.Round(CDThuongLuu_DinhLotRanh - TTKTHHCongHopRanh_CCaoLotMong, 2);
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không đắp cát".ToUpper())
            {
                return Math.Round(CDThuongLuu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, 2);
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
            {
                return Math.Round(CDThuongLuu_DinhLotOngNhua - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, 2);
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return Math.Round(CDThuongLuu_DinhLotRanhThang - ThongTinRanhThang_CCaoLot, 2);
            }
            else
            {
                return Math.Round(CDThuongLuu_DayDongChay, 2);
            }
        }

        return 0;
    }
    public double CDThuongLuu_ChieuSauDao(double CDThuongLuu_HienTrangTruocKhiDaoThuongLuu, double CDThuongLuu_DayDaoGop)
    {
        return CDThuongLuu_DayDaoGop > 0 ? CDThuongLuu_HienTrangTruocKhiDaoThuongLuu - CDThuongLuu_DayDaoGop : 0;
    }


    public double CDHaLu_DinhRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DayDongChay, double CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() ? Math.Round(CDHaLu_DayDongChay + CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh, 2) : 0;
    }
    public double CDHaLu_DinhDapCat(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhOngNhua, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper() ? Math.Round(CDHaLu_DinhOngNhua + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, 2) : 0;
    }
    public double CDHaLu_DinhOngNhua(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhTrongLongSuDung, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper() ? Math.Round(CDHaLu_DinhTrongLongSuDung + ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, 2) : 0;
    }
    public double CDHaLu_DinhRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhTrongLongSuDung, double TTKTHHCongHopRanh_CCaoMuMoThotTren)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
            ? Math.Round(CDHaLu_DinhTrongLongSuDung + TTKTHHCongHopRanh_CCaoMuMoThotTren, 2)
            : 0;
    }
    public double CDHaLu_DinhCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhTrongLongSuDung, double TTKTHHCongHopRanh_CCaoMuMoThotTren)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper()
            ? Math.Round(CDHaLu_DinhTrongLongSuDung + TTKTHHCongHopRanh_CCaoMuMoThotTren, 2)
            : 0;
    }
    public double CDHaLu_DinhCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhTrongLongSuDung, double ThongTinCauTaoCongTron_CDayPhuBi)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        return ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper()
            ? Math.Round(CDHaLu_DinhTrongLongSuDung + ThongTinCauTaoCongTron_CDayPhuBi, 2)
            : 0;
    }
    public double CDHaLu_DinhGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhTrongLongSuDung, double ThongTinCauTaoCongTron_CDayPhuBi, double TTKTHHCongHopRanh_CCaoMuMoThotTren, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double CDHaLu_DayDongChay, double CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            result = CDHaLu_DinhTrongLongSuDung + ThongTinCauTaoCongTron_CDayPhuBi;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            result = CDHaLu_DinhTrongLongSuDung + TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            result = CDHaLu_DinhTrongLongSuDung + TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper())
        {
            result = CDHaLu_DinhTrongLongSuDung + ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            result = CDHaLu_DayDongChay + CDHaLu_ChieuCaoRanhThangTuDayDongChayDenDinh;
        }

        return Math.Round(result, 2);
    }
    public double CDHaLu_DinhGiangDinhRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoGiangDinh, double CDHaLu_DinhRanhThang)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && (ThongTinRanhThang_CauTaoGiangDinh == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoGiangDinh == "Bê tông cốt thép".ToUpper()))
        {
            result = CDHaLu_DinhRanhThang;
        }

        return Math.Round(result, 2);
    }
    public double CDHaLu_DinhMuMoThotDuoiCongHopRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhCongHop, double TTKTHHCongHopRanh_CCaoMuMoThotTren, double CDHaLu_DinhRanh)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            result = CDHaLu_DinhCongHop - TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            result = CDHaLu_DinhRanh - TTKTHHCongHopRanh_CCaoMuMoThotTren;
        }

        return Math.Round(result, 2);
    }
    public double CDHaLu_DinhTuongCHopRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhMuMoThotDuoiCongHopRanh, double TTKTHHCongHopRanh_CCaoMuMoThotDuoi)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            result = CDHaLu_DinhMuMoThotDuoiCongHopRanh - TTKTHHCongHopRanh_CCaoMuMoThotDuoi;
        }

        return Math.Round(result, 2);
    }
    public double CDHaLu_CCaoTuongCongRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhTuongCHopRanh, double CDHaLu_DayDongChay)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            result = CDHaLu_DinhTuongCHopRanh - CDHaLu_DayDongChay;
        }

        return Math.Round(result, 2);
    }
    public double CDHaLu_DinhDeCong(string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi)
    {
        double result = 0;
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();
        if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Đế".ToUpper())
        {
            result = CDHaLu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
        }

        return Math.Round(result, 2);
    }
    public double CDHaLu_DinhMongRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay)
    {
        double result = 0;
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();
        if ((ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper()) && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            result = CDHaLu_DayDongChay;
        }

        return result;
    }
    public double CDHaLu_DinhMongCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double TTKTHHCongHopRanh_CCaoDe)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            result = CDHaLu_DayDongChay - TTKTHHCongHopRanh_CCaoDe;
        }

        return result;
    }
    public double CDHaLu_DinhMongCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDHaLu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                result = CDHaLu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                result = CDHaLu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
        }

        return result;
    }
    public double CDHaLu_DinhMongChanKhay(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoChanKhay, double CDHaLu_DayDongChay)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && (ThongTinRanhThang_CauTaoChanKhay == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoChanKhay == "Bê tông cốt thép".ToUpper()))
        {
            result = CDHaLu_DayDongChay;
        }

        return result;
    }
    public double CDHaLu_DinhMongRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            result = CDHaLu_DayDongChay;
        }

        return result;
    }
    public double CDHaLu_DinhMongGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDHaLu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe, double TTKTHHCongHopRanh_CCaoDe)
    {
        double result = 0;
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                result = CDHaLu_DayDongChay;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                result = CDHaLu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                result = CDHaLu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                result = CDHaLu_DayDongChay - TTKTHHCongHopRanh_CCaoDe;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                result = CDHaLu_DayDongChay;
            }
        }

        return result;
    }
    public double CDHaLu_DinhLotRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DinhMongRanh, double TTKTHHCongHopRanh_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if ((ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper()) && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDHaLu_DinhMongRanh - TTKTHHCongHopRanh_CCaoMong;
        }

        return 0;
    }
    public double CDHaLu_DinhLotCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DinhMongCongHop, double TTKTHHCongHopRanh_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDHaLu_DinhMongCongHop - TTKTHHCongHopRanh_CCaoMong;
        }

        return 0;
    }
    public double CDHaLu_DinhLotCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DinhMongCongTron, double ThongTinCauTaoCongTron_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper() && (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper()))
        {
            return CDHaLu_DinhMongCongTron - ThongTinCauTaoCongTron_CCaoMong;
        }

        return 0;
    }
    public double CDHaLu_DinhLotOngNhua(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
        {
            return CDHaLu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
        }

        return 0;
    }
    public double CDHaLu_DinhLotGiangDinhRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoGiangDinh, double CDHaLu_DinhRanhThang, double ThongTinRanhThang_CCaoMongGiangDinh)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && (ThongTinRanhThang_CauTaoGiangDinh == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoGiangDinh == "Bê tông cốt thép".ToUpper()))
        {
            return CDHaLu_DinhRanhThang - ThongTinRanhThang_CCaoMongGiangDinh;
        }

        return 0;
    }
    public double CDHaLu_DinhLotChanKhayRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoChanKhay, double CDHaLu_DayDongChay, double ThongTinRanhThang_CCaoMongChanKhay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && (ThongTinRanhThang_CauTaoChanKhay == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoChanKhay == "Bê tông cốt thép".ToUpper()))
        {
            return CDHaLu_DayDongChay - ThongTinRanhThang_CCaoMongChanKhay;
        }
        return 0;
    }
    public double CDHaLu_DinhLotRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinRanhThang_CCaoMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDHaLu_DayDongChay - ThongTinRanhThang_CCaoMong;
        }

        return 0;
    }
    public double CDHaLu_DinhLotGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinRanhThang_CCaoMong, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double CDHaLu_DinhMongCongTron, double ThongTinCauTaoCongTron_CCaoMong, double CDHaLu_DinhMongCongHop, double TTKTHHCongHopRanh_CCaoMong, double CDHaLu_DinhMongRanh)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDHaLu_DayDongChay - ThongTinRanhThang_CCaoMong;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
            {
                return CDHaLu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDHaLu_DinhMongCongTron - ThongTinCauTaoCongTron_CCaoMong;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDHaLu_DinhMongCongHop - TTKTHHCongHopRanh_CCaoMong;
            }
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDHaLu_DinhMongRanh - TTKTHHCongHopRanh_CCaoMong;
            }
        }

        return 0;
    }
    public double CDHaLu_DayDaoRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DinhLotRanhThang, double ThongTinRanhThang_CCaoLot, double CDHaLu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
            {
                return CDHaLu_DinhLotRanhThang - ThongTinRanhThang_CCaoLot;
            }
            else
            {
                return CDHaLu_DayDongChay;
            }
        }

        return 0;
    }
    public double CDHaLu_DayDaoChanKhayRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoChanKhay, double CDHaLu_DinhLotChanKhayRanhThang, double ThongTinRanhThang_CCaoLotChanKhay, double CDHaLu_DayDongChay)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinRanhThang_CauTaoChanKhay == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoChanKhay == "Bê tông cốt thép".ToUpper())
            {
                return CDHaLu_DinhLotChanKhayRanhThang - ThongTinRanhThang_CCaoLotChanKhay;
            }
            else
            {
                return CDHaLu_DayDongChay;
            }
        }

        return 0;
    }
    public double CDHaLu_DayDaoGiangDinhRanhThang(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinRanhThang_CauTaoGiangDinh, double CDHaLu_DinhLotGiangDinhRanhThang, double ThongTinRanhThang_CCaoLotGiangDinh, double CDHaLu_DinhRanhThang)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh thang".ToUpper())
        {
            if (ThongTinRanhThang_CauTaoGiangDinh == "Bê tông".ToUpper() || ThongTinRanhThang_CauTaoGiangDinh == "Bê tông cốt thép".ToUpper())
            {
                return CDHaLu_DinhLotGiangDinhRanhThang - ThongTinRanhThang_CCaoLotGiangDinh;
            }
            else
            {
                return CDHaLu_DinhRanhThang;
            }
        }

        return 0;
    }
    public double CDHaLu_DayDaoOngNhua(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinKichThuocHinhHocOngNhua_CDayPhuBi, double CDHaLu_DinhLotOngNhua, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Ống nhựa".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không đắp cát".ToUpper())
            {
                return CDHaLu_DayDongChay - ThongTinKichThuocHinhHocOngNhua_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đắp cát".ToUpper())
            {
                return CDHaLu_DinhLotOngNhua - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat;
            }
        }

        return 0;
    }
    public double CDHaLu_DayDaoRanh(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double CDHaLu_DinhLotRanh, double TTKTHHCongHopRanh_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh xây".ToUpper() || ThongTinDuongTruyenDan_HinhThucTruyenDan == "Rãnh bê tông".ToUpper())
        {
            return CDHaLu_DinhLotRanh - TTKTHHCongHopRanh_CCaoLotMong;
        }

        return 0;
    }
    public double CDHaLu_DayDaoCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double TTKTHHCongHopRanh_CCaoDe, double CDHaLu_DinhLotCongHop, double TTKTHHCongHopRanh_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
        {
            return CDHaLu_DayDongChay - TTKTHHCongHopRanh_CCaoDe;
        }
        else if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống hộp".ToUpper() && ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper())
        {
            return CDHaLu_DinhLotCongHop - TTKTHHCongHopRanh_CCaoLotMong;
        }

        return 0;
    }
    public double CDHaLu_DayDaoCongTron(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDHaLu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe, double CDHaLu_DinhLotCongTron, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
            {
                return CDHaLu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đế".ToUpper())
            {
                return CDHaLu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDHaLu_DinhLotCongTron - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }

        return 0;
    }
    public double CDHaLu_DayDaoGop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong, double CDHaLu_DayDongChay, double ThongTinCauTaoCongTron_CDayPhuBi, double CDHaLu_DinhDeCong, double ThongTinCauTaoCongTron_CCaoDe, double CDHaLu_DinhLotCongTron, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "Cống tròn".ToUpper())
        {
            if (ThongTinMongDuongTruyenDan_LoaiMong == "Không có móng".ToUpper())
            {
                return CDHaLu_DayDongChay - ThongTinCauTaoCongTron_CDayPhuBi;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Đế".ToUpper())
            {
                return CDHaLu_DinhDeCong - ThongTinCauTaoCongTron_CCaoDe;
            }
            else if (ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông".ToUpper() || ThongTinMongDuongTruyenDan_LoaiMong == "Móng bê tông kết hợp đế".ToUpper())
            {
                return CDHaLu_DinhLotCongTron - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }

        return 0;
    }
    public double CDHaLu_ChieuSauDao(double CDHaLu_DayDaoGop, double CDHaLu_HienTrangTruocKhiDaoHaLuu)
    {
        if (CDHaLu_DayDaoGop > 0)
        {
            return CDHaLu_HienTrangTruocKhiDaoHaLuu - CDHaLu_DayDaoGop;
        }
        else
        {
            return 0;
        }
    }

    public double TTVLDCongRanh_TLChieuCaoDaoDat(string TTVLDCongRanh_LoaiVatLieuDao, double CDThuongLuu_ChieuSauDao, double TTVLDCongRanh_TLChieuCaoDaoDa)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();
        if (string.IsNullOrEmpty(TTVLDCongRanh_LoaiVatLieuDao))
        {
            return 0;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            return 0;
        }
        else
        {
            return CDThuongLuu_ChieuSauDao - TTVLDCongRanh_TLChieuCaoDaoDa;
        }
    }
    public double TTVLDCongRanh_HLChieuCaoDaoDat(string TTVLDCongRanh_LoaiVatLieuDao, double KU16, double MJ16)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();
        if (string.IsNullOrEmpty(TTVLDCongRanh_LoaiVatLieuDao))
        {
            return 0;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            return 0;
        }
        else
        {
            return KU16 - MJ16;
        }
    }


    public double TTCCCCT_CCaoLotDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();
        if (TTVLDCongRanh_LoaiVatLieuDao == "Đào đất".ToUpper() || TTVLDCongRanh_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            return TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinCauTaoCongTron_CCaoLotMong ? ThongTinCauTaoCongTron_CCaoLotMong : TTVLDCongRanh_TLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoLotDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();
        if (TTVLDCongRanh_LoaiVatLieuDao == "Đào đất".ToUpper() || TTVLDCongRanh_LoaiVatLieuDao == "Đào đất + đào đá".ToUpper())
        {
            return TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinCauTaoCongTron_CCaoLotMong ? ThongTinCauTaoCongTron_CCaoLotMong : TTVLDCongRanh_HLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoLotDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCT_CCaoLotDatTLuu, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();
        if (TTVLDCongRanh_LoaiVatLieuDao == "Đào đá".ToUpper())
        {
            return TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinCauTaoCongTron_CCaoLotMong ? ThongTinCauTaoCongTron_CCaoLotMong : TTVLDCongRanh_TLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "Đào đất + Đào đá".ToUpper())
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinCauTaoCongTron_CCaoLotMong)
            {
                return TTCCCCT_CCaoLotDatTLuu < ThongTinCauTaoCongTron_CCaoLotMong ? ThongTinCauTaoCongTron_CCaoLotMong - TTCCCCT_CCaoLotDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoLotDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCT_CCaoLotDatHLuu, double ThongTinCauTaoCongTron_CCaoLotMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinCauTaoCongTron_CCaoLotMong ? ThongTinCauTaoCongTron_CCaoLotMong : TTVLDCongRanh_HLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinCauTaoCongTron_CCaoLotMong)
            {
                return TTCCCCT_CCaoLotDatHLuu < ThongTinCauTaoCongTron_CCaoLotMong ? ThongTinCauTaoCongTron_CCaoLotMong - TTCCCCT_CCaoLotDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoMongDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= ThongTinCauTaoCongTron_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return ThongTinCauTaoCongTron_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoMongDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= ThongTinCauTaoCongTron_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return ThongTinCauTaoCongTron_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoMongDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCT_CCaoMongDatTLuu, double TTCCCCT_CCaoLotDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= ThongTinCauTaoCongTron_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return ThongTinCauTaoCongTron_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return TTCCCCT_CCaoMongDatTLuu < ThongTinCauTaoCongTron_CCaoMong ? ThongTinCauTaoCongTron_CCaoMong - TTCCCCT_CCaoMongDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - TTCCCCT_CCaoLotDaTLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoMongDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCT_CCaoMongDatHLuu, double TTCCCCT_CCaoLotDaHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= ThongTinCauTaoCongTron_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return ThongTinCauTaoCongTron_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - ThongTinCauTaoCongTron_CCaoLotMong;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return TTCCCCT_CCaoMongDatHLuu < ThongTinCauTaoCongTron_CCaoMong ? ThongTinCauTaoCongTron_CCaoMong - TTCCCCT_CCaoMongDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - TTCCCCT_CCaoLotDaHLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoDeDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return ThongTinCauTaoCongTron_CCaoDe;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoDeDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return ThongTinCauTaoCongTron_CCaoDe;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoDeDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCT_CCaoDeDatTLuu, double TTCCCCT_CCaoLotDaTLuu, double TTCCCCT_CCaoMongDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return ThongTinCauTaoCongTron_CCaoDe;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong);
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return TTCCCCT_CCaoDeDatTLuu < ThongTinCauTaoCongTron_CCaoDe ? ThongTinCauTaoCongTron_CCaoDe - TTCCCCT_CCaoDeDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (TTCCCCT_CCaoLotDaTLuu + TTCCCCT_CCaoMongDaTLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoDeDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCT_CCaoDeDatHLuu, double TTCCCCT_CCaoLotDaHLuu, double TTCCCCT_CCaoMongDaHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return ThongTinCauTaoCongTron_CCaoDe;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong);
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return TTCCCCT_CCaoDeDatHLuu < ThongTinCauTaoCongTron_CCaoDe ? ThongTinCauTaoCongTron_CCaoDe - TTCCCCT_CCaoDeDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (TTCCCCT_CCaoLotDaHLuu + TTCCCCT_CCaoMongDaHLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoCongDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe, double ThongTinCauTaoCongTron_TongCCaoCong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinCauTaoCongTron_TongCCaoCong)
            {
                return ThongTinCauTaoCongTron_TongCCaoCong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoCongDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe, double ThongTinCauTaoCongTron_TongCCaoCong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinCauTaoCongTron_TongCCaoCong)
            {
                return ThongTinCauTaoCongTron_TongCCaoCong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoCongDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCT_CCaoCongDatTLuu, double ThongTinCauTaoCongTron_CCaoCauKien, double ThongTinCauTaoCongTron_TongCCaoCong, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe, double TTCCCCT_CCaoLotDaTLuu, double TTCCCCT_CCaoMongDaTLuu, double TTCCCCT_CCaoDeDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinCauTaoCongTron_TongCCaoCong)
            {
                return ThongTinCauTaoCongTron_TongCCaoCong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe);
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinCauTaoCongTron_TongCCaoCong)
            {
                return TTCCCCT_CCaoCongDatTLuu < ThongTinCauTaoCongTron_CCaoCauKien ? ThongTinCauTaoCongTron_CCaoCauKien - TTCCCCT_CCaoCongDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (TTCCCCT_CCaoLotDaTLuu + TTCCCCT_CCaoMongDaTLuu + TTCCCCT_CCaoDeDaTLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCT_CCaoCongDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCT_CCaoCongDatHLuu, double ThongTinCauTaoCongTron_CCaoCauKien, double ThongTinCauTaoCongTron_TongCCaoCong, double ThongTinCauTaoCongTron_CCaoLotMong, double ThongTinCauTaoCongTron_CCaoMong, double ThongTinCauTaoCongTron_CCaoDe, double TTCCCCT_CCaoLotDaHLuu, double TTCCCCT_CCaoMongDaHLuu, double TTCCCCT_CCaoDeDaHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinCauTaoCongTron_TongCCaoCong)
            {
                return ThongTinCauTaoCongTron_TongCCaoCong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (ThongTinCauTaoCongTron_CCaoLotMong + ThongTinCauTaoCongTron_CCaoMong + ThongTinCauTaoCongTron_CCaoDe);
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinCauTaoCongTron_TongCCaoCong)
            {
                return TTCCCCT_CCaoCongDatHLuu < ThongTinCauTaoCongTron_CCaoCauKien ? ThongTinCauTaoCongTron_CCaoCauKien - TTCCCCT_CCaoCongDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (TTCCCCT_CCaoLotDaHLuu + TTCCCCT_CCaoMongDaHLuu + TTCCCCT_CCaoDeDaHLuu);
            }
        }
        else
        {
            return 0;
        }
    }

    public double TTCCCCCHR_CCaoLotDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double TTKTHHCongHopRanh_CCaoLotMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_TLChieuCaoDaoDat >= TTKTHHCongHopRanh_CCaoLotMong ? TTKTHHCongHopRanh_CCaoLotMong : TTVLDCongRanh_TLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoLotDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double TTKTHHCongHopRanh_CCaoLotMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDat >= TTKTHHCongHopRanh_CCaoLotMong ? TTKTHHCongHopRanh_CCaoLotMong : TTVLDCongRanh_HLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoLotDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTVLDCongRanh_TLTongChieuSauDao, double TTKTHHCongHopRanh_CCaoLotMong, double TTCCCCCHR_CCaoLotDatTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_TLChieuCaoDaoDa >= TTKTHHCongHopRanh_CCaoLotMong ? TTKTHHCongHopRanh_CCaoLotMong : TTVLDCongRanh_TLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= TTKTHHCongHopRanh_CCaoLotMong)
            {
                return TTCCCCCHR_CCaoLotDatTLuu < TTKTHHCongHopRanh_CCaoLotMong ? TTKTHHCongHopRanh_CCaoLotMong - TTCCCCCHR_CCaoLotDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoLotDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTVLDCongRanh_HLTongChieuSauDao, double TTKTHHCongHopRanh_CCaoLotMong, double TTCCCCCHR_CCaoLotDatHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDa >= TTKTHHCongHopRanh_CCaoLotMong ? TTKTHHCongHopRanh_CCaoLotMong : TTVLDCongRanh_HLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= TTKTHHCongHopRanh_CCaoLotMong)
            {
                return TTCCCCCHR_CCaoLotDatHLuu < TTKTHHCongHopRanh_CCaoLotMong ? TTKTHHCongHopRanh_CCaoLotMong - TTCCCCCHR_CCaoLotDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoMongDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= TTKTHHCongHopRanh_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong)
            {
                return TTKTHHCongHopRanh_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - TTKTHHCongHopRanh_CCaoLotMong;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoMongDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= TTKTHHCongHopRanh_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong)
            {
                return TTKTHHCongHopRanh_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - TTKTHHCongHopRanh_CCaoLotMong;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoMongDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCCHR_CCaoMongDatTLuu, double TTCCCCCHR_CCaoLotDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= TTKTHHCongHopRanh_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong)
            {
                return TTKTHHCongHopRanh_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - TTKTHHCongHopRanh_CCaoLotMong;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong)
            {
                return TTCCCCCHR_CCaoMongDatTLuu < TTKTHHCongHopRanh_CCaoMong ? TTKTHHCongHopRanh_CCaoMong - TTCCCCCHR_CCaoMongDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - TTCCCCCHR_CCaoLotDaTLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoMongDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCCHR_CCaoMongDatHLuu, double TTCCCCCHR_CCaoLotDaHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= TTKTHHCongHopRanh_CCaoLotMong)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong)
            {
                return TTKTHHCongHopRanh_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - TTKTHHCongHopRanh_CCaoLotMong;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong)
            {
                return TTCCCCCHR_CCaoMongDatHLuu < TTKTHHCongHopRanh_CCaoMong ? TTKTHHCongHopRanh_CCaoMong - TTCCCCCHR_CCaoMongDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - TTCCCCCHR_CCaoLotDaHLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoTuongDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTKTHHCongHopRanh_TongChieuCao)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            double giaTriToiDa = TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong;

            if (TTVLDCongRanh_TLChieuCaoDaoDat <= giaTriToiDa)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= TTKTHHCongHopRanh_TongChieuCao - giaTriToiDa)
            {
                return TTKTHHCongHopRanh_TongChieuCao - giaTriToiDa;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - giaTriToiDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoTuongDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTKTHHCongHopRanh_TongChieuCao)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            double giaTriToiDa = TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong;

            if (TTVLDCongRanh_HLChieuCaoDaoDat <= giaTriToiDa)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= TTKTHHCongHopRanh_TongChieuCao - giaTriToiDa)
            {
                return TTKTHHCongHopRanh_TongChieuCao - giaTriToiDa;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - giaTriToiDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoTuongDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTKTHHCongHopRanh_TongChieuCao, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCCHR_CCaoTuongDatTLuu, double TTCCCCCHR_CCaoLotDaTLuu, double TTCCCCCHR_CCaoMongDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            double giaTriToiDa = TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong;

            if (TTVLDCongRanh_TLChieuCaoDaoDa <= giaTriToiDa)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= TTKTHHCongHopRanh_TongChieuCao)
            {
                return TTKTHHCongHopRanh_TongChieuCao - giaTriToiDa;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - giaTriToiDa;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= TTKTHHCongHopRanh_TongChieuCao)
            {
                double giaTriToiDa = TTKTHHCongHopRanh_TongChieuCao - (TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong);
                if (TTCCCCCHR_CCaoTuongDatTLuu < giaTriToiDa)
                {
                    return giaTriToiDa - TTCCCCCHR_CCaoTuongDatTLuu;
                }
                else
                {
                    return 0;
                }
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (TTCCCCCHR_CCaoLotDaTLuu + TTCCCCCHR_CCaoMongDaTLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCCHR_CCaoTuongDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTKTHHCongHopRanh_CCaoLotMong, double TTKTHHCongHopRanh_CCaoMong, double TTKTHHCongHopRanh_TongChieuCao, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCCHR_CCaoTuongDatHLuu, double TTCCCCCHR_CCaoLotDaHLuu, double TTCCCCCHR_CCaoMongDaHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            double giaTriToiDa = TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong;

            if (TTVLDCongRanh_HLChieuCaoDaoDa <= giaTriToiDa)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= TTKTHHCongHopRanh_TongChieuCao)
            {
                return TTKTHHCongHopRanh_TongChieuCao - giaTriToiDa;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - giaTriToiDa;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= TTKTHHCongHopRanh_TongChieuCao)
            {
                double giaTriToiDa = TTKTHHCongHopRanh_TongChieuCao - (TTKTHHCongHopRanh_CCaoLotMong + TTKTHHCongHopRanh_CCaoMong);
                if (TTCCCCCHR_CCaoTuongDatHLuu < giaTriToiDa)
                {
                    return giaTriToiDa - TTCCCCCHR_CCaoTuongDatHLuu;
                }
                else
                {
                    return 0;
                }
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (TTCCCCCHR_CCaoLotDaHLuu + TTCCCCCHR_CCaoMongDaHLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDemCatDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDemCat : TTVLDCongRanh_TLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDemCatDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDemCat : TTVLDCongRanh_HLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDemCatDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTVLDCongRanh_TLTongChieuSauDao, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double TTCCCCON_CCaoDemCatDatTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDemCat : TTVLDCongRanh_TLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return TTCCCCON_CCaoDemCatDatTLuu < ThongTinKichThuocHinhHocOngNhua_CCaoDemCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDemCat - TTCCCCON_CCaoDemCatDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDemCatDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTVLDCongRanh_HLTongChieuSauDao, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double TTCCCCON_CCaoDemCatDatHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDemCat : TTVLDCongRanh_HLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return TTCCCCON_CCaoDemCatDatHLuu < ThongTinKichThuocHinhHocOngNhua_CCaoDemCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDemCat - TTCCCCON_CCaoDemCatDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoOngDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
            {
                return ThongTinKichThuocHinhHocOngNhua_TongCCaoOng;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoOngDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
            {
                return ThongTinKichThuocHinhHocOngNhua_TongCCaoOng;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat;
            }
        }
        else
        {
            return 0;
        }
    }

    public double TTCCCCON_CCaoOngDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCON_CCaoOngDatTLuu, double TTCCCCON_CCaoDemCatDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
            {
                return ThongTinKichThuocHinhHocOngNhua_TongCCaoOng;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                if (TTCCCCON_CCaoOngDatTLuu < ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
                {
                    return ThongTinKichThuocHinhHocOngNhua_TongCCaoOng - TTCCCCON_CCaoOngDatTLuu;
                }
                else
                {
                    return 0;
                }
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - TTCCCCON_CCaoDemCatDaTLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoOngDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCON_CCaoOngDatHLuu, double TTCCCCON_CCaoDemCatDaHLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
            {
                return ThongTinKichThuocHinhHocOngNhua_TongCCaoOng;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - ThongTinKichThuocHinhHocOngNhua_CCaoDemCat;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                if (TTCCCCON_CCaoOngDatHLuu < ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
                {
                    return ThongTinKichThuocHinhHocOngNhua_TongCCaoOng - TTCCCCON_CCaoOngDatHLuu;
                }
                else
                {
                    return 0;
                }
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - TTCCCCON_CCaoDemCatDaHLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDapCatDatTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
            {
                return ThongTinKichThuocHinhHocOngNhua_CCaoDapCat;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - (ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDapCatDatHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_TongCCaoOng)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
            {
                return ThongTinKichThuocHinhHocOngNhua_CCaoDapCat;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - (ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDapCatDaTLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCCCON_CCaoDapCatDatTLuu, double TTCCCCON_CCaoDemCatDaTLuu, double TTCCCCON_CCaoOngDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
            {
                return ThongTinKichThuocHinhHocOngNhua_CCaoDapCat;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
            {
                return TTCCCCON_CCaoDapCatDatTLuu < ThongTinKichThuocHinhHocOngNhua_CCaoDapCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDapCat - TTCCCCON_CCaoDapCatDatTLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - (TTCCCCON_CCaoDemCatDaTLuu + TTCCCCON_CCaoOngDaTLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCCCON_CCaoDapCatDaHLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCCCON_CCaoDapCatDatHLuu, double TTCCCCON_CCaoDemCatDaTLuu, double TTCCCCON_CCaoOngDaTLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
            {
                return ThongTinKichThuocHinhHocOngNhua_CCaoDapCat;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat);
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat)
            {
                return TTCCCCON_CCaoDapCatDatHLuu < ThongTinKichThuocHinhHocOngNhua_CCaoDapCat ? ThongTinKichThuocHinhHocOngNhua_CCaoDapCat - TTCCCCON_CCaoDapCatDatHLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - (TTCCCCON_CCaoDemCatDaTLuu + TTCCCCON_CCaoOngDaTLuu);
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_LotDatThuongLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinRanhThang_CCaoLot)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinRanhThang_CCaoLot ? ThongTinRanhThang_CCaoLot : TTVLDCongRanh_TLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_LotDatHaLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinRanhThang_CCaoLot)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinRanhThang_CCaoLot ? ThongTinRanhThang_CCaoLot : TTVLDCongRanh_HLChieuCaoDaoDat;
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_LotDaThuongLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double TTVLDCongRanh_TLTongChieuSauDao, double ThongTinRanhThang_CCaoLot, double TTCCRT_LotDatThuongLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinRanhThang_CCaoLot ? ThongTinRanhThang_CCaoLot : TTVLDCongRanh_TLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinRanhThang_CCaoLot)
            {
                return TTCCRT_LotDatThuongLuu < ThongTinRanhThang_CCaoLot ? ThongTinRanhThang_CCaoLot - TTCCRT_LotDatThuongLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_LotDaHaLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double TTVLDCongRanh_HLTongChieuSauDao, double ThongTinRanhThang_CCaoLot, double TTCCRT_LotDatHaLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            return TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinRanhThang_CCaoLot ? ThongTinRanhThang_CCaoLot : TTVLDCongRanh_HLChieuCaoDaoDa;
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinRanhThang_CCaoLot)
            {
                return TTCCRT_LotDatHaLuu < ThongTinRanhThang_CCaoLot ? ThongTinRanhThang_CCaoLot - TTCCRT_LotDatHaLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_MongDatThuongLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDat, double ThongTinRanhThang_CCaoLot, double ThongTinRanhThang_CCaoMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDat <= ThongTinRanhThang_CCaoLot)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDat >= ThongTinRanhThang_CCaoLot + ThongTinRanhThang_CCaoMong)
            {
                return ThongTinRanhThang_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDat - ThongTinRanhThang_CCaoLot;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_MongDatHaLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDat, double ThongTinRanhThang_CCaoLot, double ThongTinRanhThang_CCaoMong)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT" || TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDat <= ThongTinRanhThang_CCaoLot)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDat >= ThongTinRanhThang_CCaoLot + ThongTinRanhThang_CCaoMong)
            {
                return ThongTinRanhThang_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDat - ThongTinRanhThang_CCaoLot;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_MongDaThuongLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_TLChieuCaoDaoDa, double ThongTinRanhThang_CCaoLot, double ThongTinRanhThang_CCaoMong, double TTVLDCongRanh_TLTongChieuSauDao, double TTCCRT_MongDatThuongLuu, double TTCCRT_LotDaThuongLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLChieuCaoDaoDa <= ThongTinRanhThang_CCaoLot)
            {
                return 0;
            }
            else if (TTVLDCongRanh_TLChieuCaoDaoDa >= ThongTinRanhThang_CCaoLot + ThongTinRanhThang_CCaoMong)
            {
                return ThongTinRanhThang_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - ThongTinRanhThang_CCaoLot;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_TLTongChieuSauDao >= ThongTinRanhThang_CCaoLot + ThongTinRanhThang_CCaoMong)
            {
                return TTCCRT_MongDatThuongLuu < ThongTinRanhThang_CCaoMong ? ThongTinRanhThang_CCaoMong - TTCCRT_MongDatThuongLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_TLChieuCaoDaoDa - TTCCRT_LotDaThuongLuu;
            }
        }
        else
        {
            return 0;
        }
    }
    public double TTCCRT_MongDaHaLuu(string TTVLDCongRanh_LoaiVatLieuDao, double TTVLDCongRanh_HLChieuCaoDaoDa, double ThongTinRanhThang_CCaoLot, double ThongTinRanhThang_CCaoMong, double TTVLDCongRanh_HLTongChieuSauDao, double TTCCRT_MongDatHaLuu, double TTCCRT_LotDaHaLuu)
    {
        TTVLDCongRanh_LoaiVatLieuDao = GetTenDanhMucById(TTVLDCongRanh_LoaiVatLieuDao).ToUpper().Trim();

        if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLChieuCaoDaoDa <= ThongTinRanhThang_CCaoLot)
            {
                return 0;
            }
            else if (TTVLDCongRanh_HLChieuCaoDaoDa >= ThongTinRanhThang_CCaoLot + ThongTinRanhThang_CCaoMong)
            {
                return ThongTinRanhThang_CCaoMong;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - ThongTinRanhThang_CCaoLot;
            }
        }
        else if (TTVLDCongRanh_LoaiVatLieuDao == "ĐÀO ĐẤT + ĐÀO ĐÁ")
        {
            if (TTVLDCongRanh_HLTongChieuSauDao >= ThongTinRanhThang_CCaoLot + ThongTinRanhThang_CCaoMong)
            {
                return TTCCRT_MongDatHaLuu < ThongTinRanhThang_CCaoMong ? ThongTinRanhThang_CCaoMong - TTCCRT_MongDatHaLuu : 0;
            }
            else
            {
                return TTVLDCongRanh_HLChieuCaoDaoDa - TTCCRT_LotDaHaLuu;
            }
        }
        else
        {
            return 0;
        }
    }



    public double TKLD_KlDaoDat(double DTDTLCRONRT_DTichDaoDat, double DTDHLCRONRT_DTichDaoDat, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        return Math.Round(((DTDTLCRONRT_DTichDaoDat + DTDHLCRONRT_DTichDaoDat) / 2) * TTCDSLCauKienDuongTruyenDan_TongChieuDai, 2);
    }
    public double TKLD_KlDaoDa(double DTDTLCRONRT_DTichDaoDa, double DTDHLCRONRT_DTichDaoDa, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        return Math.Round(((DTDTLCRONRT_DTichDaoDa + DTDHLCRONRT_DTichDaoDa) / 2) * TTCDSLCauKienDuongTruyenDan_TongChieuDai, 2);
    }
    public double TKLD_TongKlDaoCongRanhOngNhuaRanhThang(double TKLD_KlDaoDat, double TKLD_KlDaoDa)
    {
        return Math.Round(TKLD_KlDaoDat + TKLD_KlDaoDa, 2);
    }
    public double TKLD_ChanKhay(double DTDCKRD_CKDTichDao, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        return Math.Round(DTDCKRD_CKDTichDao * TTCDSLCauKienDuongTruyenDan_TongChieuDai, 2);
    }
    public double TKLD_GiangDinh(double DTDCKRD_DTichDao, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        return Math.Round(DTDCKRD_DTichDao * TTCDSLCauKienDuongTruyenDan_TongChieuDai, 2);
    }
    public double TKLD_TongKlDaoDat(double TKLD_KlDaoDat, double TKLD_TongKlDaoDatChanKhayRanhDinh)
    {
        return Math.Round(TKLD_KlDaoDat + TKLD_TongKlDaoDatChanKhayRanhDinh, 2);
    }
    public double TKLD_TongKlDaoDa(double TKLD_KlDaoDa)
    {
        return Math.Round(TKLD_KlDaoDa, 2);
    }
    public double TKLD_TongKlDao(double TKLD_TongKlDaoDat, double TKLD_TongKlDaoDa)
    {
        return Math.Round(TKLD_TongKlDaoDat + TKLD_TongKlDaoDa, 2);
    }
    public double TKLD_KlCChoDatCongTron(double TTCCCCT_CCaoLotDatMongTBinh, double ThongTinCauTaoCongTron_CRongLotMong, double ThongTinCauTaoCongTron_CRongMong, double TTCCCCT_CCaoMongDatTBinh, double TTCCCCT_CCongCongDatTBinh, double TTCDSLCauKienDuongTruyenDan_TongChieuDai, double TTCCCCT_CCaoDeDatTBinh, double ThongTinDeCong_Kl01DeCong, double ThongTinDeCong_TongSoLuongDC)
    {
        double phan1 = (TTCCCCT_CCaoLotDatMongTBinh * ThongTinCauTaoCongTron_CRongLotMong) + (ThongTinCauTaoCongTron_CRongMong * TTCCCCT_CCaoMongDatTBinh) + ((3.14 * TTCCCCT_CCongCongDatTBinh * TTCCCCT_CCongCongDatTBinh) / 4);
        double phan2 = phan1 * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
        double phan3 = TTCCCCT_CCaoDeDatTBinh * ThongTinDeCong_Kl01DeCong * ThongTinDeCong_TongSoLuongDC;
        return Math.Round(phan2 + phan3, 2);
    }
    public double TKLD_KlCChoDaCongTron(double TTCCCCT_CCaoLotDaMongTBinh, double ThongTinCauTaoCongTron_CRongLotMong, double ThongTinCauTaoCongTron_CRongMong, double TTCCCCT_CCaoMongDaTBinh, double TTCCCCT_CCongCongDaTBinh, double TTCDSLCauKienDuongTruyenDan_TongChieuDai, double TTCCCCT_CCaoDeDaTBinh, double ThongTinDeCong_Kl01DeCong, double ThongTinDeCong_TongSoLuongDC)
    {
        double phan1 = (TTCCCCT_CCaoLotDaMongTBinh * ThongTinCauTaoCongTron_CRongLotMong) + (ThongTinCauTaoCongTron_CRongMong * TTCCCCT_CCaoMongDaTBinh) + ((3.14 * TTCCCCT_CCongCongDaTBinh * TTCCCCT_CCongCongDaTBinh) / 4);
        double phan2 = phan1 * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
        double phan3 = TTCCCCT_CCaoDeDaTBinh * ThongTinDeCong_Kl01DeCong * ThongTinDeCong_TongSoLuongDC;
        return Math.Round(phan2 + phan3, 2);
    }
    public double TKLD_TongKlChiemChoCTron(double TKLD_KlCChoDatCongTron, double TKLD_KlCChoDaCongTron)
    {
        return Math.Round(TKLD_KlCChoDatCongTron + TKLD_KlCChoDaCongTron, 2);
    }
    public double TKLD_KlCChoDatCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCCCCCHR_CCaoLotDatTBinh, double TTKTHHCongHopRanh_CRongLotMong, double TTKTHHCongHopRanh_CRongMong, double TTCCCCCHR_CCaoMongDatTBinh, double TTCCCCCHR_CCaoTuongDatTBinh, double TTKTHHCongHopRanh_CDayTuong01Ben, double TTKTHHCongHopRanh_SoLuongTuong, double TTKTHHCongHopRanh_CRongLongSuDung, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan.ToUpper() == "CỐNG HỘP")
        {
            double giaTri = ((TTCCCCCHR_CCaoLotDatTBinh * TTKTHHCongHopRanh_CRongLotMong) + (TTKTHHCongHopRanh_CRongMong * TTCCCCCHR_CCaoMongDatTBinh) + (TTCCCCCHR_CCaoTuongDatTBinh * ((TTKTHHCongHopRanh_CDayTuong01Ben * TTKTHHCongHopRanh_SoLuongTuong) + TTKTHHCongHopRanh_CRongLongSuDung))) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
            return Math.Round(giaTri, 2);
        }
        else
        {
            return 0;
        }
    }
    public double TKLD_KlCChoDaCongHop(string ThongTinDuongTruyenDan_HinhThucTruyenDan, double TTCCCCCHR_CCaoLotDaTBinh, double TTKTHHCongHopRanh_CRongLotMong, double TTKTHHCongHopRanh_CRongMong, double TTCCCCCHR_CCaoMongDaTBinh, double TTCCCCCHR_CCaoTuongDaTBinh, double TTKTHHCongHopRanh_CDayTuong01Ben, double TTKTHHCongHopRanh_SoLuongTuong, double TTKTHHCongHopRanh_CRongLongSuDung, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan.ToUpper() == "CỐNG HỘP")
        {

            double giaTri = ((TTCCCCCHR_CCaoLotDaTBinh * TTKTHHCongHopRanh_CRongLotMong) + (TTKTHHCongHopRanh_CRongMong * TTCCCCCHR_CCaoMongDaTBinh) + (TTCCCCCHR_CCaoTuongDaTBinh * ((TTKTHHCongHopRanh_CDayTuong01Ben * TTKTHHCongHopRanh_SoLuongTuong) + TTKTHHCongHopRanh_CRongLongSuDung))) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
            return Math.Round(giaTri, 2);
        }
        else
        {
            // Trả về 0 nếu điều kiện không thỏa mãn
            return 0;
        }
    }
    public double TKLD_TongKlCChoCongHop(double TKLD_KlCChoDatCongHop, double TKLD_KlCChoDaCongHop)
    {
        // Tính tổng và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_KlCChoDatCongHop + TKLD_KlCChoDaCongHop, 2);
    }
    public double TKLD_KlCChoDatRanh(double TTCCCCCHR_CCaoLotDatTBinh, double TTKTHHCongHopRanh_CRongLotMong, double TTKTHHCongHopRanh_CRongMong, double TTCCCCCHR_CCaoMongDatTBinh, double TTCCCCCHR_CCaoTuongDatTBinh, double TTKTHHCongHopRanh_CDayTuong01Ben, double TTKTHHCongHopRanh_SoLuongTuong, double TTKTHHCongHopRanh_CRongLongSuDung, double TTCDSLCauKienDuongTruyenDan_TongChieuDai, string ThongTinDuongTruyenDan_HinhThucTruyenDan)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH XÂY" || ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH BÊ TÔNG")
        {
            // Tính toán giá trị
            double giaTri = ((TTCCCCCHR_CCaoLotDatTBinh * TTKTHHCongHopRanh_CRongLotMong) + (TTKTHHCongHopRanh_CRongMong * TTCCCCCHR_CCaoMongDatTBinh) + (TTCCCCCHR_CCaoTuongDatTBinh * ((TTKTHHCongHopRanh_CDayTuong01Ben * TTKTHHCongHopRanh_SoLuongTuong) + TTKTHHCongHopRanh_CRongLongSuDung))) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
            // Làm tròn đến 2 chữ số thập phân
            return Math.Round(giaTri, 2);
        }
        else
        {
            return 0;
        }
    }
    public double TKLD_KlCChoDaRanh(double TTCCCCCHR_CCaoLotDaTBinh, double TTKTHHCongHopRanh_CRongLotMong, double TTKTHHCongHopRanh_CRongMong, double TTCCCCCHR_CCaoMongDaTBinh, double TTCCCCCHR_CCaoTuongDaTBinh, double TTKTHHCongHopRanh_CDayTuong01Ben, double TTKTHHCongHopRanh_SoLuongTuong, double TTKTHHCongHopRanh_CRongLongSuDung, double TTCDSLCauKienDuongTruyenDan_TongChieuDai, string ThongTinDuongTruyenDan_HinhThucTruyenDan)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH XÂY" || ThongTinDuongTruyenDan_HinhThucTruyenDan == "RÃNH BÊ TÔNG")
        {
            // Tính toán giá trị
            double giaTri = ((TTCCCCCHR_CCaoLotDaTBinh * TTKTHHCongHopRanh_CRongLotMong) + (TTKTHHCongHopRanh_CRongMong * TTCCCCCHR_CCaoMongDaTBinh) + (TTCCCCCHR_CCaoTuongDaTBinh * ((TTKTHHCongHopRanh_CDayTuong01Ben * TTKTHHCongHopRanh_SoLuongTuong) + TTKTHHCongHopRanh_CRongLongSuDung))) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
            // Làm tròn đến 2 chữ số thập phân
            return Math.Round(giaTri, 2);
        }
        else
        {
            return 0;
        }
    }
    public double TKLD_TongKlCChoRanh(double TKLD_KlCChoDatRanh, double TKLD_KlCChoDaRanh)
    {
        // Tính tổng  TKLD_KlCChoDatRanh  và  TKLD_KlCChoDaRanh
        double result = TKLD_KlCChoDatRanh + TKLD_KlCChoDaRanh;
        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(result, 2);
    }
    public double TKLD_KlCChoDatOngNhua(double TTCCCCON_CCaoDemCatDatTBinh, double TTCCCCON_CCaoDatTBinh, double TTCCCCON_CCaoDapCatDatTBinh, double TTMDRanhOngThang_TyLeMoMai, double TTMDRanhOngThang_SoCanhMaiTrai, double TTMDRanhOngThang_SoCanhMaiPhai, double TTMDRanhOngThang_ChieuRongDayDaoNho, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        double sumOEOKOQ = TTCCCCON_CCaoDemCatDatTBinh + TTCCCCON_CCaoDatTBinh + TTCCCCON_CCaoDapCatDatTBinh;
        double intermediateResult = ((((sumOEOKOQ * TTMDRanhOngThang_TyLeMoMai * (TTMDRanhOngThang_SoCanhMaiTrai + TTMDRanhOngThang_SoCanhMaiPhai)) + TTMDRanhOngThang_ChieuRongDayDaoNho) + TTMDRanhOngThang_ChieuRongDayDaoNho) * (sumOEOKOQ / 2)) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(intermediateResult, 2);
    }
    public double TKLD_KlCChoDaOngNhua(double TTCCCCON_CCaoDemCatDaTBinh, double TTCCCCON_CCaoDaTBinh, double TTCCCCON_CCaoDapCatDaTBinh, double TTMDRanhOngThang_TyLeMoMai, double TTMDRanhOngThang_SoCanhMaiTrai, double TTMDRanhOngThang_SoCanhMaiPhai, double TTMDRanhOngThang_ChieuRongDayDaoNho, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        // Tính tổng của TTCCCCON_CCaoDemCatDaTBinh   , TTCCCCON_CCaoDaTBinh và   TTCCCCON_CCaoDapCatDaTBinh
        double sumOHONOT = TTCCCCON_CCaoDemCatDaTBinh + TTCCCCON_CCaoDaTBinh + TTCCCCON_CCaoDapCatDaTBinh;

        // Tính toán biểu thức phức tạp
        double intermediateResult = (((((sumOHONOT * TTMDRanhOngThang_TyLeMoMai * (TTMDRanhOngThang_SoCanhMaiTrai + TTMDRanhOngThang_SoCanhMaiPhai)) + TTMDRanhOngThang_ChieuRongDayDaoNho) + TTMDRanhOngThang_ChieuRongDayDaoNho) * (sumOHONOT / 2)) * TTCDSLCauKienDuongTruyenDan_TongChieuDai);

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(intermediateResult, 2);
    }
    public double TKLD_TongKlCChoOngNhua(double TKLD_KlCChoDatOngNhua, double TKLD_KlCChoDaOngNhua)
    {
        // Tính tổng của  TKLD_KlCChoDatOngNhua  và  TKLD_KlCChoDaOngNhua
        double sum = TKLD_KlCChoDatOngNhua + TKLD_KlCChoDaOngNhua;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(sum, 2);
    }
    public double TKLD_KlCChoDatRanhThang(double TTCCRT_LotDatTrungBinh, double ThongTinRanhThang_CRongLot, double ThongTinRanhThang_CRongMong, double TTCCRT_MongDatTrungBinh, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        // Tính toán giá trị theo công thức
        double result = ((TTCCRT_LotDatTrungBinh * ThongTinRanhThang_CRongLot) + (ThongTinRanhThang_CRongMong * TTCCRT_MongDatTrungBinh)) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(result, 2);
    }
    public double TKLD_KlCChoDaRanhThang(double TTCCRT_LotDaTrungBinh, double ThongTinRanhThang_CRongLot, double ThongTinRanhThang_CRongMong, double TTCCRT_MongDaTrungBinh, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        // Tính toán giá trị theo công thức
        double result = ((TTCCRT_LotDaTrungBinh * ThongTinRanhThang_CRongLot) + (ThongTinRanhThang_CRongMong * TTCCRT_MongDaTrungBinh)) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(result, 2);
    }
    public double TKLD_TongKlCChoRanhThang(double TKLD_KlCChoDatRanhThang, double TKLD_KlCChoDaRanhThang)
    {
        // Tính tổng của  TKLD_KlCChoDatRanhThang  và  TKLD_KlCChoDaRanhThang
        double result = TKLD_KlCChoDatRanhThang + TKLD_KlCChoDaRanhThang;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(result, 2);
    }
    public double TKLD_KlCChoDatChanKhay(double ThongTinRanhThang_CCaoLotChanKhay, double ThongTinRanhThang_CRongLotChanKhay, double ThongTinRanhThang_SoLuongLotChanKhay, double ThongTinRanhThang_CCaoMongChanKhay, double ThongTinRanhThang_CRongMongChanKhay, double ThongTinRanhThang_SoLuongMongChanKhay, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        // Tính toán giá trị theo công thức
        double result = ((ThongTinRanhThang_CCaoLotChanKhay * ThongTinRanhThang_CRongLotChanKhay * ThongTinRanhThang_SoLuongLotChanKhay) + (ThongTinRanhThang_CCaoMongChanKhay * ThongTinRanhThang_CRongMongChanKhay * ThongTinRanhThang_SoLuongMongChanKhay)) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(result, 2);
    }
    public double TKLD_KlCChoDatChanGiangDinh(double ThongTinRanhThang_CCaoLotGiangDinh, double ThongTinRanhThang_CRongLotGiangDinh, double ThongTinRanhThang_SoLuongLotGiangDinh, double ThongTinRanhThang_CCaoMongGiangDinh, double ThongTinRanhThang_CRongMongGiangDinh, double ThongTinRanhThang_SoLuongMongGiangDinh, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        // Tính toán giá trị theo công thức
        double result = ((ThongTinRanhThang_CCaoLotGiangDinh * ThongTinRanhThang_CRongLotGiangDinh * ThongTinRanhThang_SoLuongLotGiangDinh) + (ThongTinRanhThang_CCaoMongGiangDinh * ThongTinRanhThang_CRongMongGiangDinh * ThongTinRanhThang_SoLuongMongGiangDinh)) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;

        // Làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(result, 2);
    }
    public double TKLD_TongKlCChoDat(double TKLD_KlCChoDatRanhThang, double TKLD_KlCChoDatChanKhay, double TKLD_KlCChoDatChanGiangDinh)
    {
        // Tính tổng và làm tròn kết quả đến 2 chữ số thập phân
        return Math.Round(TKLD_KlCChoDatRanhThang + TKLD_KlCChoDatChanKhay + TKLD_KlCChoDatChanGiangDinh, 2);
    }
    public double TKLD_TongKlCChoDa(double TKLD_KlCChoDaRanhThang)
    {
        // Làm tròn giá trị  TKLD_KlCChoDaRanhThang  đến 2 chữ số thập phân
        return Math.Round(TKLD_KlCChoDaRanhThang, 2);
    }
    public double TKLD_TongKlCCho(double TKLD_TongKlCChoDat, double TKLD_TongKlCChoDa)
    {
        // Tính tổng của  TKLD_TongKlCChoDat  và  TKLD_TongKlCChoDa , sau đó làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_TongKlCChoDat + TKLD_TongKlCChoDa, 2);
    }
    public double TKLD_KlCChoDat(double TKLD_KlCChoDatCongTron, double TKLD_KlCChoDatCongHop, double TKLD_KlCChoDatRanh, double TKLD_KlCChoDatOngNhua, double TKLD_TongKlCChoDat)
    {
        // Tính tổng của các giá trị và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_KlCChoDatCongTron + TKLD_KlCChoDatCongHop + TKLD_KlCChoDatRanh + TKLD_KlCChoDatOngNhua + TKLD_TongKlCChoDat, 2);
    }
    public double TKLD_KlCChoDa(double TKLD_KlCChoDaCongTron, double TKLD_KlCChoDaCongHop, double TKLD_KlCChoDaRanh, double TKLD_KlCChoDaOngNhua, double TKLD_TongKlCChoDa)
    {
        // Tính tổng của các giá trị và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_KlCChoDaCongTron + TKLD_KlCChoDaCongHop + TKLD_KlCChoDaRanh + TKLD_KlCChoDaOngNhua + TKLD_TongKlCChoDa, 2);
    }
    public double TKLD_TongChiemCho(double TKLD_KlCChoDat, double TKLD_KlCChoDa)
    {
        // Tính tổng của các giá trị và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_KlCChoDat + TKLD_KlCChoDa, 2);
    }
    public double TKLD_KlDapTraDat(double TKLD_TongKlDaoDat, double TKLD_KlCChoDat)
    {
        // Tính hiệu của các giá trị và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_TongKlDaoDat - TKLD_KlCChoDat, 2);
    }
    public double TKLD_KlDapTraDa(double TKLD_TongKlDaoDa, double TKLD_KlCChoDa)
    {
        // Tính hiệu của các giá trị và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_TongKlDaoDa - TKLD_KlCChoDa, 2);
    }
    public double TKLD_TongKlDapTra(double TKLD_KlDapTraDat, double TKLD_KlDapTraDa)
    {
        // Tính tổng của các giá trị và làm tròn đến 2 chữ số thập phân
        return Math.Round(TKLD_KlDapTraDat + TKLD_KlDapTraDa, 2);
    }
    public double DTDC_TLCSauDap(double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();

        // Kiểm tra điều kiện và tính tổng nếu điều kiện đúng, sau đó làm tròn đến 2 chữ số thập phân
        double result = (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT") ? ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat : 0;
        return Math.Round(result, 2);
    }
    public double DTDC_TLCRongDapDayLon(double DTDC_TLCSauDap, double TTMDRanhOngThang_TyLeMoMai, double TTMDRanhOngThang_SoCanhMaiTrai, double TTMDRanhOngThang_SoCanhMaiPhai, double TTMDRanhOngThang_ChieuRongDayDaoNho, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();

        // Kiểm tra điều kiện và tính giá trị nếu điều kiện đúng, sau đó làm tròn đến 2 chữ số thập phân
        double result = (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT")
            ? (DTDC_TLCSauDap * TTMDRanhOngThang_TyLeMoMai * (TTMDRanhOngThang_SoCanhMaiTrai + TTMDRanhOngThang_SoCanhMaiPhai)) + TTMDRanhOngThang_ChieuRongDayDaoNho
            : 0;
        return Math.Round(result, 2);
    }
    public double DTDC_TLDTichDap(double DTDC_TLCRongDapDayLon, double TTMDRanhOngThang_ChieuRongDayDaoNho, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();

        // Kiểm tra điều kiện và tính giá trị nếu điều kiện đúng, sau đó làm tròn đến 2 chữ số thập phân
        double result = (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT")
            ? (DTDC_TLCRongDapDayLon + TTMDRanhOngThang_ChieuRongDayDaoNho) * ((ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat) / 2)
            : 0;
        return Math.Round(result, 2);
    }
    public double DTDC_HLCSauDap(double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();

        // Kiểm tra điều kiện và tính giá trị nếu điều kiện đúng, sau đó làm tròn đến 2 chữ số thập phân
        double result = (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT")
            ? ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat
            : 0;
        return Math.Round(result, 2);
    }
    public double DTDC_HLCRongDapDayLon(double DTDC_HLCSauDap, double TTMDRanhOngThang_TyLeMoMai, double TTMDRanhOngThang_SoCanhMaiTrai, double TTMDRanhOngThang_SoCanhMaiPhai, double TTMDRanhOngThang_ChieuRongDayDaoNho, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();

        // Kiểm tra điều kiện và tính giá trị nếu điều kiện đúng, sau đó làm tròn đến 2 chữ số thập phân
        double result = (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT")
            ? (DTDC_HLCSauDap * TTMDRanhOngThang_TyLeMoMai * (TTMDRanhOngThang_SoCanhMaiTrai + TTMDRanhOngThang_SoCanhMaiPhai)) + TTMDRanhOngThang_ChieuRongDayDaoNho
            : 0;
        return Math.Round(result, 2);
    }
    public double DTDC_HLDTichDap(double DTDC_HLCRongDapDayLon, double TTMDRanhOngThang_ChieuRongDayDaoNho, double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double ThongTinKichThuocHinhHocOngNhua_CCaoDemCat, double ThongTinKichThuocHinhHocOngNhua_CCaoDapCat, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        ThongTinDuongTruyenDan_HinhThucTruyenDan = GetTenDanhMucById(ThongTinDuongTruyenDan_HinhThucTruyenDan).ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = GetTenDanhMucById(ThongTinMongDuongTruyenDan_LoaiMong).ToUpper().Trim();

        // Kiểm tra điều kiện và tính giá trị nếu điều kiện đúng, sau đó làm tròn đến 2 chữ số thập phân
        double result = (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT")
            ? (DTDC_HLCRongDapDayLon + TTMDRanhOngThang_ChieuRongDayDaoNho) * ((ThongTinKichThuocHinhHocOngNhua_TongCCaoOng + ThongTinKichThuocHinhHocOngNhua_CCaoDemCat + ThongTinKichThuocHinhHocOngNhua_CCaoDapCat) / 2)
            : 0;
        return Math.Round(result, 2);
    }
    public double TTKLDC_KlDapCatTruocChiemCho(double DTDC_TLDTichDap, double DTDC_HLDTichDap, double TTCDSLCauKienDuongTruyenDan_TongChieuDai)
    {
        // Tính giá trị theo công thức và làm tròn đến 2 chữ số thập phân
        double result = ((DTDC_TLDTichDap + DTDC_HLDTichDap) / 2) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
        return Math.Round(result, 2);
    }
    public double TTKLDC_KlChiemCho(double ThongTinKichThuocHinhHocOngNhua_TongCCaoOng, double TTCDSLCauKienDuongTruyenDan_TongChieuDai, string ThongTinDuongTruyenDan_HinhThucTruyenDan, string ThongTinMongDuongTruyenDan_LoaiMong)
    {
        // Chuyển đổi các tham số ThongTinDuongTruyenDan_HinhThucTruyenDan  và  ThongTinMongDuongTruyenDan_LoaiMong  thành dạng chữ hoa và loại bỏ khoảng trắng đầu cuối
        ThongTinDuongTruyenDan_HinhThucTruyenDan = ThongTinDuongTruyenDan_HinhThucTruyenDan.ToUpper().Trim();
        ThongTinMongDuongTruyenDan_LoaiMong = ThongTinMongDuongTruyenDan_LoaiMong.ToUpper().Trim();

        // Kiểm tra điều kiện
        if (ThongTinDuongTruyenDan_HinhThucTruyenDan == "ỐNG NHỰA" && ThongTinMongDuongTruyenDan_LoaiMong == "ĐẮP CÁT")
        {
            // Tính giá trị theo công thức và làm tròn đến 2 chữ số thập phân
            double result = ((3.14 * ThongTinKichThuocHinhHocOngNhua_TongCCaoOng * ThongTinKichThuocHinhHocOngNhua_TongCCaoOng) / 4) * TTCDSLCauKienDuongTruyenDan_TongChieuDai;
            return Math.Round(result, 2);
        }
        else
        {
            // Trả về 0 nếu điều kiện không thỏa mãn
            return 0;
        }
    }








    // Sắp xếp data
    private void SortTable(string columnName)
    {
        listModel = SortService.SortTable(listModel, columnName);
        hopRanhThangModel.PageNumber = 1;
        Paging(listModel);
    }

    // Get css cho chức năng sắp xếp
    private string GetSortStyle(string columnName)
    {
        return SortService.GetSortStyle(columnName);
    }

    // Xử lý trường hợp đổi page hiển thị
    private void SelectedPage(int page)
    {
        hopRanhThangModel.PageNumber = page;
        Paging(listHopRanhThang);
    }

    // Xử lý trường hợp đổi số lượng bản ghi hiển thị trên page
    private void ChangePageSize(int pageSize)
    {

        hopRanhThangModel.PageNumber = 1;
        hopRanhThangModel.pageSize = pageSize;
        Paging(listHopRanhThang);
    }
    // Xử lý paging
    private List<HopRanhThangModel> Paging(List<HopRanhThangModel> hopRanhThangs)
    {
        // Đếm số bản ghi thỏa mãn
        var count = hopRanhThangs.Count();

        // Lọc bản ghi theo page hiện tại và page size
        hopRanhThangs = hopRanhThangs.Skip((hopRanhThangModel.PageNumber - 1) * hopRanhThangModel.PageSize).Take(hopRanhThangModel.PageSize).ToList();

        // Xóa danh sách đang hiển thị trên màn hình
        listHopRanhThang.Clear();

        // Thêm những bản ghi sau khi lọc vào danh sách hiển thị
        foreach (var major in hopRanhThangs)
        {
            listHopRanhThang.Add(major);
        }

        // Tạo pagelist mới

        var pagelist = new PageList<HopRanhThangModel>(listHopRanhThang, count, hopRanhThangModel.PageNumber, hopRanhThangModel.PageSize);
        MetaData = pagelist.MetaData;
        return hopRanhThangs;
    }
}
