@page "/NghiepVuCongTrinh/PhanLoaiHoGa"

<div class="m-4">

    <CustomModal IsVisible="isModalVisible" OnClose="HandleModalClose" Title="@TitleModal" Size="modal-lg">
        <BodyTemplate>
            <EditForm Model="Input" id="editFormId" OnInvalidSubmit="HandleInValidSubmit" OnValidSubmit="HandleValidSubmit">
                <DataAnnotationsValidator />
                <ValidationSummary />
                <div class="row">
                    <div class="col">
                        <h5 class="mt-2">Thông tin chung hố ga</h5>
                        <hr />
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-4 ">
                                <label for="ThongTinChungHoGa_TenHoGaSauPhanLoai">Tên hố ga sau phân loại <span class="text-danger"></span></label>
                                <InputText  @bind-Value="Input.ThongTinChungHoGa_TenHoGaSauPhanLoai" class="form-control" id="ThongTinChungHoGa_TenHoGaSauPhanLoai" placeholder="Tên hố ga sau phân loại" />
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_TenHoGaSauPhanLoai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_HinhThucHoGa"> Hình thức hố ga <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_HinhThucHoGa" class="form-control" @bind="Input.ThongTinChungHoGa_HinhThucHoGa">
                                    <option value="">Hình thức hố ga ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("HG_HTHGa"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_HinhThucHoGa" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_KetCauMuMo"> Kết cấu mũ mố <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_KetCauMuMo" class="form-control" @bind="Input.ThongTinChungHoGa_KetCauMuMo">
                                    <option value="">Kết cấu mũ mố ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("HG_LMMHoGa"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_KetCauMuMo" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_KetCauTuong"> Kết cấu tường <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_KetCauTuong" class="form-control" @bind="Input.ThongTinChungHoGa_KetCauTuong" name="ThongTinChungHoGa_KetCauTuong">
                                    <option value="">Kết cấu tường ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("HG_LTHoGa"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_KetCauTuong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_HinhThucMongHoGa"> Hình thức móng hố ga <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_HinhThucMongHoGa" class="form-control" @bind="Input.ThongTinChungHoGa_HinhThucMongHoGa">
                                    <option value="">Hình thức móng hố ga  ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("HG_HTMHoGa"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_HinhThucMongHoGa" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_KetCauMong"> Kết cấu móng <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_KetCauMong" class="form-control" @bind="Input.ThongTinChungHoGa_KetCauMong">
                                    <option value="">Kết cấu móng ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("HG_LMHoGa"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_KetCauMong" class="text-danger" />
                            </div>

                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_ChatMatTrong"> Chát mặt trong <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_ChatMatTrong" class="form-control" @bind="Input.ThongTinChungHoGa_ChatMatTrong">
                                    <option value="">Chát mặt trong ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("DM_CoKhong"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_ChatMatTrong" class="text-danger" />
                            </div>

                            <div class="form-floating col-sm-6 col-md-3 col-lg-4">
                                <label for="ThongTinChungHoGa_ChatMatNgoai"> Chát mặt ngoài <span class="text-danger">*</span></label>
                                <select readonly="@isEdit" id="ThongTinChungHoGa_ChatMatNgoai" class="form-control" @bind="Input.ThongTinChungHoGa_ChatMatNgoai">
                                    <option value="">Chát mặt ngoài ...</option>
                                    @foreach (var dm in FindByIdNhomDanhMuc("DM_CoKhong"))
                                    {
                                        <option value="@dm.Id">@dm.Ten</option>
                                    }
                                </select>
                                <ValidationMessage For="() => Input.ThongTinChungHoGa_ChatMatNgoai" class="text-danger" />
                            </div>

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h4 class="mt-2">Thông tin kích thước hình học hố ga</h4>
                        <hr />
                        <h5 class="mt-2">1.Thông tin phủ bì hố ga (m)</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="PhuBiHoGa_CDai">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.PhuBiHoGa_CDai" class="form-control" id="PhuBiHoGa_CDai" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.PhuBiHoGa_CDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="PhuBiHoGa_CRong">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.PhuBiHoGa_CRong" class="form-control" id="PhuBiHoGa_CRong" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.PhuBiHoGa_CRong" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">2.Kích thước hình học bê tông lót móng hố ga (m)</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="BeTongLotMong_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.BeTongLotMong_D" class="form-control" id="BeTongLotMong_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.BeTongLotMong_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="BeTongLotMong_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.BeTongLotMong_R" class="form-control" id="BeTongLotMong_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.BeTongLotMong_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="BeTongLotMong_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.BeTongLotMong_C" class="form-control" id="BeTongLotMong_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.BeTongLotMong_C" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">3.Kích thước hình học bê tông móng hố ga (m)</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="BeTongMongHoGa_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.BeTongMongHoGa_D" class="form-control" id="BeTongMongHoGa_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.BeTongMongHoGa_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="BeTongLotMong_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.BeTongMongHoGa_R" class="form-control" id="BeTongMongHoGa_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.BeTongMongHoGa_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="BeTongMongHoGa_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.BeTongMongHoGa_C" class="form-control" id="BeTongMongHoGa_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.BeTongMongHoGa_C" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">4.KTHH đế hố ga(m)</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DeHoGa_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DeHoGa_D" class="form-control" id="DeHoGa_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.DeHoGa_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DeHoGa_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DeHoGa_R" class="form-control" id="DeHoGa_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.DeHoGa_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DeHoGa_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DeHoGa_C" class="form-control" id="DeHoGa_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.DeHoGa_C" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">5.Kích thước hình học tường hố ga (m)</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="TuongHoGa_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.TuongHoGa_D" class="form-control" id="TuongHoGa_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.TuongHoGa_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="TuongHoGa_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.TuongHoGa_R" class="form-control" id="TuongHoGa_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.TuongHoGa_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="TuongHoGa_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.TuongHoGa_C" class="form-control" id="TuongHoGa_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.TuongHoGa_C" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DeHoGa_C">Chiều dài tường (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.TuongHoGa_CdTuong" class="form-control" id="TuongHoGa_CdTuong" placeholder="Chiều dài tường" />
                                <ValidationMessage For="() => Input.TuongHoGa_CdTuong" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">6.KTHH dầm giữa hố ga (m)</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DamGiuaHoGa_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DamGiuaHoGa_D" class="form-control" id="DamGiuaHoGa_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.DamGiuaHoGa_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DamGiuaHoGa_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DamGiuaHoGa_R" class="form-control" id="DamGiuaHoGa_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.DamGiuaHoGa_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DamGiuaHoGa_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DamGiuaHoGa_C" class="form-control" id="DamGiuaHoGa_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.DamGiuaHoGa_C" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DamGiuaHoGa_CdDam">Chiều dài tường (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DamGiuaHoGa_CdDam" class="form-control" id="DamGiuaHoGa_CdDam" placeholder="Chiều dài dầm" />
                                <ValidationMessage For="() => Input.DamGiuaHoGa_CdDam" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa">C.Cao dầm giữa tường so với đáy hố ga (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa" class="form-control" id="DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa" placeholder="Chiều dài dầm" />
                                <ValidationMessage For="() => Input.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">7.Chát hố ga mặt trong </h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="ChatMatTrong_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.ChatMatTrong_D" class="form-control" id="ChatMatTrong_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.ChatMatTrong_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="ChatMatTrong_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.ChatMatTrong_R" class="form-control" id="ChatMatTrong_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.ChatMatTrong_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="ChatMatTrong_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.ChatMatTrong_C" class="form-control" id="ChatMatTrong_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.ChatMatTrong_C" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">8.Chát hố ga mặt ngoài, cạnh 01 +02 (m)  </h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="ChatMatNgoaiCanh_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.ChatMatNgoaiCanh_D" class="form-control" id="ChatMatNgoaiCanh_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.ChatMatNgoaiCanh_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="ChatMatNgoaiCanh_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.ChatMatNgoaiCanh_R" class="form-control" id="ChatMatNgoaiCanh_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.ChatMatNgoaiCanh_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="ChatMatNgoaiCanh_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.ChatMatNgoaiCanh_C" class="form-control" id="ChatMatNgoaiCanh_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.ChatMatNgoaiCanh_C" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">9.Kích thước hình học tường mũ mố thớt dưới (m) </h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotDuoi_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotDuoi_D" class="form-control" id="MuMoThotDuoi_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.MuMoThotDuoi_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotDuoi_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotDuoi_R" class="form-control" id="MuMoThotDuoi_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.MuMoThotDuoi_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotDuoi_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotDuoi_C" class="form-control" id="MuMoThotDuoi_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.MuMoThotDuoi_C" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotDuoi_CdTuong">Chiều dài tường (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotDuoi_CdTuong" class="form-control" id="MuMoThotDuoi_CdTuong" placeholder="Chiều dài tường" />
                                <ValidationMessage For="() => Input.MuMoThotDuoi_CdTuong" class="text-danger" />
                            </div>
                        </div>
                        <h5 class="mt-2">10.Kích thước hình học tường mũ mố thớt trên (m) (m) </h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotTren_D">Chiểu dài (m) <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotTren_D" class="form-control" id="MuMoThotTren_D" placeholder="Chiểu dài" />
                                <ValidationMessage For="() => Input.MuMoThotTren_D" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotTren_R">Chiều rộng (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotTren_R" class="form-control" id="MuMoThotTren_R" placeholder="Chiều rộng" />
                                <ValidationMessage For="() => Input.MuMoThotTren_R" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotTren_C">Chiều cao (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotTren_C" class="form-control" id="MuMoThotTren_C" placeholder="Chiều cao" />
                                <ValidationMessage For="() => Input.MuMoThotTren_C" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3">
                                <label for="MuMoThotTren_CdTuong">Chiều dài tường (m)<span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.MuMoThotTren_CdTuong" class="form-control" id="MuMoThotTren_CdTuong" placeholder="Chiều dài tường" />
                                <ValidationMessage For="() => Input.MuMoThotTren_CdTuong" class="text-danger" />
                            </div>
                        </div>

                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h4 class="mt-2">Hạng mục chiếm chỗ hố ga</h4>
                        <hr />
                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi1_Loai">Loại <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi1_Loai" class="form-control" id="HinhThucDauNoi1_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi1_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi1_CanhDai">Cạnh dài <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi1_CanhDai" class="form-control" id="HinhThucDauNoi1_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi1_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi1_CanhRong">Cạnh rộng <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi1_CanhRong" class="form-control" id="HinhThucDauNoi1_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi1_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi1_CanhCheo">Cạnh chéo <span class="text-danger">*</span></label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi1_CanhCheo" class="form-control" id="HinhThucDauNoi1_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi1_CanhCheo" class="text-danger" />
                            </div>
                        </div>
                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi2_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi2_Loai" class="form-control" id="HinhThucDauNoi2_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi2_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi2_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi2_CanhDai" class="form-control" id="HinhThucDauNoi2_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi2_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi2_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi2_CanhRong" class="form-control" id="HinhThucDauNoi2_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi2_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi2_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi2_CanhCheo" class="form-control" id="HinhThucDauNoi2_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi2_CanhCheo" class="text-danger" />
                            </div>
                        </div>
                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi3_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi3_Loai" class="form-control" id="HinhThucDauNoi3_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi3_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi3_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi3_CanhDai" class="form-control" id="HinhThucDauNoi3_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi3_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi3_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi3_CanhRong" class="form-control" id="HinhThucDauNoi3_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi3_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi3_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi3_CanhCheo" class="form-control" id="HinhThucDauNoi3_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi3_CanhCheo" class="text-danger" />
                            </div>
                        </div>
                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi4_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi4_Loai" class="form-control" id="HinhThucDauNoi4_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi4_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi4_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi4_CanhDai" class="form-control" id="HinhThucDauNoi4_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi4_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi4_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi4_CanhRong" class="form-control" id="HinhThucDauNoi4_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi4_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi4_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi4_CanhCheo" class="form-control" id="HinhThucDauNoi4_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi4_CanhCheo" class="text-danger" />
                            </div>
                        </div>
                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi5_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi5_Loai" class="form-control" id="HinhThucDauNoi5_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi5_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi5_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi5_CanhDai" class="form-control" id="HinhThucDauNoi5_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi5_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi5_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi5_CanhRong" class="form-control" id="HinhThucDauNoi5_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi5_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi5_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi5_CanhCheo" class="form-control" id="HinhThucDauNoi5_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi5_CanhCheo" class="text-danger" />
                            </div>
                        </div>

                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi6_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi6_Loai" class="form-control" id="HinhThucDauNoi6_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi6_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi6_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi6_CanhDai" class="form-control" id="HinhThucDauNoi6_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi6_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi6_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi6_CanhRong" class="form-control" id="HinhThucDauNoi6_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi6_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi6_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi6_CanhCheo" class="form-control" id="HinhThucDauNoi6_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi6_CanhCheo" class="text-danger" />
                            </div>
                        </div>

                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi7_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi7_Loai" class="form-control" id="HinhThucDauNoi7_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi7_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi7_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi7_CanhDai" class="form-control" id="HinhThucDauNoi7_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi7_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi7_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi7_CanhRong" class="form-control" id="HinhThucDauNoi7_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi7_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi7_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi7_CanhCheo" class="form-control" id="HinhThucDauNoi7_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi7_CanhCheo" class="text-danger" />
                            </div>
                        </div>

                        <h5>Hình thức đấu nối</h5>
                        <div class="row">
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi8_Loai">Loại </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi8_Loai" class="form-control" id="HinhThucDauNoi8_Loai" placeholder="Loại" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi8_Loai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi8_CanhDai">Cạnh dài </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi8_CanhDai" class="form-control" id="HinhThucDauNoi8_CanhDai" placeholder="Cạnh dài" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi8_CanhDai" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi8_CanhRong">Cạnh rộng </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi8_CanhRong" class="form-control" id="HinhThucDauNoi8_CanhRong" placeholder="Cạnh rộng" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi8_CanhRong" class="text-danger" />
                            </div>
                            <div class="form-floating col-sm-6 col-md-3 col-lg-3">
                                <label for="HinhThucDauNoi8_CanhCheo">Cạnh chéo </label>
                                <InputNumber readonly="@isEdit" @bind-Value="Input.HinhThucDauNoi8_CanhCheo" class="form-control" id="HinhThucDauNoi8_CanhCheo" placeholder="Cạnh chéo" />
                                <ValidationMessage For="() => Input.HinhThucDauNoi8_CanhCheo" class="text-danger" />
                            </div>
                        </div>
                    </div>
                </div>
 
            </EditForm>
        </BodyTemplate>
         <FooterTemplate>
                <div class="d-flex justify-content-end pr-5 py-3 modal-footer-with-border">
                     <button class="btn btn-primary mr-2" type="submit" form="editFormId">Save</button>
                    <button class="btn btn-secondary" @onclick="HandleCancel">Cancel</button>
                </div>
           </FooterTemplate>
    </CustomModal>

    <EditForm Model="InputMD" FormName="Search" OnValidSubmit="@Search">
        <DataAnnotationsValidator />
        <div class="row ">
            <!-- Select for nhóm danh mục-->
            <div class="col-sm-4 col-md-2 mb-2">
                <label for="Table">Hình thức hố ga</label>
                <Select2 Id="mySelect1" Items="@selectHTHG" OnChange="@OnSelectChangeHTHG"></Select2>
                <ValidationMessage For="()=>InputMD.ThongTinChungHoGa_HinhThucHoGa"></ValidationMessage>
            </div>
            <div class="col-sm-4 col-md-2 mb-2">
                <label for="Table">Kết cấu mũ mỗ</label>
                <Select2 Id="mySelect2" Items="@selectKCMM" OnChange="@OnSelectChangeKCMM"></Select2>
                <ValidationMessage For="()=>InputMD.ThongTinChungHoGa_KetCauMuMo"></ValidationMessage>
            </div>
            <div class="col-sm-4 col-md-2 mb-2">
                <label for="Table">Kết cấu tường</label>
                <Select2 Id="mySelect3" Items="@selectKCT" OnChange="@OnSelectChangeKCT"></Select2>
                <ValidationMessage For="()=>InputMD.ThongTinChungHoGa_KetCauTuong"></ValidationMessage>
            </div>
            <div class="col-sm-4 col-md-2 mb-2">
                <label for="Table">Hình thức móng hố ga</label>
                <Select2 Id="mySelect4" Items="@selectHTMHG" OnChange="@OnSelectChangeHTMHG"></Select2>
                <ValidationMessage For="()=>InputMD.ThongTinChungHoGa_HinhThucMongHoGa"></ValidationMessage>
            </div>
            <div class="col-sm-4 col-md-2 mb-2">
                <label for="Table">Kết cấu móng</label>
                <Select2 Id="mySelect5" Items="@selectKCM" OnChange="@OnSelectChangeKCM"></Select2>
                <ValidationMessage For="()=>InputMD.ThongTinChungHoGa_KetCauMong"></ValidationMessage>
            </div>
            <!-- Search Button -->
            <div class="col-sm-4 col-md-1 mb-1">
                <label>&nbsp;</label>
                <button type="submit" class="btn btn-primary w-100">Tìm kiếm</button>
            </div>
            <div class="col-sm-4 col-md-1 mb-1">
                <label>&nbsp;</label>
                <button @onclick="ShowModal" class="btn btn-info form-control">Tạo mới</button>
            </div>
        </div>
    </EditForm>

    <div class="d-flex justify-content-between align-items-center">
        <h5 class="mt-2">Danh sách phân loại hố ga</h5>
        <i @onclick="ExportExcel" class="fa fa-download accent-blue mr-2" title="Download file excel" aria-hidden="true" style="cursor: pointer;"></i>
    </div>

    <div class="row mt-3 our-table">
        <table class="table table-hover table-bordered">
            <thead class="bg-info">
                <tr class="nowrap">
                    <th class="text-center vertical-middle"  rowspan="3"></th>
                    <th class="text-center vertical-middle" rowspan="3">STT</th>
                    <th class="text-center vertical-middle" colspan="8" rowspan="2">Thông tin chung hố ga</th>
                    <th class="text-center" colspan="34">Thông tin kích thước hình học hố ga</th>
                    <th class="text-center" colspan="32">Hạng mục chiếm chỗ hố ga</th>
                </tr>
                <tr>
                    <th class="text-center" colspan="2">Thông tin phủ bì hố ga (m)</th>
                    <th class="text-center" colspan="3">Kích thước hình học bê tông lót móng hố ga (m)</th>
                    <th class="text-center" colspan="3">Kích thước hình học bê tông móng hố ga (m)</th>
                    <th class="text-center" colspan="3">KTHH đế hố ga</th>
                    <th class="text-center" colspan="4">Kích thước hình học tường hố ga (m)</th>
                    <th class="text-center" colspan="5">KTHH dầm giữa hố ga</th>
                    <th class="text-center" colspan="3">Chất hố ga mặt trong</th>
                    <th class="text-center" colspan="3">Chất hố ga mặt ngoài, cạnh 01 +02 (m)</th>
                    <th class="text-center" colspan="4">Kích thước hình học tường mũ mố thép dưới (m)</th>
                    <th class="text-center" colspan="4">Kích thước hình học tường mũ mố thép trên (m)</th>

                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                    <th class="text-center" colspan="4">Hình thức đấu nối</th>
                </tr>
                <tr>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_TenHoGaSauPhanLoai"))" class="text-center sortable">
                        <div class="mr-3">
                            Tên hố ga sau phân loại
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_TenHoGaSauPhanLoai"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_HinhThucHoGa_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Hình thức hố ga
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_HinhThucHoGa_Name"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_KetCauMuMo_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Kết cấu mũ mố
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_KetCauMuMo_Name"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_KetCauTuong_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Kết cấu tường
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_KetCauTuong_Name"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_HinhThucMongHoGa_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Hình thức móng hố ga
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_HinhThucMongHoGa_Name"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_KetCauMong_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Kết cấu móng
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_KetCauMong_Name"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_ChatMatTrong_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Chát mặt trong
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_ChatMatTrong_Name"))"></span>
                        </div>
                    </th>
                    <th onclick="@(() => SortTable("ThongTinChungHoGa_ChatMatNgoai_Name"))" class="text-center sortable">
                        <div class="mr-3">
                            Chát mặt ngoài
                            <span class="arrow @(GetSortStyle("ThongTinChungHoGa_ChatMatNgoai_Name"))"></span>
                        </div>
                    </th>

                    @* Thông tin kích thước hình học hố ga *@
                    <th>C.D dài (m)</th>
                    <th>C.rộng (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD tường (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD dầm (m)</th>
                    <th>C.Cao dầm giữa tường so với đáy hố ga (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD tường (m)</th>

                    <th>D (m)</th>
                    <th>R (m)</th>
                    <th>C (m)</th>
                    <th>CD tường (m)</th>

                    @* Hạng mục chiếm chỗ hố ga *@
                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>

                    <th>Loại</th>
                    <th>Cạnh dài</th>
                    <th>Cạnh rộng</th>
                    <th>Cạnh chéo</th>
                </tr>
            </thead>
            @if (listPLHGModel.Any())
            {

                <tbody>
                    @{
                        int stt = 1;
                    }
                    @foreach (var item in listPLHGModel)
                    {

                        <tr>
                            <td class="d-flex nowrap">
                                <div class="d-inline-block">
                                    
                                  
                                    <button class="btn btn-sm btn-primary m-1" title="Thêm vào sau" @onclick="()=>InsertLaterFlag(item.Flag)">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                    @{
                                        if (item.IsEdit == 0)
                                        {
                                            <button class="btn btn-sm btn-primary m-1" title="Chỉnh sửa" @onclick="()=>HandleEdit(item.Id)">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-danger m-1" title="Xóa" @onclick="()=>ConfirmDelete(item.Id ,item.ThongTinChungHoGa_TenHoGaSauPhanLoai)">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        }
                                    }
                                    
                               </div>
                            </td>
                            <td class="text-center">@stt</td>
                            <td class="text-center">@item.ThongTinChungHoGa_TenHoGaSauPhanLoai </td>
                            <td class="text-center">@item.ThongTinChungHoGa_HinhThucHoGa_Name </td>
                            <td class="text-center">@item.ThongTinChungHoGa_KetCauMuMo_Name </td>
                            <td class="text-center">@item.ThongTinChungHoGa_KetCauTuong_Name </td>
                            <td class="text-center">@item.ThongTinChungHoGa_HinhThucMongHoGa_Name </td>
                            <td class="text-center">@item.ThongTinChungHoGa_KetCauMong_Name </td>
                            <td class="text-center">@item.ThongTinChungHoGa_ChatMatTrong_Name </td>
                            <td class="text-center">@item.ThongTinChungHoGa_ChatMatNgoai_Name  </td>
                            <td class="text-center">@item.PhuBiHoGa_CDai  </td>
                            <td class="text-center">@item.PhuBiHoGa_CRong</td>
                            <td class="text-center">@item.BeTongLotMong_D</td>
                            <td class="text-center">@item.BeTongLotMong_R</td>
                            <td class="text-center">@item.BeTongLotMong_C</td>
                            <td class="text-center">@item.BeTongMongHoGa_D  </td>
                            <td class="text-center">@item.BeTongMongHoGa_R  </td>
                            <td class="text-center">@item.BeTongMongHoGa_C</td>
                            <td class="text-center">@item.DeHoGa_D</td>
                            <td class="text-center">@item.DeHoGa_R</td>
                            <td class="text-center">@item.DeHoGa_C</td>
                            <td class="text-center">@item.TuongHoGa_D</td>
                            <td class="text-center">@item.TuongHoGa_R  </td>
                            <td class="text-center">@item.TuongHoGa_C</td>
                            <td class="text-center">@item.TuongHoGa_CdTuong</td>
                            <td class="text-center">@item.DamGiuaHoGa_D  </td>
                            <td class="text-center">@item.DamGiuaHoGa_R</td>
                            <td class="text-center">@item.DamGiuaHoGa_C</td>
                            <td class="text-center">@item.DamGiuaHoGa_CdDam</td>
                            <td class="text-center">@item.DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa</td>
                            <td class="text-center">@item.ChatMatTrong_D  </td>
                            <td class="text-center">@item.ChatMatTrong_R  </td>
                            <td class="text-center">@item.ChatMatTrong_C</td>
                            <td class="text-center">@item.ChatMatNgoaiCanh_D</td>
                            <td class="text-center">@item.ChatMatNgoaiCanh_R  </td>
                            <td class="text-center">@item.ChatMatNgoaiCanh_C</td>
                            <td class="text-center">@item.MuMoThotDuoi_D</td>
                            <td class="text-center">@item.MuMoThotDuoi_R</td>
                            <td class="text-center">@item.MuMoThotDuoi_C</td>
                            <td class="text-center">@item.MuMoThotDuoi_CdTuong</td>
                            <td class="text-center">@item.MuMoThotTren_D  </td>
                            <td class="text-center">@item.MuMoThotTren_R</td>
                            <td class="text-center">@item.MuMoThotTren_C</td>
                            <td class="text-center">@item.MuMoThotTren_CdTuong</td>
                            <td class="text-center">@item.HinhThucDauNoi1_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi1_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi1_CanhRong</td>
                            <td class="text-center">@item.HinhThucDauNoi1_CanhCheo</td>
                            <td class="text-center">@item.HinhThucDauNoi2_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi2_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi2_CanhRong</td>
                            <td class="text-center">@item.HinhThucDauNoi2_CanhCheo  </td>
                            <td class="text-center">@item.HinhThucDauNoi3_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi3_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi3_CanhRong  </td>
                            <td class="text-center">@item.HinhThucDauNoi3_CanhCheo</td>
                            <td class="text-center">@item.HinhThucDauNoi4_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi4_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi4_CanhRong  </td>
                            <td class="text-center">@item.HinhThucDauNoi4_CanhCheo</td>
                            <td class="text-center">@item.HinhThucDauNoi5_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi5_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi5_CanhRong</td>
                            <td class="text-center">@item.HinhThucDauNoi5_CanhCheo</td>
                            <td class="text-center">@item.HinhThucDauNoi6_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi6_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi6_CanhRong</td>
                            <td class="text-center">@item.HinhThucDauNoi6_CanhCheo  </td>
                            <td class="text-center">@item.HinhThucDauNoi7_Loai  </td>
                            <td class="text-center">@item.HinhThucDauNoi7_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi7_CanhRong </td>
                            <td class="text-center">@item.HinhThucDauNoi7_CanhCheo</td>
                            <td class="text-center">@item.HinhThucDauNoi8_Loai</td>
                            <td class="text-center">@item.HinhThucDauNoi8_CanhDai</td>
                            <td class="text-center">@item.HinhThucDauNoi8_CanhRong</td>
                            <td class="text-center">@item.HinhThucDauNoi8_CanhCheo </td>
                        </tr>
                        stt++;
                    }

                </tbody>
            }
            else
            {
                <tbody>
                    <tr>
                        <td colspan="76"> Không có dữ liệu</td>
                    </tr>
                </tbody>
            }

        </table>
    </div>

    @if (listPLHGModel.Any())
    {
        <Pagination MetaData="MetaData" Spread="2" SelectedPage="SelectedPage" ChangePageSize="ChangePageSize"></Pagination>
    }
    <ConfirmModal @ref="confirmModal" OnResponseClick="HandleResponseClick"></ConfirmModal>
    <Loading IsLoading="@isLoading" LoadingText="Đang tải dữ liệu..." />
</div>

@code {
    private List<PhanLoaiHoGa> listPhanLoaiHoGa = new List<PhanLoaiHoGa>();
    private PhanLoaiHoGa Input = new();
    public List<DanhMuc1> listDanhMuc = new();
    public PhanLoaiHoGaModel InputMD = new();
    private DateTime baseTime;

    private bool isModalVisible = false;
    private bool isLoading = false;
    private string TitleModal = "Thêm phân loại hố ga";
    private bool isEdit { get; set; } = false;
    private bool permissionEdit { get; set; } = false;

    private List<SelectedItem> selectHTHG = new();
    private List<SelectedItem> selectKCMM = new();
    private List<SelectedItem> selectKCT = new();
    private List<SelectedItem> selectHTMHG = new();
    private List<SelectedItem> selectKCM = new();
    private void OnSelectChangeHTHG(SelectedItem selectedItem)
    {
        InputMD.ThongTinChungHoGa_HinhThucHoGa = selectedItem.Value;
    }
    private void OnSelectChangeKCMM(SelectedItem selectedItem)
    {
        InputMD.ThongTinChungHoGa_KetCauMuMo = selectedItem.Value;
    }
    private void OnSelectChangeKCT(SelectedItem selectedItem)
    {
        InputMD.ThongTinChungHoGa_KetCauTuong = selectedItem.Value;
    }
    private void OnSelectChangeHTMHG(SelectedItem selectedItem)
    {
        InputMD.ThongTinChungHoGa_HinhThucMongHoGa = selectedItem.Value;
    }
    private void OnSelectChangeKCM(SelectedItem selectedItem)
    {
        InputMD.ThongTinChungHoGa_KetCauMong = selectedItem.Value;
    }

    public async Task Search()
    {
        dmModel.PageNumber = 1;
        await LoadData();
    }

    private void ShowModal()
    {
        isModalVisible = true;
        Input = new();
    }

    private void HandleModalClose(bool isVisible)
    {
        isModalVisible = isVisible;
        Input = new();
        isEdit = false;
    }

    private void HandleSave()
    {
        // Logic for saving
        isModalVisible = false;

    }

    private void HandleCancel()
    {
        // Logic for canceling
        isModalVisible = false;
        Input = new();
        isEdit = false;
    }

    [Parameter]
    public ConfirmModal confirmModal { get; set; }
    public List<PhanLoaiHoGaModel> listPLHGModel { get;set;} = new();
    public List<PhanLoaiHoGaModel> listModel{get;set;} = new();
    public MetaData MetaData{get;set;}
    public PhanLoaiHoGaModel dmModel{get;set;}

    public List<DanhMuc1> FindByIdNhomDanhMuc(string idNhomDanhMuc)
    {
        return listDanhMuc.Where(dm => dm.IdNhomDanhMuc == idNhomDanhMuc).ToList();
    }

    public string GetTenDanhMucById(string id)
    {
        var danhMuc = listDanhMuc.FirstOrDefault(dm => dm.Id == id);
        return danhMuc != null ? danhMuc.Ten : null;
    }
    // Khởi tạo màn hình
    protected override async Task OnInitializedAsync()
    {
        InputMD = new();
        baseTime = DateTime.Now;
        await LoadData();
        foreach (var item in listDanhMuc)
        {
            // Kiểm tra xem item đã tồn tại trong danh sách hay chưa
            if (!selectHTHG.Any(x => x.Value == item.Id) && item.IdNhomDanhMuc == "HG_HTHGa")
            {
                if (!string.IsNullOrEmpty(item.Id))
                {
                    // Nếu chưa tồn tại, thêm item vào danh sách
                    selectHTHG.Add(new SelectedItem
                        {
                            Value = item.Id,
                            Text = item.Ten
                        });
                }
            }
            if (!selectKCMM.Any(x => x.Value == item.Id) && item.IdNhomDanhMuc == "HG_LMMHoGa")
            {
                if (!string.IsNullOrEmpty(item.Id))
                {
                    // Nếu chưa tồn tại, thêm item vào danh sách
                    selectKCMM.Add(new SelectedItem
                        {
                            Value = item.Id,
                            Text = item.Ten
                        });
                }
            }
            if (!selectKCT.Any(x => x.Value == item.Id) && item.IdNhomDanhMuc == "HG_LTHoGa")
            {
                if (!string.IsNullOrEmpty(item.Id))
                {
                    // Nếu chưa tồn tại, thêm item vào danh sách
                    selectKCT.Add(new SelectedItem
                        {
                            Value = item.Id,
                            Text = item.Ten
                        });
                }
            }
            if (!selectHTMHG.Any(x => x.Value == item.Id) && item.IdNhomDanhMuc == "HG_HTMHoGa")
            {
                if (!string.IsNullOrEmpty(item.Id))
                {
                    // Nếu chưa tồn tại, thêm item vào danh sách
                    selectHTMHG.Add(new SelectedItem
                        {
                            Value = item.Id,
                            Text = item.Ten
                        });
                }
            }
            if (!selectKCM.Any(x => x.Value == item.Id) && item.IdNhomDanhMuc == "HG_LMHoGa")
            {
                if (!string.IsNullOrEmpty(item.Id))
                {
                    // Nếu chưa tồn tại, thêm item vào danh sách
                    selectKCM.Add(new SelectedItem
                        {
                            Value = item.Id,
                            Text = item.Ten
                        });
                }
            }
        }
        // Thêm phần tử mặc định "chọn..."
        selectHTHG.Insert(0, new SelectedItem { Value = "", Text = "Chọn...", IsSelected = true });
        selectKCMM.Insert(0, new SelectedItem { Value = "", Text = "Chọn...", IsSelected = true });
        selectKCT.Insert(0, new SelectedItem { Value = "", Text = "Chọn...", IsSelected = true });
        selectHTMHG.Insert(0, new SelectedItem { Value = "", Text = "Chọn...", IsSelected = true });
        selectKCM.Insert(0, new SelectedItem { Value = "", Text = "Chọn...", IsSelected = true });
    }

    // Truy vấn data theo điều kiện tìm kiếm
    private async Task LoadData()
    {
        try
        {
            isLoading = true;
            dmModel = new();
            listDanhMuc = await DanhMucRepository.GetAll();
            var plhg = await PhanLoaiHoGaRepository.GetAllByVM(InputMD);
            listModel = plhg;
            listPLHGModel = Paging(plhg);
            isLoading = false;
        }
        catch (Exception ex)
        {
            ToastService.ShowToast(
                           "Thông báo",
                           ex.Message,
                           cssClass: "toast-danger",
                            iconClass: "fa fa-exclamation-circle",
                           progressBarClass: "bg-info",
                           duration: 5000
                       );
        }
    }

    private async Task HandleInValidSubmit()
    {
        await JSRuntime.InvokeVoidAsync("scrollToFirstError");
    }


    private async Task HandleValidSubmit()
    {
        try
        {
            PhanLoaiHoGa phanLoaiHoGaExist = new();
            // if (Input.ThongTinChungHoGa_TenHoGaSauPhanLoai.ToUpper().EndsWith("=G"))
            // {
            //     Input.G = "=G";
            // }
            phanLoaiHoGaExist = await PhanLoaiHoGaRepository.GetPhanLoaiHoGaExist(Input);
            var existName = false;
            existName = await PhanLoaiHoGaRepository.CheckUsingName(Input.ThongTinChungHoGa_TenHoGaSauPhanLoai);
            if (isEdit)
            {
                if (phanLoaiHoGaExist == null)
                {
                    string[] ids = { Input.Id };
                    bool isValid = await PhanLoaiHoGaRepository.CheckExclusive(ids,baseTime);
                    if (isValid)
                    {
                        // cập nhật
                        await PhanLoaiHoGaRepository.Update(Input);
                        isModalVisible = false;
                        Input = new PhanLoaiHoGa();
                        isEdit = false;
                        ToastService.ShowToast(
                            "Thông báo",
                            "Cập nhật thành công.",
                            cssClass: "toast-success",
                            iconClass: "fa fa-check-circle",
                            progressBarClass: "bg-info",
                            duration: 5000
                        );
                        await LoadData();
                    }

                }
                else
                if (phanLoaiHoGaExist.ThongTinChungHoGa_TenHoGaSauPhanLoai.ToUpper().Trim() != Input.ThongTinChungHoGa_TenHoGaSauPhanLoai.ToUpper().Trim() && !existName)
                {
                    string[] ids = { Input.Id };
                    bool isValid = await PhanLoaiHoGaRepository.CheckExclusive(ids, baseTime);
                    if (isValid)
                    {
                        await PhanLoaiHoGaRepository.Update(Input);
                        isModalVisible = false;
                        Input = new PhanLoaiHoGa();
                        isEdit = false;
                        ToastService.ShowToast(
                            "Thông báo",
                            "Cập nhật thành công.",
                            cssClass: "toast-success",
                            iconClass: "fa fa-check-circle",
                            progressBarClass: "bg-info",
                            duration: 5000
                        );
                        await LoadData();
                    }
                }
                else
                {
                    ToastService.ShowToast(
                            "Thông báo",
                            "Tên phân loại đã tồn tại. Vui lòng kiểm tra lại !",
                            cssClass: "toast-danger",
                             iconClass: "fa fa-exclamation-circle",
                            progressBarClass: "bg-info",
                            duration: 5000
                        );
                }
            }
            else
            {
                if (phanLoaiHoGaExist == null)
                {
                    if (Flag > 0)
                    {
                        // Thêm mới thông tin
                        var id = await PhanLoaiHoGaRepository.InsertLaterFlag(Input, Flag);
                        isModalVisible = false;
                        Input = new PhanLoaiHoGa();
                        ToastService.ShowToast(
                            "Thông báo",
                            "Chèn thành công.",
                            cssClass: "toast-success",
                            iconClass: "fa fa-check-circle",
                            progressBarClass: "bg-info",
                            duration: 5000
                        );
                        await LoadData();
                        Flag = 0;
                    }
                    else
                    {
                        // Thêm mới thông tin
                        await PhanLoaiHoGaRepository.Insert(Input);
                        isModalVisible = false;
                        Input = new PhanLoaiHoGa();
                        ToastService.ShowToast(
                            "Thông báo",
                            "Thêm thành công.",
                            cssClass: "toast-success",
                            iconClass: "fa fa-check-circle",
                            progressBarClass: "bg-info",
                            duration: 5000
                        );
                        await LoadData();
                    }
                }
                else
                {
                    ToastService.ShowToast(
                           "Thông báo",
                           "Phân loại hố ga đã tồn tại , Vui lòng kiểm tra lại !",
                           cssClass: "toast-danger",
                            iconClass: "fa fa-exclamation-circle",
                           progressBarClass: "bg-info",
                           duration: 5000
                       );
                }
            }

        }
        catch (Exception ex)
        {
            ToastService.ShowToast(
                          "Thông báo",
                          ex.Message,
                          cssClass: "toast-danger",
                           iconClass: "fa fa-exclamation-circle",
                          progressBarClass: "bg-info",
                          duration: 5000
                      );
        }
    }

    private string deleteId;

    private async Task ConfirmDelete(string id, string Ten="")
    {
        deleteId = id;
        confirmModal.Title = "Xác nhận xóa";
        confirmModal.message = $"Bạn có chắc chắn muốn xóa: {Ten}?";
        confirmModal.openModal();
    }

    private async Task HandleResponseClick(bool confirmed)
    {
        if (confirmed)
        {
            if (!string.IsNullOrEmpty(deleteId))
            {

                var result = await PhanLoaiHoGaRepository.CheckUsingId(deleteId);
                if (result)
                {
                    ToastService.ShowToast("Thông báo", "Không thể xóa phân loại đang được sử dụng.", cssClass: "toast-danger", iconClass: "fa fa-exclamation-circle", progressBarClass: "bg-info", duration: 5000);
                }
                else
                {
                    // Thực hiện hành động xóa
                    await PhanLoaiHoGaRepository.DeleteById(deleteId);
                    ToastService.ShowToast("Thông báo", "Xóa phân loại thành công.", cssClass: "toast-success", iconClass: "fa fa-check-circle", progressBarClass: "bg-info", duration: 5000);
                    await LoadData();
                }

                deleteId = "";
            }
        }
    }

    private async Task HandleEdit(string id)
    {
        try
        {
            var result = await PhanLoaiHoGaRepository.CheckUsingId(id);
            if (result)
            {
                ToastService.ShowToast("Thông báo", "Không thể sửa phân loại đang được sử dụng trong DS Nước mua.", cssClass: "toast-danger", iconClass: "fa fa-exclamation-circle", progressBarClass: "bg-info", duration: 5000);
            }
            else
            {
                TitleModal = "Cập nhật phân loại hố ga !";
                Input = await PhanLoaiHoGaRepository.GetById(id);
                isEdit = true;
                isModalVisible = true;
            }
            
        }
        catch (Exception ex)
        {
            ToastService.ShowToast(
                           "Thông báo",
                           ex.Message,
                           cssClass: "toast-danger",
                            iconClass: "fa fa-exclamation-circle",
                           progressBarClass: "bg-info",
                           duration: 5000
                       );
        }
       
    }

    int Flag = 0;
    //thêm vào sau
    private void InsertLaterFlag(int flag)
    {
        Flag = flag;
        TitleModal = "Chèn loại cống !";
        isModalVisible = true;
    }

    // Sắp xếp data
    private void SortTable(string columnName)
    {
        listModel = SortService.SortTable(listModel, columnName);
        dmModel.PageNumber = 1;
        Paging(listModel);
    }

    // Get css cho chức năng sắp xếp
    private string GetSortStyle(string columnName)
    {
        return SortService.GetSortStyle(columnName);
    }

    // Xử lý trường hợp đổi page hiển thị
    private void SelectedPage(int page)
    {
        dmModel.PageNumber = page;
        Paging(listModel);
    }

    // Xử lý trường hợp đổi số lượng bản ghi hiển thị trên page
    private void ChangePageSize(int pageSize)
    {

        dmModel.PageNumber = 1;
        dmModel.pageSize = pageSize;
        Paging(listModel);
    }
    // Xử lý paging
    private List<PhanLoaiHoGaModel> Paging(List<PhanLoaiHoGaModel> plhgs)
    {
        // Đếm số bản ghi thỏa mãn
        var count = plhgs.Count();

        // Lọc bản ghi theo page hiện tại và page size
        plhgs = plhgs.Skip((dmModel.PageNumber - 1) * dmModel.PageSize).Take(dmModel.PageSize).ToList();

        // Xóa danh sách đang hiển thị trên màn hình
        listPLHGModel.Clear();

        // Thêm những bản ghi sau khi lọc vào danh sách hiển thị
        foreach (var item in plhgs)
        {
            listPLHGModel.Add(item);
        }

        // Tạo pagelist mới
        var pagelist = new PageList<PhanLoaiHoGaModel>(listPLHGModel, count, dmModel.PageNumber, dmModel.PageSize);
        MetaData = pagelist.MetaData;
        return plhgs;
    }

    private async Task ExportExcel()
    {

        var complexHeaders = new List<ComplexHeader>
            {
                // Dòng tiêu đề chung
                new ComplexHeader { Title = "CÔNG TY CỔ PHẦN XÂY DỰNG ĐỨC ANH", StartRow = 1, StartCol = 1, EndRow = 1, EndCol = 5,Alignment = ExcelHorizontalAlignment.Center,IsBold=true },
                new ComplexHeader { Title = "TÊN DỰ ÁN", StartRow = 2, StartCol = 1, EndRow = 2, EndCol = 5 ,Alignment = ExcelHorizontalAlignment.Center ,IsBold=true},
                new ComplexHeader { Title = "BẢNG TỔNG HỢP THÔNG TIN HỆ THỐNG THOÁT NƯỚC MƯA DỌC PHÍA TRÁI TUYẾN", StartRow = 3, StartCol = 1, EndRow = 3, EndCol = 25, TextColor = System.Drawing.Color.Black, Alignment = ExcelHorizontalAlignment.Center, CapitalizeEachWord = true,IsBold=true },
                new ComplexHeader { Title = "Số liệu màu đen nhạt là số liệu nhập bằng tay; Số liệu màu đen đậm là kết quả mang từ một bảng khác sang; Số liệu màu đỏ là kết quả của 01 phép tính.", StartRow = 4, StartCol = 1, EndRow = 4, EndCol = 25, Alignment = ExcelHorizontalAlignment.Center,TextColor = System.Drawing.Color.Red },
                new ComplexHeader { Title = "Tất cả số liệu liên quan đến hố ga không được để rỗng cho dù giá trị của ô = 0", StartRow = 5, StartCol = 1, EndRow = 5, EndCol = 25, Alignment = ExcelHorizontalAlignment.Center,TextColor = System.Drawing.Color.Red },
                new ComplexHeader { Title = "Qui ước kích thước hình học: Chiều dài là chiều song song với đường; Chiều rộng là chiều vuông góc với đường; Chiều cao là chiều từ đáy đến đỉnh; Chiều rộng là chiều rộng của cấu kiện.", StartRow = 6, StartCol = 1, EndRow = 6, EndCol = 25, Alignment = ExcelHorizontalAlignment.Center ,TextColor = System.Drawing.Color.Red},
                new ComplexHeader { Title = "Quy ước 01 lý trình: Lý trình hố ga là tại tim hố ga; lý trình đầu, cuối ống là mặt trong điểm đầu và điểm cuối hố ga.", StartRow = 7, StartCol = 1, EndRow = 7, EndCol = 25, Alignment = ExcelHorizontalAlignment.Center ,TextColor = System.Drawing.Color.Red },
                new ComplexHeader { Title = "Những bảng sử dụng số liệu tại bảng này bị thay đổi nếu số liệu tại bảng này bị thay đổi.", StartRow = 8, StartCol = 1, EndRow = 8, EndCol = 25, Alignment = ExcelHorizontalAlignment.Center ,TextColor = System.Drawing.Color.Red},

                // Header thông tin chi tiết
                new ComplexHeader { Title = "Thông tin hố ga sau phân loại", StartRow = 16, EndRow = 16, StartCol = 1, EndCol = 42,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Thông tin chiếm chỗ hố ga", StartRow = 16, EndRow = 16, StartCol = 43, EndCol = 74,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},

                new ComplexHeader { Title = "Thông tin cấu tạo hố ga", StartRow = 17, EndRow = 17, StartCol = 1, EndCol = 8,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Thông tin phủ bì hố ga (m)", StartRow = 17, EndRow = 17, StartCol = 9, EndCol = 10,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kích thước hình học bê tông lót móng hố ga (m)", StartRow = 17, EndRow = 17, StartCol = 11, EndCol = 13,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kích thước hình học bê tông móng hố ga (m)", StartRow = 17, EndRow = 17, StartCol = 14, EndCol = 16,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "KTHH đế hố ga", StartRow = 17, EndRow = 17, StartCol = 17, EndCol = 19,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kích thước hình học tường hố ga (m)", StartRow = 17, EndRow = 17, StartCol = 20, EndCol = 23,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "KTHH dầm giữa hố ga", StartRow = 17, EndRow = 17, StartCol = 24, EndCol = 28,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Chát hố ga mặt trong", StartRow = 17, EndRow = 17, StartCol = 29, EndCol = 31,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Chát hố ga mặt ngoài, cạnh 01 +02 (m)", StartRow = 17, EndRow = 17, StartCol = 32, EndCol = 34,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kích thước hình học tường mũ mố thớt dưới (m)", StartRow = 17, EndRow = 17, StartCol = 35, EndCol = 38,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kích thước hình học tường mũ mố thớt trên (m)", StartRow = 17, EndRow = 17, StartCol = 39, EndCol = 42,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 43, EndCol = 46,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 47, EndCol = 50,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 51, EndCol = 54,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 55, EndCol = 58,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 59, EndCol = 62,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 63, EndCol = 66,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 67, EndCol = 70,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức đấu nối", StartRow = 17, EndRow = 17, StartCol = 71, EndCol = 74,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},

                new ComplexHeader { Title = "Phân loại hố ga", DataProperty="ThongTinChungHoGa_TenHoGaSauPhanLoai", StartRow = 18, EndRow = 18, StartCol = 1, EndCol = 1,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức hố ga", DataProperty="ThongTinChungHoGa_HinhThucHoGa_Name", StartRow = 18, EndRow = 18, StartCol = 2, EndCol = 2,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kết cấu mũ mố", DataProperty="ThongTinChungHoGa_KetCauMuMo_Name", StartRow = 18, EndRow = 18, StartCol = 3, EndCol = 3,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kết cấu tường", DataProperty="ThongTinChungHoGa_KetCauTuong_Name", StartRow = 18, EndRow = 18, StartCol = 4, EndCol = 4,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Hình thức móng hố ga", DataProperty="ThongTinChungHoGa_HinhThucMongHoGa_Name", StartRow = 18, EndRow = 18, StartCol = 5, EndCol = 5,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Kết cấu móng", DataProperty="ThongTinChungHoGa_KetCauMong_Name", StartRow = 18, EndRow = 18, StartCol = 6, EndCol = 6,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Chát mặt trong", DataProperty="ThongTinChungHoGa_ChatMatTrong_Name", StartRow = 18, EndRow = 18, StartCol = 7, EndCol = 7,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Chát mặt ngoài", DataProperty="ThongTinChungHoGa_ChatMatNgoai_Name", StartRow = 18, EndRow = 18, StartCol = 8, EndCol = 8,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C.Dài (m)", DataProperty="PhuBiHoGa_CDai", StartRow = 18, EndRow = 18, StartCol = 9, EndCol = 9,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C.rộng (m)", DataProperty="PhuBiHoGa_CRong", StartRow = 18, EndRow = 18, StartCol = 10, EndCol = 10,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="BeTongLotMong_D", StartRow = 18, EndRow = 18, StartCol = 11, EndCol = 11,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="BeTongLotMong_R", StartRow = 18, EndRow = 18, StartCol = 12, EndCol = 12,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="BeTongLotMong_C", StartRow = 18, EndRow = 18, StartCol = 13, EndCol = 13,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="BeTongMongHoGa_D", StartRow = 18, EndRow = 18, StartCol = 14, EndCol = 14,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="BeTongMongHoGa_R", StartRow = 18, EndRow = 18, StartCol = 15, EndCol = 15,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="BeTongMongHoGa_C", StartRow = 18, EndRow = 18, StartCol = 16, EndCol = 16,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="DeHoGa_D", StartRow = 18, EndRow = 18, StartCol = 17, EndCol = 17,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="DeHoGa_R", StartRow = 18, EndRow = 18, StartCol = 18, EndCol = 18,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="DeHoGa_C", StartRow = 18, EndRow = 18, StartCol = 19, EndCol = 19,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="TuongHoGa_D", StartRow = 18, EndRow = 18, StartCol = 20, EndCol = 20,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="TuongHoGa_R", StartRow = 18, EndRow = 18, StartCol = 21, EndCol = 21,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="TuongHoGa_C", StartRow = 18, EndRow = 18, StartCol = 22, EndCol = 22,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "CD tường (m) ", DataProperty="TuongHoGa_CdTuong", StartRow = 18, EndRow = 18, StartCol = 23, EndCol = 23,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="DamGiuaHoGa_D", StartRow = 18, EndRow = 18, StartCol = 24, EndCol = 24,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="DamGiuaHoGa_C", StartRow = 18, EndRow = 18, StartCol = 25, EndCol = 25,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="DamGiuaHoGa_C", StartRow = 18, EndRow = 18, StartCol = 26, EndCol = 26,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "CD dầm (m) ", DataProperty="DamGiuaHoGa_CdDam", StartRow = 18, EndRow = 18, StartCol = 27, EndCol = 27,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C.Cao dầm giữa tường so với đáy hố ga (m) ", DataProperty="DamGiuaHoGa_CCaoDamGiuaTuongSoVoiDayHoGa", StartRow = 18, EndRow = 18, StartCol = 28, EndCol = 28,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="ChatMatTrong_D", StartRow = 18, EndRow = 18, StartCol = 29, EndCol = 29,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="ChatMatTrong_R", StartRow = 18, EndRow = 18, StartCol = 30, EndCol = 30,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="ChatMatTrong_C", StartRow = 18, EndRow = 18, StartCol = 31, EndCol = 31,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="ChatMatNgoaiCanh_D", StartRow = 18, EndRow = 18, StartCol = 32, EndCol = 32,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="ChatMatNgoaiCanh_R", StartRow = 18, EndRow = 18, StartCol =33, EndCol = 33,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="ChatMatNgoaiCanh_C", StartRow = 18, EndRow = 18, StartCol = 34, EndCol = 34,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="MuMoThotDuoi_D", StartRow = 18, EndRow = 18, StartCol = 35, EndCol = 35,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="MuMoThotDuoi_R", StartRow = 18, EndRow = 18, StartCol = 36, EndCol = 36,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="MuMoThotDuoi_C", StartRow = 18, EndRow = 18, StartCol = 37, EndCol = 37,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "CD tường (m) ", DataProperty="MuMoThotDuoi_CdTuong", StartRow = 18, EndRow = 18, StartCol = 38, EndCol = 38,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "D (m) ", DataProperty="MuMoThotTren_D", StartRow = 18, EndRow = 18, StartCol = 39, EndCol = 39,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "R (m) ", DataProperty="MuMoThotTren_R", StartRow = 18, EndRow = 18, StartCol = 40, EndCol = 40,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "C (m) ", DataProperty="MuMoThotTren_C", StartRow = 18, EndRow = 18, StartCol = 41, EndCol = 41,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "CD tường (m) ", DataProperty="MuMoThotTren_CdTuong", StartRow = 18, EndRow = 18, StartCol = 42, EndCol = 42,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi1_Loai", StartRow = 18, EndRow = 18, StartCol = 43, EndCol = 43,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi1_CanhDai", StartRow = 18, EndRow = 18, StartCol = 44, EndCol = 44,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi1_CanhRong", StartRow = 18, EndRow = 18, StartCol = 45, EndCol = 45,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi1_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 46, EndCol = 46,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi2_Loai", StartRow = 18, EndRow = 18, StartCol = 47, EndCol = 47,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi2_CanhDai", StartRow = 18, EndRow = 18, StartCol = 48, EndCol = 48,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi2_CanhRong", StartRow = 18, EndRow = 18, StartCol = 49, EndCol = 49,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi2_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 50, EndCol = 50,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi3_Loai", StartRow = 18, EndRow = 18, StartCol = 51, EndCol = 51,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi3_CanhDai", StartRow = 18, EndRow = 18, StartCol = 52, EndCol = 52,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi3_CanhRong", StartRow = 18, EndRow = 18, StartCol = 53, EndCol = 53,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi3_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 54, EndCol = 54,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi4_Loai", StartRow = 18, EndRow = 18, StartCol = 55, EndCol = 55,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi4_CanhDai", StartRow = 18, EndRow = 18, StartCol = 56, EndCol = 56,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi4_CanhRong", StartRow = 18, EndRow = 18, StartCol = 57, EndCol = 57,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi4_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 58, EndCol = 58,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi5_Loai", StartRow = 18, EndRow = 18, StartCol = 59, EndCol = 59,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi5_CanhDai", StartRow = 18, EndRow = 18, StartCol = 60, EndCol = 60,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi5_CanhRong", StartRow = 18, EndRow = 18, StartCol = 61, EndCol = 61,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi5_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 62, EndCol = 62,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi6_Loai", StartRow = 18, EndRow = 18, StartCol = 63, EndCol = 63,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi6_CanhDai", StartRow = 18, EndRow = 18, StartCol = 64, EndCol = 64,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi6_CanhRong", StartRow = 18, EndRow = 18, StartCol = 65, EndCol = 65,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi6_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 66, EndCol = 66,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi7_Loai", StartRow = 18, EndRow = 18, StartCol = 67, EndCol = 67,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi7_CanhDai", StartRow = 18, EndRow = 18, StartCol = 68, EndCol = 68,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi7_CanhRong", StartRow = 18, EndRow = 18, StartCol = 69, EndCol = 69,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi7_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 70, EndCol = 70,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Loại ", DataProperty="HinhThucDauNoi8_Loai", StartRow = 18, EndRow = 18, StartCol = 71, EndCol = 71,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh dài", DataProperty="HinhThucDauNoi8_CanhDai", StartRow = 18, EndRow = 18, StartCol = 72, EndCol = 72,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh rộng", DataProperty="HinhThucDauNoi8_CanhRong", StartRow = 18, EndRow = 18, StartCol = 73, EndCol = 73,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},
                new ComplexHeader { Title = "Cạnh chéo ", DataProperty="HinhThucDauNoi8_CanhCheo", StartRow = 18, EndRow = 18, StartCol = 74, EndCol = 74,IsBold=true ,HasBorder = true ,WrapText=true , Alignment = ExcelHorizontalAlignment.Center},

                };

        // Gọi service xuất Excel

        var excelData = ExportExcelService.ExportToExcelWithComplexHeader(listModel, complexHeaders);

        // Trả về file Excel
        var fileName = "PhanLoaiHoGa.xlsx";
        using var stream = new MemoryStream(excelData);
        using var streamRef = new DotNetStreamReference(stream);
        await JSRuntime.InvokeVoidAsync("downloadFileFromStream", fileName, streamRef);
    }

}
